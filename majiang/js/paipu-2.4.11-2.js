(()=>{"use strict";var a={4630:a=>{
/*!
 *  @kobalab/tenhou-url-log v1.0.2
 *
 *  Copyright(C) 2024 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/tenhou-url-log/blob/master/LICENSE
 */
function e(a){let e="_"==a[2]?60:"0"==a[1]?+("5"+{m:"1",p:"2",s:"3"}[a[0]]):+({m:"1",p:"2",s:"3",z:"4"}[a[0]]+a[1]);return"*"==a.slice(-1)&&(e="r"+e),e}function t(a){let t=[];for(let i of a.match(/[mpsz]\d+/g)||[]){let a=i[0];for(let l of i.match(/\d/g))t.push(e(a+l))}return t}function i(a){let t=a.replace(/0/,"5"),i=a[0],l=a.match(/[\+\=\-]/);if(t.match(/^[mpsz](\d)\1\1\1$/)){let t=a.match(/\d/g);return""+e(i+t[0])+e(i+t[1])+e(i+t[2])+"a"+e(i+t[3])}if(t.match(/^[mpsz](\d)\1\1\1[\+\=\-]$/)){let t=a.match(/\d/g);return"-"==l?"m"+e(i+t[3])+e(i+t[0])+e(i+t[1])+e(i+t[2]):"="==l?e(i+t[0])+"m"+e(i+t[3])+e(i+t[1])+e(i+t[2]):""+e(i+t[0])+e(i+t[1])+e(i+t[2])+"m"+e(i+t[3])}if(t.match(/^[mpsz](\d)\1\1[\+\=\-]\1$/)){let t=a.match(/\d/g);return"-"==l?"k"+e(i+t[3])+e(i+t[2])+e(i+t[0])+e(i+t[1]):"="==l?e(i+t[0])+"k"+e(i+t[3])+e(i+t[2])+e(i+t[1]):""+e(i+t[0])+e(i+t[1])+"k"+e(i+t[3])+e(i+t[2])}if(t.match(/^[mpsz](\d)\1\1[\+\=\-]$/)){let t=a.match(/\d/g);return"-"==l?"p"+e(i+t[2])+e(i+t[0])+e(i+t[1]):"="==l?e(i+t[0])+"p"+e(i+t[2])+e(i+t[1]):""+e(i+t[0])+e(i+t[1])+"p"+e(i+t[2])}{let t=a.match(/\d(?=[\+\=\-])/g).concat(a.match(/\d(?![\+\=\-])/g));return"c"+e(i+t[0])+e(i+t[1])+e(i+t[2])}}function l(a){let e=a.defen/(0==a.l?6:4)/2e3,t=e>=4?"役満":e>=3?"三倍満":e>=2?"倍満":e>=1.5?"跳満":e>=1?"満貫":`${a.fu}符${a.fanshu}飜`;return t+=null!=a.baojia?a.defen+"点":0==a.l?(a.defen/3|0)+"点∀":100*Math.ceil(a.defen/200)/2+"-"+100*Math.floor(a.defen/200)+"点",t}function n(a,e){let t=["和了",[],[]];for(let i=0;i<4;i++)t[1][e[i]]=a.fenpei[i];let i=a.hupai.filter((a=>null!=a.baojia))[0],n=i?(a.l+{"+":1,"=":2,"-":3}[i.baojia])%4:null;t[2]=[e[a.l],e[null==a.baojia?a.l:a.baojia],e[null!=n&&n!=a.baojia?n:a.l],l(a)];for(let e of a.hupai){let i=e.name.replace(/^ダブル立直$/,"両立直").replace(/^翻牌 /,"役牌 ").replace(/^国士無双十三面$/,"国士無双１３面")+(a.damanguan?"(役満)":`(${e.fanshu}飜)`);t[2].push(i)}return t}function o(a,e){if(a.name.match(/^流局|荒牌平局|流し満貫$/)){let t=[a.name.replace(/^荒牌平局$/,"流局"),[]];for(let i=0;i<4;i++)t[1][e[i]]=a.fenpei[i];return t}return[a.name.replace(/^三家和$/,"三家和了").replace(/^四開槓$/,"四槓散了")]}function r(a,l=0){let r=[],p=[[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]];for(let u of a)if(u.qipai){p[0]=[4*u.qipai.zhuangfeng+u.qipai.jushu,u.qipai.changbang,u.qipai.lizhibang];for(let a=0;a<4;a++)r[a]=(l+u.qipai.jushu+a)%4,p[1][r[a]]=u.qipai.defen[a],p[4+3*r[a]]=t(u.qipai.shoupai[a]);p[2]=[e(u.qipai.baopai)]}else u.zimo?p[4+3*r[u.zimo.l]+1].push(e(u.zimo.p)):u.dapai?p[4+3*r[u.dapai.l]+2].push(e(u.dapai.p)):u.fulou?(p[4+3*r[u.fulou.l]+1].push(i(u.fulou.m)),u.fulou.m.match(/\d{4}/)&&p[4+3*r[u.fulou.l]+2].push(0)):u.gang?p[4+3*r[u.gang.l]+2].push(i(u.gang.m)):u.gangzimo?p[4+3*r[u.gangzimo.l]+1].push(e(u.gangzimo.p)):u.kaigang?p[2].push(e(u.kaigang.baopai)):u.hule?(p[3]=(u.hule.fubaopai||[]).map((a=>e(a))),p[16]=n(u.hule,r)):u.pingju&&(p[16]=o(u.pingju,r));return p}a.exports=function(a,e,t={disp:"電脳麻将",aka:1}){let i=a.title.split(/\n/).concat(["",""]).slice(0,2),l=a.player.map((a=>a.replace(/\n.*$/,"")));l=l.splice(a.qijia).concat(l);let n=[];for(let t=0;t<a.log.length;t++)null!=e&&e!=t||n.push(r(a.log[t]));return{title:i,name:l,rule:t,log:n}}}},e={};function t(i){var l=e[i];if(void 0!==l)return l.exports;var n=e[i]={exports:{}};return a[i](n,n.exports,t),n.exports}
/*!
 *  電脳麻将: 牌譜ビューア v2.4.11
 *
 *  Copyright(C) 2017 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/Majiang/blob/master/LICENSE
 */const{hide:i,show:l,fadeIn:n,scale:o}=Majiang.UI.Util;$((function(){const a="https://kobalab.net/majiang/tenhou-log/",e=Majiang.UI.pai($("#loaddata")),r=Majiang.UI.audio($("#loaddata")),p=Majiang.rule(JSON.parse(localStorage.getItem("Majiang.rule")||"{}"));let u,s;const c=a=>($("body").addClass("analyzer"),new Majiang.UI.Analyzer($("#board > .analyzer"),a,e,(()=>$("body").removeClass("analyzer")))),d=a=>($("#board .controller").addClass("paipu"),$("body").attr("class","board"),o($("#board"),$("#space")),s=new Majiang.UI.Paipu($("#board"),a,e,r,"Majiang.pref",(()=>{n($("body").attr("class","file")),s=null}),c),$('input[name="limited"]',b).prop("disabled",!1).val([0]),s),g=a=>(n($("body").attr("class","stat")),new Majiang.UI.PaipuStat($("#stat"),a,(()=>n($("body").attr("class","file"))))),f=a=>($("#board .controller").addClass("paipu"),$("body").attr("class","board"),o($("#board"),$("#space")),s=new Majiang.UI.Paipu($("#board"),a,e,r,"Majiang.pref",(()=>{n($("body").attr("class","editor")),s=null}),c),$('input[name="limited"]',b).prop("disabled",!0).val([1]),s),h=(a,t)=>{new Majiang.UI.PaipuEditor($("#editor"),a,p,e,(()=>{u.storage(!0),n($("body").attr("class","file"))}),t,f),n($("body").attr("class","editor"))};u=location.search?new Majiang.UI.PaipuFile($("#file"),"Majiang.paipu",d,g,h,a,location.search.replace(/^\?/,""),location.hash.replace(/^#/,"")):new Majiang.UI.PaipuFile($("#file"),"Majiang.paipu",d,g,h,a),u.redraw(),$(window).on("resize",(()=>o($("#board"),$("#space"))));const m=t(4630),b=$("#board .tenhou-dialog");function j(){let a=$('[name="type"]:checked',b).val(),e=$('[name="limited"]',b).prop("checked")?s._log_idx:null,t="";if("JSON"==a)t=JSON.stringify(m(s._paipu,e)),$("textarea",b).attr("class","JSON");else{for(let a=0;a<s._paipu.log.length;a++)null!=e&&a!=e||(t+="https://tenhou.net/6/#json="+encodeURI(JSON.stringify(m(s._paipu,a)))+"\n");$("textarea",b).attr("class","URL")}$("textarea",b).val(t),navigator.clipboard?(l($('[type="button"]',b)),l($('[type="submit"]',b))):($("textarea",b).attr("disabled",!1).select(),l($('[type="button"]',b)),i($('[type="submit"]',b)))}function y(){i(b),s.set_handler()}$(window).on("keyup",(a=>{s&&"t"==a.key&&(s._log_idx<0||(s.clear_handler(),l(b),j()))})),$("form",b).on("submit",(function(){if(navigator.clipboard){let a=$("textarea",b).val();navigator.clipboard.writeText(a)}return y(),!1})),$('form [type="button"]',b).on("click",y),$("input",b).on("change",j)}))})();