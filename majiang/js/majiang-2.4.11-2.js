(()=>{var t={5209:(t,e,i)=>{"use strict";
/*!
 *  @kobalab/majiang-ai v1.0.10
 *
 *  Copyright(C) 2021 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/majiang-ai/blob/master/LICENSE
 */const n=i(8739),s=i(9145),a=[12,72,216];function o(t){let e=[];for(let i of t)"z"!=i[0]&&"5"==i[1]&&e.push(i.replace(/5/,"0")),e.push(i);return e}t.exports=class extends n.Player{qipai(t){this._defen_cache={},this._eval_cache={},this._suanpai=new s(this._rule["赤牌"]),this._suanpai.qipai(t,(this._id+4-this._model.qijia+4-t.jushu)%4),super.qipai(t)}zimo(t,e){t.l==this._menfeng&&(this._eval_cache={}),this._suanpai.zimo(t),super.zimo(t,e)}dapai(t){t.l!=this._menfeng&&(this._eval_cache={}),this._suanpai.dapai(t),super.dapai(t)}fulou(t){this._suanpai.fulou(t),super.fulou(t)}gang(t){this._suanpai.gang(t),super.gang(t)}kaigang(t){this._defen_cache={},this._eval_cache={},this._suanpai.kaigang(t),super.kaigang(t)}action_kaiju(t){this._callback()}action_qipai(t){this._callback()}action_zimo(t,e){if(t.l!=this._menfeng)return this._callback();let i;this.select_hule(null,e)?this._callback({hule:"-"}):this.select_pingju()?this._callback({daopai:"-"}):(i=this.select_gang())?this._callback({gang:i}):this._callback({dapai:this.select_dapai()})}action_dapai(t){if(t.l==this._menfeng)return void(this.select_daopai()?this._callback({daopai:"-"}):this._callback());let e;this.select_hule(t)?this._callback({hule:"-"}):(e=this.select_fulou(t))?this._callback({fulou:e}):this.select_daopai()?this._callback({daopai:"-"}):this._callback()}action_fulou(t){return t.l!=this._menfeng||t.m.match(/^[mpsz]\d{4}/)?this._callback():void this._callback({dapai:this.select_dapai()})}action_gang(t){if(t.l==this._menfeng)return this._callback();this.select_hule(t,!0)?this._callback({hule:"-"}):this._callback()}action_hule(t){this._callback()}action_pingju(t){this._callback()}action_jieju(t){this._callback()}select_hule(t,e,i){let n;if(t){if(t.m&&t.m.match(/^[mpsz]\d{4}$/))return!1;let e=["","+","=","-"][(4+t.l-this._menfeng)%4];n=t.m?t.m[0]+t.m.slice(-1)+e:t.p.slice(0,2)+e}let s=this.allow_hule(this.shoupai,n,e);if(i&&s){let t=this.shoupai.clone();n&&t.zimo(n),i.push({m:"",n_xiangting:-1,ev:this.get_defen(this.shoupai,n),shoupai:t.toString()})}return s}select_pingju(){return!(n.Util.xiangting(this.shoupai)<4)&&this.allow_pingju(this.shoupai)}select_fulou(t,e){let i=n.Util.xiangting(this.shoupai);if(this._model.shoupai.find((t=>t.lizhi))&&i>=3)return;let s=["","+","=","-"][(4+t.l-this._menfeng)%4],a=t.p.slice(0,2)+s;if(i<3){let t,s=this.get_gang_mianzi(this.shoupai,a).concat(this.get_peng_mianzi(this.shoupai,a)).concat(this.get_chi_mianzi(this.shoupai,a));if(!s.length)return;let o=this._suanpai.paishu_all(),r=this.eval_shoupai(this.shoupai,o,"");e&&e.push({m:"",n_xiangting:i,ev:r,shoupai:this.shoupai.toString()});for(let i of s){let s=this.shoupai.clone().fulou(i),a=n.Util.xiangting(s);if(a>=3)continue;let l=this.eval_shoupai(s,o);if(e&&l>0&&e.push({m:i,n_xiangting:a,ev:l,shoupai:s.toString()}),this._model.shoupai.find((t=>t.lizhi))){if(a>0&&l<1200)continue;if(0==a&&l<500)continue}l-r>1e-7&&(r=l,t=i)}return t}{let t,s=this.get_peng_mianzi(this.shoupai,a).concat(this.get_chi_mianzi(this.shoupai,a));if(!s.length)return;if(i=this.xiangting(this.shoupai),e){t=this._suanpai.paishu_all();let s=this.eval_shoupai(this.shoupai,t),a=n.Util.tingpai(this.shoupai).map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);e.push({m:"",n_xiangting:i,ev:s,n_tingpai:a,shoupai:this.shoupai.toString()})}for(let t of s){let n=this.shoupai.clone().fulou(t),s=this.xiangting(n);if(!(s>=i))return e&&e.push({m:t,n_xiangting:s,shoupai:n.toString()}),t}}}select_gang(t){let e=n.Util.xiangting(this.shoupai);if(this._model.shoupai.find((t=>t.lizhi))&&e>0)return;let i=this._suanpai.paishu_all();if(e<3){let e,s=this.eval_shoupai(this.shoupai,i);for(let a of this.get_gang_mianzi(this.shoupai)){let o=this.shoupai.clone().gang(a),r=n.Util.xiangting(o);if(r>=3)continue;let l=this.eval_shoupai(o,i);if(t){let e=a.match(/\d{4}$/)?a.slice(0,2):a[0]+a.slice(-1),i=n.Util.tingpai(o),s=i.map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);t.push({p:e,m:a,n_xiangting:r,ev:l,tingpai:i,n_tingpai:s})}l-s>-1e-7&&(e=a,s=l)}return e}e=this.xiangting(this.shoupai);for(let s of this.get_gang_mianzi(this.shoupai)){let a=this.shoupai.clone().gang(s);if(this.xiangting(a)==e){if(t){let o=s.match(/\d{4}$/)?s.slice(0,2):s[0]+s.slice(-1),r=this.eval_shoupai(a,i),l=n.Util.tingpai(a),h=l.map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);t.push({p:o,m:s,n_xiangting:e,ev:r,tingpai:l,n_tingpai:h})}return s}}}select_dapai(t){let e,i=1/0;const s=this._suanpai.suan_weixian_all(this.shoupai._bingpai);if(s)for(let t of this.get_dapai(this.shoupai))s(t)<i&&(i=s(t),e=t);let a=e,o=-1,r=0,l=[],h=n.Util.xiangting(this.shoupai),u=this._suanpai.paishu_all();const p=this._suanpai.make_paijia(this.shoupai),c=(t,e)=>p(t)-p(e);for(let p of this.get_dapai(this.shoupai).reverse().sort(c)){a||(a=p);let c=this.shoupai.clone().dapai(p);if(h>2&&this.xiangting(c)>h||n.Util.xiangting(c)>h){if(e)continue;h<2&&l.push(p);continue}let f=this.eval_shoupai(c,u),d=n.Util.tingpai(c),g=d.map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);if(t&&(t.map((t=>{t.p==p.slice(0,2)&&t.m&&(t.weixian=s&&s(p))})),t.find((t=>t.p==p.slice(0,2)&&!t.m))||t.push({p:p.slice(0,2),n_xiangting:h,ev:f,tingpai:d,n_tingpai:g,weixian:s&&s(p)})),s&&s(p)>i){if(s(p)>=13.5)continue;if(h>2||h>0&&f<300){if(s(p)>=8)continue;if(i<3)continue}else if(h>0&&f<1200||0==h&&f<200){if(s(p)>=8)continue;if(i<3&&s(p)>=3)continue}}f-o>1e-7&&(o=f,a=p,r=6*g)}let f=o;for(let e of l){let i=this.shoupai.clone().dapai(e),s=n.Util.tingpai(i),l=s.map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);if(l<r)continue;let p=e[0]+(+e[1]||5),c=this.eval_backtrack(i,u,p,2*f);t&&c>0&&(t.find((t=>t.p==e.slice(0,2)&&!t.m))||t.push({p:e.slice(0,2),n_xiangting:h+1,ev:c,tingpai:s,n_tingpai:l})),c-o>1e-7&&(o=c,a=e)}return e&&t&&a==e&&!t.find((t=>!t.m&&t.p==e.slice(0,2)))&&t.push({p:e.slice(0,2),n_xiangting:n.Util.xiangting(this.shoupai.clone().dapai(e)),weixian:s&&s(e)}),this.select_lizhi(a)&&o>=200&&(a+="*"),a}select_lizhi(t){return this.allow_lizhi(this.shoupai,t)}select_daopai(){return this.allow_no_daopai(this.shoupai)}xiangting(t){function e(t,e){const i=new RegExp(`^[z${e}]`);if(t._fulou.find((t=>!t.match(i))))return 1/0;let s=t.clone();for(let t of["m","p","s"])t!=e&&(s._bingpai[t]=[0,0,0,0,0,0,0,0,0,0]);return n.Util.xiangting(s)}return Math.min(function(t){return t.menqian?n.Util.xiangting(t):1/0}(t),function(t,e,i,s){let a,o=0;for(let n of[e+1,i+1,5,6,7]){t._bingpai.z[n]>=3?o++:2==t._bingpai.z[n]&&s._paishu.z[n]&&(a="z"+n+n+n+"+");for(let e of t._fulou)"z"==e[0]&&e[1]==n&&o++}if(o)return n.Util.xiangting(t);if(a){let e=t.clone();return e.fulou(a,!1),e._zimo=null,n.Util.xiangting(e)+1}return 1/0}(t,this._model.zhuangfeng,this._menfeng,this._suanpai),function(t,e){if(!e["クイタンあり"]&&!t.menqian)return 1/0;if(t._fulou.find((t=>t.match(/^z|[19]/))))return 1/0;let i=t.clone();for(let t of["m","p","s"])i._bingpai[t][1]=0,i._bingpai[t][9]=0;return i._bingpai.z=[0,0,0,0,0,0,0,0],n.Util.xiangting(i)}(t,this._rule),function(t){if(t._fulou.map((t=>t.replace(/0/,"5"))).find((t=>!t.match(/^[mpsz](\d)\1\1/))))return 1/0;let e=t._fulou.length,i=0;for(let n of["m","p","s","z"]){let s=t._bingpai[n];for(let t=1;t<s.length;t++)s[t]>=3?e++:2==s[t]&&i++}return e+i>5&&(i=5-e),8-2*e-i}(t),e(t,"m"),e(t,"p"),e(t,"s"))}tingpai(t){let e=this.xiangting(t),i=[];for(let s of n.Util.tingpai(t,(t=>this.xiangting(t)))){if(e>0){for(let n of this.get_peng_mianzi(t,s+"+")){let a=t.clone().fulou(n);if(this.xiangting(a)<e){i.push(s+"+");break}}if(i[i.length-1]==s+"+")continue;for(let n of this.get_chi_mianzi(t,s+"-")){let a=t.clone().fulou(n);if(this.xiangting(a)<e){i.push(s+"-");break}}if(i[i.length-1]==s+"-")continue}i.push(s)}return i}get_defen(t,e){let i=t.toString();if(e&&(i=i.replace(/^([^\*\,]*)(.*)$/,`$1${e}$2`)),null!=this._defen_cache[i])return this._defen_cache[i];let s={rule:this._rule,zhuangfeng:this._model.zhuangfeng,menfeng:this._menfeng,hupai:{lizhi:t.menqian},baopai:this.shan.baopai,jicun:{changbang:0,lizhibang:0}},a=n.Util.hule(t,e,s);return this._defen_cache[i]=a.defen,a.defen}eval_shoupai(t,e,i){let s=t.toString()+(null!=i?`:${i}`:"");if(null!=this._eval_cache[s])return this._eval_cache[s];let r=0,l=n.Util.xiangting(t);if(-1==l)r=this.get_defen(t);else if(t._zimo)for(let s of this.get_dapai(t)){let a=t.clone().dapai(s);if(n.Util.xiangting(a)>l)continue;let o=this.eval_shoupai(a,e,i);o>r&&(r=o)}else if(l<3){for(let s of o(n.Util.tingpai(t))){if(s==i){r=0;break}if(0==e[s])continue;let n=t.clone().zimo(s);e[s]--;let a=this.eval_shoupai(n,e,i);i||l>0&&(a+=this.eval_fulou(t,s,e,i)),e[s]++,r+=a*e[s]}r/=a[l]}else for(let i of o(this.tingpai(t)))0!=e[i.slice(0,2)]&&(r+=e[i.slice(0,2)]*("+"==i[2]?4:"-"==i[2]?2:1));return this._eval_cache[s]=r,r}eval_backtrack(t,e,i,s){let r=n.Util.xiangting(t),l=0;for(let a of o(n.Util.tingpai(t))){if(a.replace(/0/,"5")==i)continue;if(0==e[a])continue;let n=t.clone().zimo(a);e[a]--;let o=this.eval_shoupai(n,e,i);e[a]++,o-s>1e-7&&(l+=o*e[a])}return l/a[r]}eval_fulou(t,e,i,s){let a=n.Util.xiangting(t),o=0;for(let r of this.get_peng_mianzi(t,e+"+")){let e=t.clone().fulou(r);n.Util.xiangting(e)>=a||(o=Math.max(this.eval_shoupai(e,i,s),o))}let r=0;for(let o of this.get_chi_mianzi(t,e+"-")){let e=t.clone().fulou(o);n.Util.xiangting(e)>=a||(r=Math.max(this.eval_shoupai(e,i,s),r))}return o>r?3*o:2*o+r}}},9145:(t,e,i)=>{"use strict";const n=i(8739);t.exports=class{constructor(t){this._paishu={m:[t.m,4,4,4,4,4,4,4,4,4],p:[t.p,4,4,4,4,4,4,4,4,4],s:[t.s,4,4,4,4,4,4,4,4,4],z:[0,4,4,4,4,4,4,4]},this._zhuangfeng=0,this._menfeng=0,this._baopai=[],this._dapai=[{},{},{},{}],this._lizhi=[]}decrease(t){this._paishu[t[0]][t[1]]--,0==t[1]&&this._paishu[t[0]][5]--}qipai(t,e){this._zhuangfeng=t.zhuangfeng,this._menfeng=e,this._baopai=[t.baopai],this.decrease(t.baopai);let i=t.shoupai[e];for(let t of i.match(/[mpsz]\d[\d\+\=\-]*/g)||[]){let e=t[0];for(let i of t.match(/\d/g))this.decrease(e+i)}}zimo(t){t.l==this._menfeng&&this.decrease(t.p)}dapai(t){t.l!=this._menfeng&&(this.decrease(t.p),"*"==t.p.slice(-1)&&(this._lizhi[t.l]=!0));let e=t.p[0]+(+t.p[1]||5);this._dapai[t.l][e]=!0;for(let t=0;t<4;t++)this._lizhi[t]&&(this._dapai[t][e]=!0)}fulou(t){if(t.l!=this._menfeng){let e=t.m[0];for(let i of t.m.match(/\d(?![\+\=\-])/g))this.decrease(e+i)}}gang(t){if(t.l!=this._menfeng)if(t.m.match(/^[mpsz]\d{4}$/)){let e=t.m[0];for(let i of t.m.match(/\d/g))this.decrease(e+i)}else{let e=t.m[0],i=t.m.slice(-1);this.decrease(e+i)}}kaigang(t){this._baopai.push(t.baopai),this.decrease(t.baopai)}paishu_all(){let t={};for(let e of["m","p","s","z"])for(let i of"z"==e?[1,2,3,4,5,6,7]:[0,1,2,3,4,5,6,7,8,9])t[e+i]=5==i?this._paishu[e][5]-this._paishu[e][0]:this._paishu[e][i];return t}paijia(t){const e=(t,e)=>{if(e<1||9<e)return 0;let i=1;for(let s of this._baopai)t+e==n.Shan.zhenbaopai(s)&&(i*=2);return i};let i=0,s=t[0],a=+t[1]||5;const o=Math.min,r=Math.max,l=this._paishu[s];if("z"==s)i="0"!=t[1]?l[a]*e(s,a):0,a==this._zhuangfeng+1&&(i*=2),a==this._menfeng+1&&(i*=2),5<=a&&a<=7&&(i*=2);else{let n=1<=a-2?o(l[a-2],l[a-1]):0,h=1<=a-1&&a+1<=9?o(l[a-1],l[a+1]):0,u=a+2<=9?o(l[a+1],l[a+2]):0,p=[n,r(n,h),l[a],r(h,u),u];i=p[0]*e(s,a-2)+p[1]*e(s,a-1)+p[2]*e(s,a)+p[3]*e(s,a+1)+p[4]*e(s,a+2),i+=l[0]?7==a?o(l[0],p[0])*e(s,a-2):6==a?o(l[0],p[1])*e(s,a-1):5==a?o(l[0],p[2])*e(s,a):4==a?o(l[0],p[3])*e(s,a+1):3==a?o(l[0],p[4])*e(s,a+2):0:0,"0"==t[1]&&(i*=2)}return i*=e(s,a),i}make_paijia(t){let e={};for(let i of["m","p","s","z"])e[i]=t._bingpai[i].slice(1).reduce(((t,e)=>t+e));let i=t._bingpai.z.slice(1,5).reduce(((t,e)=>t+e)),n=t._bingpai.z.slice(5).reduce(((t,e)=>t+e));for(let s of t._fulou)e[s[0]]+=3,s.match(/^z[1234]/)&&(i+=3),s.match(/^z[567]/)&&(n+=3);let s={};return t=>s[t]??(s[t]=this.paijia(t)*(t.match(/^z[1234]/)&&i>=9||t.match(/^z[567]/)&&n>=6?8:"z"==t[0]&&Math.max(...["m","p","s"].map((t=>e[t])))+e.z>=10?4:e[t[0]]+e.z>=10?2:1))}suan_weixian(t,e,i){let n=t[0],s=+t[1]||5,a=0;if(this._dapai[e][n+s])return a;const o=this._paishu[n];return a+=o[s]-(i?0:1)==3?"z"==n?8:3:o[s]-(i?0:1)==2?3:o[s]-(i?0:1)==1?1:0,"z"==n||(a+=s-2<1||0==Math.min(o[s-2],o[s-1])?0:s-2==1?3:this._dapai[e][n+(s-3)]?0:10,a+=s-1<1||s+1>9||0==Math.min(o[s-1],o[s+1])?0:3,a+=s+2>9||0==Math.min(o[s+1],o[s+2])?0:s+2==9?3:this._dapai[e][n+(s+3)]?0:10),a}suan_weixian_all(t){let e;for(let i=0;i<4;i++){if(!this._lizhi[i])continue;e||(e={});let n={},s=0;for(let e of["m","p","s","z"])for(let a=1;a<this._paishu[e].length;a++)n[e+a]=this.suan_weixian(e+a,i,t[e][a]),s+=n[e+a];for(let t of Object.keys(n))n[t]=n[t]/(s||1)*100*(0==i?1.4:1),e[t]||(e[t]=0),e[t]=Math.max(e[t],n[t])}if(e)return t=>e[t[0]+(+t[1]||5)]}}},1015:(t,e,i)=>{"use strict";const n={Shoupai:i(8496),He:i(5692)};class s{constructor(t){this.paishu=70,this.baopai=[].concat(t||[]),this.fubaopai}zimo(t){return this.paishu--,t||"_"}kaigang(t){this.baopai.push(t)}}t.exports=class{constructor(t){t&&this.kaiju(t)}kaiju(t){this.title=t.title,this.player=t.player,this.qijia=t.qijia,this.zhuangfeng=0,this.jushu=0,this.changbang=0,this.lizhibang=0,this.defen=[],this.shan=null,this.shoupai=[],this.he=[],this.player_id=[0,1,2,3],this.lunban=-1,this._lizhi,this._fenpei,this._lianzhuang,this._changbang,this._lizhibang}menfeng(t){return(t+4-this.qijia+4-this.jushu)%4}qipai(t){this.zhuangfeng=t.zhuangfeng,this.jushu=t.jushu,this.changbang=t.changbang,this.lizhibang=t.lizhibang,this.shan=new s(t.baopai);for(let e=0;e<4;e++){let i=t.shoupai[e]||"_".repeat(13);this.shoupai[e]=n.Shoupai.fromString(i),this.he[e]=new n.He,this.player_id[e]=(this.qijia+this.jushu+e)%4,this.defen[this.player_id[e]]=t.defen[e]}this.lunban=-1,this._lizhi=!1,this._fenpei=null,this._changbang=t.changbang,this._lizhibang=t.lizhibang}lizhi(){this._lizhi&&(this.defen[this.player_id[this.lunban]]-=1e3,this.lizhibang++,this._lizhi=!1)}zimo(t){this.lizhi(),this.lunban=t.l,this.shoupai[t.l].zimo(this.shan.zimo(t.p),!1)}dapai(t){this.lunban=t.l,this.shoupai[t.l].dapai(t.p,!1),this.he[t.l].dapai(t.p),this._lizhi="*"==t.p.slice(-1)}fulou(t){this.lizhi(),this.he[this.lunban].fulou(t.m),this.lunban=t.l,this.shoupai[t.l].fulou(t.m,!1)}gang(t){this.lunban=t.l,this.shoupai[t.l].gang(t.m,!1)}kaigang(t){this.shan.kaigang(t.baopai)}hule(t){let e=this.shoupai[t.l];if(e.fromString(t.shoupai),null!=t.baojia&&e.dapai(e.get_dapai().pop()),this._fenpei){this.changbang=0,this.lizhibang=0;for(let t=0;t<4;t++)this.defen[this.player_id[t]]+=this._fenpei[t]}this.shan.fubaopai=t.fubaopai,this._fenpei=t.fenpei,this._lizhibang=0,0==t.l&&(this._lianzhuang=!0)}pingju(t){t.name.match(/^三家和/)||this.lizhi();for(let e=0;e<4;e++)t.shoupai[e]&&this.shoupai[e].fromString(t.shoupai[e]);this._fenpei=t.fenpei,this._lizhibang=this.lizhibang,this._lianzhuang=!0}last(){if(this._fenpei){this.changbang=this._lianzhuang?this._changbang+1:0,this.lizhibang=this._lizhibang;for(let t=0;t<4;t++)this.defen[this.player_id[t]]+=this._fenpei[t]}}jieju(t){for(let e=0;e<4;e++)this.defen[e]=t.defen[e];this.lunban=-1}}},9101:(t,e,i)=>{"use strict";const n={rule:i(1041),Shoupai:i(8496),Shan:i(7551),He:i(5692),Util:Object.assign(i(5598),i(1419))};t.exports=class t{constructor(t,e,i,s){this._players=t,this._callback=e||(()=>{}),this._rule=i||n.rule(),this._model={title:s||"電脳麻将\n"+(new Date).toLocaleString(),player:["私","下家","対面","上家"],qijia:0,zhuangfeng:0,jushu:0,changbang:0,lizhibang:0,defen:[0,0,0,0].map((t=>this._rule["配給原点"])),shan:null,shoupai:[],he:[],player_id:[0,1,2,3]},this._view,this._status,this._reply=[],this._sync=!1,this._stop=null,this._speed=3,this._wait=0,this._timeout_id,this._handler}get model(){return this._model}set view(t){this._view=t}get speed(){return this._speed}set speed(t){this._speed=t}set wait(t){this._wait=t}set handler(t){this._handler=t}add_paipu(t){this._paipu.log[this._paipu.log.length-1].push(t)}delay(t,e){if(this._sync)return t();e=0==this._speed?0:null==e?Math.max(500,200*this._speed):e,setTimeout(t,e)}say(t,e){this._view&&this._view.say(t,e)}stop(t=()=>{}){this._stop=t}start(){this._timeout_id||(this._stop=null,this._timeout_id=setTimeout((()=>this.next()),0))}notify_players(t,e){for(let t=0;t<4;t++){let i=this._model.player_id[t];this._sync?this._players[i].action(e[t]):setTimeout((()=>{this._players[i].action(e[t])}),0)}}call_players(t,e,i){i=0==this._speed?0:null==i?200*this._speed:i,this._status=t,this._reply=[];for(let t=0;t<4;t++){let i=this._model.player_id[t];this._sync?this._players[i].action(e[t],(t=>this.reply(i,t))):setTimeout((()=>{this._players[i].action(e[t],(t=>this.reply(i,t)))}),0)}this._sync||(this._timeout_id=setTimeout((()=>this.next()),i))}reply(t,e){this._reply[t]=e||{},this._sync||this._reply.filter((t=>t)).length<4||this._timeout_id||(this._timeout_id=setTimeout((()=>this.next()),0))}next(){if(this._timeout_id=clearTimeout(this._timeout_id),!(this._reply.filter((t=>t)).length<4))return this._stop?this._stop():void("kaiju"==this._status?this.reply_kaiju():"qipai"==this._status?this.reply_qipai():"zimo"==this._status?this.reply_zimo():"dapai"==this._status?this.reply_dapai():"fulou"==this._status?this.reply_fulou():"gang"==this._status?this.reply_gang():"gangzimo"==this._status?this.reply_zimo():"hule"==this._status?this.reply_hule():"pingju"==this._status?this.reply_pingju():this._callback(this._paipu))}do_sync(){for(this._sync=!0,this.kaiju();;)if("kaiju"==this._status)this.reply_kaiju();else if("qipai"==this._status)this.reply_qipai();else if("zimo"==this._status)this.reply_zimo();else if("dapai"==this._status)this.reply_dapai();else if("fulou"==this._status)this.reply_fulou();else if("gang"==this._status)this.reply_gang();else if("gangzimo"==this._status)this.reply_zimo();else if("hule"==this._status)this.reply_hule();else{if("pingju"!=this._status)break;this.reply_pingju()}return this._callback(this._paipu),this}kaiju(t){this._model.qijia=t??Math.floor(4*Math.random()),this._max_jushu=0==this._rule["場数"]?0:4*this._rule["場数"]-1,this._paipu={title:this._model.title,player:this._model.player,qijia:this._model.qijia,log:[],defen:this._model.defen.concat(),point:[],rank:[]};let e=[];for(let t=0;t<4;t++)e[t]=JSON.parse(JSON.stringify({kaiju:{id:t,rule:this._rule,title:this._paipu.title,player:this._paipu.player,qijia:this._paipu.qijia}}));this.call_players("kaiju",e,0),this._view&&this._view.kaiju()}qipai(t){let e=this._model;e.shan=t||new n.Shan(this._rule);for(let t=0;t<4;t++){let i=[];for(let t=0;t<13;t++)i.push(e.shan.zimo());e.shoupai[t]=new n.Shoupai(i),e.he[t]=new n.He,e.player_id[t]=(e.qijia+e.jushu+t)%4}e.lunban=-1,this._diyizimo=!0,this._fengpai=this._rule["途中流局あり"],this._dapai=null,this._gang=null,this._lizhi=[0,0,0,0],this._yifa=[0,0,0,0],this._n_gang=[0,0,0,0],this._neng_rong=[1,1,1,1],this._hule=[],this._hule_option=null,this._no_game=!1,this._lianzhuang=!1,this._changbang=e.changbang,this._fenpei=null,this._paipu.defen=e.defen.concat(),this._paipu.log.push([]);let i={qipai:{zhuangfeng:e.zhuangfeng,jushu:e.jushu,changbang:e.changbang,lizhibang:e.lizhibang,defen:e.player_id.map((t=>e.defen[t])),baopai:e.shan.baopai[0],shoupai:e.shoupai.map((t=>t.toString()))}};this.add_paipu(i);let s=[];for(let t=0;t<4;t++){s[t]=JSON.parse(JSON.stringify(i));for(let e=0;e<4;e++)e!=t&&(s[t].qipai.shoupai[e]="")}this.call_players("qipai",s,0),this._view&&this._view.redraw()}zimo(){let t=this._model;t.lunban=(t.lunban+1)%4;let e=t.shan.zimo();t.shoupai[t.lunban].zimo(e);let i={zimo:{l:t.lunban,p:e}};this.add_paipu(i);let n=[];for(let e=0;e<4;e++)n[e]=JSON.parse(JSON.stringify(i)),e!=t.lunban&&(n[e].zimo.p="");this.call_players("zimo",n),this._view&&this._view.update(i)}dapai(t){let e=this._model;this._yifa[e.lunban]=0,e.shoupai[e.lunban].lizhi||(this._neng_rong[e.lunban]=!0),e.shoupai[e.lunban].dapai(t),e.he[e.lunban].dapai(t),this._diyizimo?(t.match(/^z[1234]/)||(this._fengpai=!1),this._dapai&&this._dapai.slice(0,2)!=t.slice(0,2)&&(this._fengpai=!1)):this._fengpai=!1,"*"==t.slice(-1)&&(this._lizhi[e.lunban]=this._diyizimo?2:1,this._yifa[e.lunban]=this._rule["一発あり"]),0==n.Util.xiangting(e.shoupai[e.lunban])&&n.Util.tingpai(e.shoupai[e.lunban]).find((t=>e.he[e.lunban].find(t)))&&(this._neng_rong[e.lunban]=!1),this._dapai=t;let i={dapai:{l:e.lunban,p:t}};this.add_paipu(i),this._gang&&this.kaigang();let s=[];for(let t=0;t<4;t++)s[t]=JSON.parse(JSON.stringify(i));this.call_players("dapai",s),this._view&&this._view.update(i)}fulou(t){let e=this._model;this._diyizimo=!1,this._yifa=[0,0,0,0],e.he[e.lunban].fulou(t);let i=t.match(/[\+\=\-]/);e.lunban=(e.lunban+"_-=+".indexOf(i))%4,e.shoupai[e.lunban].fulou(t),t.match(/^[mpsz]\d{4}/)&&(this._gang=t,this._n_gang[e.lunban]++);let n={fulou:{l:e.lunban,m:t}};this.add_paipu(n);let s=[];for(let t=0;t<4;t++)s[t]=JSON.parse(JSON.stringify(n));this.call_players("fulou",s),this._view&&this._view.update(n)}gang(t){let e=this._model;e.shoupai[e.lunban].gang(t);let i={gang:{l:e.lunban,m:t}};this.add_paipu(i),this._gang&&this.kaigang(),this._gang=t,this._n_gang[e.lunban]++;let n=[];for(let t=0;t<4;t++)n[t]=JSON.parse(JSON.stringify(i));this.call_players("gang",n),this._view&&this._view.update(i)}gangzimo(){let t=this._model;this._diyizimo=!1,this._yifa=[0,0,0,0];let e=t.shan.gangzimo();t.shoupai[t.lunban].zimo(e);let i={gangzimo:{l:t.lunban,p:e}};this.add_paipu(i),this._rule["カンドラ後乗せ"]&&!this._gang.match(/^[mpsz]\d{4}$/)||this.kaigang();let n=[];for(let e=0;e<4;e++)n[e]=JSON.parse(JSON.stringify(i)),e!=t.lunban&&(n[e].gangzimo.p="");this.call_players("gangzimo",n),this._view&&this._view.update(i)}kaigang(){if(this._gang=null,!this._rule["カンドラあり"])return;let t=this._model;t.shan.kaigang();let e={kaigang:{baopai:t.shan.baopai.pop()}};this.add_paipu(e);let i=[];for(let t=0;t<4;t++)i[t]=JSON.parse(JSON.stringify(e));this.notify_players("kaigang",i),this._view&&this._view.update(e)}hule(){let t=this._model;"hule"!=this._status&&(t.shan.close(),this._hule_option="gang"==this._status?"qianggang":"gangzimo"==this._status?"lingshang":null);let e=this._hule.length?this._hule.shift():t.lunban,i=e==t.lunban?null:("qianggang"==this._hule_option?this._gang[0]+this._gang.slice(-1):this._dapai.slice(0,2))+"_+=-"[(4+t.lunban-e)%4],s=t.shoupai[e].clone(),a=s.lizhi?t.shan.fubaopai:null,o={rule:this._rule,zhuangfeng:t.zhuangfeng,menfeng:e,hupai:{lizhi:this._lizhi[e],yifa:this._yifa[e],qianggang:"qianggang"==this._hule_option,lingshang:"lingshang"==this._hule_option,haidi:t.shan.paishu>0||"lingshang"==this._hule_option?0:i?2:1,tianhu:!this._diyizimo||i?0:0==e?1:2},baopai:t.shan.baopai,fubaopai:a,jicun:{changbang:t.changbang,lizhibang:t.lizhibang}},r=n.Util.hule(s,i,o);this._rule["連荘方式"]>0&&0==e&&(this._lianzhuang=!0),0==this._rule["場数"]&&(this._lianzhuang=!1),this._fenpei=r.fenpei;let l={hule:{l:e,shoupai:i?s.zimo(i).toString():s.toString(),baojia:i?t.lunban:null,fubaopai:a,fu:r.fu,fanshu:r.fanshu,damanguan:r.damanguan,defen:r.defen,hupai:r.hupai,fenpei:r.fenpei}};for(let t of["fu","fanshu","damanguan"])l.hule[t]||delete l.hule[t];this.add_paipu(l);let h=[];for(let t=0;t<4;t++)h[t]=JSON.parse(JSON.stringify(l));this.call_players("hule",h,this._wait),this._view&&this._view.update(l)}pingju(t,e=["","","",""]){let i=this._model,s=[0,0,0,0];if(t)this._no_game=!0,this._lianzhuang=!0;else{let a=0;for(let t=0;t<4;t++)(!this._rule["ノーテン宣言あり"]||e[t]||i.shoupai[t].lizhi)&&((this._rule["ノーテン罰あり"]||2==this._rule["連荘方式"]&&0==t||i.shoupai[t].lizhi)&&0==n.Util.xiangting(i.shoupai[t])&&n.Util.tingpai(i.shoupai[t]).length>0?(a++,e[t]=i.shoupai[t].toString(),2==this._rule["連荘方式"]&&0==t&&(this._lianzhuang=!0)):e[t]="");if(this._rule["流し満貫あり"])for(let e=0;e<4;e++){let n=!0;for(let t of i.he[e]._pai){if(t.match(/[\+\=\-]$/)){n=!1;break}if(!t.match(/^z/)&&!t.match(/^[mps][19]/)){n=!1;break}}if(n){t="流し満貫";for(let t=0;t<4;t++)s[t]+=0==e&&t==e?12e3:0==e?-4e3:0!=e&&t==e?8e3:0!=e&&0==t?-4e3:-2e3}}if(!t&&(t="荒牌平局",this._rule["ノーテン罰あり"]&&0<a&&a<4))for(let t=0;t<4;t++)s[t]=e[t]?3e3/a:-3e3/(4-a);3==this._rule["連荘方式"]&&(this._lianzhuang=!0)}0==this._rule["場数"]&&(this._lianzhuang=!0),this._fenpei=s;let a={pingju:{name:t,shoupai:e,fenpei:s}};this.add_paipu(a);let o=[];for(let t=0;t<4;t++)o[t]=JSON.parse(JSON.stringify(a));this.call_players("pingju",o,this._wait),this._view&&this._view.update(a)}last(){let t=this._model;t.lunban=-1,this._view&&this._view.update(),this._lianzhuang||(t.jushu++,t.zhuangfeng+=t.jushu/4|0,t.jushu=t.jushu%4);let e=!1,i=-1;const n=t.defen;for(let s=0;s<4;s++){let a=(t.qijia+s)%4;n[a]<0&&this._rule["トビ終了あり"]&&(e=!0),n[a]>=3e4&&(i<0||n[a]>n[i])&&(i=a)}let s=4*t.zhuangfeng+t.jushu;15<s||4*(this._rule["場数"]+1)-1<s?e=!0:this._max_jushu<s?0==this._rule["延長戦方式"]||0==this._rule["場数"]||i>=0?e=!0:this._max_jushu+=3==this._rule["延長戦方式"]?4:2==this._rule["延長戦方式"]?1:0:this._max_jushu==s&&this._rule["オーラス止めあり"]&&i==t.player_id[0]&&this._lianzhuang&&!this._no_game&&(e=!0),e?this.delay((()=>this.jieju()),0):this.delay((()=>this.qipai()),0)}jieju(){let t=this._model,e=[];const i=t.defen;for(let n=0;n<4;n++){let s=(t.qijia+n)%4;for(let t=0;t<4;t++)if(t==e.length||i[s]>i[e[t]]){e.splice(t,0,s);break}}i[e[0]]+=1e3*t.lizhibang,this._paipu.defen=i;let n=[0,0,0,0];for(let t=0;t<4;t++)n[e[t]]=t+1;this._paipu.rank=n;const s=!this._rule["順位点"].find((t=>t.match(/\.\d$/)));let a=[0,0,0,0];for(let t=1;t<4;t++){let n=e[t];a[n]=(i[n]-3e4)/1e3+ +this._rule["順位点"][t],s&&(a[n]=Math.round(a[n])),a[e[0]]-=a[n]}this._paipu.point=a.map((t=>t.toFixed(s?0:1)));let o={jieju:this._paipu},r=[];for(let t=0;t<4;t++)r[t]=JSON.parse(JSON.stringify(o));this.call_players("jieju",r,this._wait),this._view&&this._view.summary(this._paipu),this._handler&&this._handler()}get_reply(t){let e=this._model;return this._reply[e.player_id[t]]}reply_kaiju(){this.delay((()=>this.qipai()),0)}reply_qipai(){this.delay((()=>this.zimo()),0)}reply_zimo(){let t=this._model,e=this.get_reply(t.lunban);if(e.daopai){if(this.allow_pingju()){let e=["","","",""];return e[t.lunban]=t.shoupai[t.lunban].toString(),this.delay((()=>this.pingju("九種九牌",e)),0)}}else if(e.hule){if(this.allow_hule())return this.say("zimo",t.lunban),this.delay((()=>this.hule()))}else if(e.gang){if(this.get_gang_mianzi().find((t=>t==e.gang)))return this.say("gang",t.lunban),this.delay((()=>this.gang(e.gang)))}else if(e.dapai){let i=e.dapai.replace(/\*$/,"");if(this.get_dapai().find((t=>t==i)))return"*"==e.dapai.slice(-1)&&this.allow_lizhi(i)?(this.say("lizhi",t.lunban),this.delay((()=>this.dapai(e.dapai)))):this.delay((()=>this.dapai(i)),0)}let i=this.get_dapai().pop();this.delay((()=>this.dapai(i)),0)}reply_dapai(){let t=this._model;for(let e=1;e<4;e++){let i=(t.lunban+e)%4;if(this.get_reply(i).hule&&this.allow_hule(i)){if(1==this._rule["最大同時和了数"]&&this._hule.length)continue;this.say("rong",i),this._hule.push(i)}else{let e=t.shoupai[i].clone().zimo(this._dapai);-1==n.Util.xiangting(e)&&(this._neng_rong[i]=!1)}}if(3==this._hule.length&&2==this._rule["最大同時和了数"]){let e=["","","",""];for(let i of this._hule)e[i]=t.shoupai[i].toString();return this.delay((()=>this.pingju("三家和",e)))}if(this._hule.length)return this.delay((()=>this.hule()));if("*"==this._dapai.slice(-1)&&(t.defen[t.player_id[t.lunban]]-=1e3,t.lizhibang++,4==this._lizhi.filter((t=>t)).length&&this._rule["途中流局あり"])){let e=t.shoupai.map((t=>t.toString()));return this.delay((()=>this.pingju("四家立直",e)))}if(this._diyizimo&&3==t.lunban&&(this._diyizimo=!1,this._fengpai))return this.delay((()=>this.pingju("四風連打")),0);if(4==this._n_gang.reduce(((t,e)=>t+e))&&Math.max(...this._n_gang)<4&&this._rule["途中流局あり"])return this.delay((()=>this.pingju("四開槓")),0);if(!t.shan.paishu){let t=["","","",""];for(let e=0;e<4;e++){let i=this.get_reply(e);i.daopai&&(t[e]=i.daopai)}return this.delay((()=>this.pingju("",t)),0)}for(let e=1;e<4;e++){let i=(t.lunban+e)%4,n=this.get_reply(i);if(n.fulou){let t=n.fulou.replace(/0/g,"5");if(t.match(/^[mpsz](\d)\1\1\1/)){if(this.get_gang_mianzi(i).find((t=>t==n.fulou)))return this.say("gang",i),this.delay((()=>this.fulou(n.fulou)))}else if(t.match(/^[mpsz](\d)\1\1/)&&this.get_peng_mianzi(i).find((t=>t==n.fulou)))return this.say("peng",i),this.delay((()=>this.fulou(n.fulou)))}}let e=(t.lunban+1)%4,i=this.get_reply(e);if(i.fulou&&this.get_chi_mianzi(e).find((t=>t==i.fulou)))return this.say("chi",e),this.delay((()=>this.fulou(i.fulou)));this.delay((()=>this.zimo()),0)}reply_fulou(){let t=this._model;if(this._gang)return this.delay((()=>this.gangzimo()),0);let e=this.get_reply(t.lunban);if(e.dapai&&this.get_dapai().find((t=>t==e.dapai)))return this.delay((()=>this.dapai(e.dapai)),0);let i=this.get_dapai().pop();this.delay((()=>this.dapai(i)),0)}reply_gang(){let t=this._model;if(this._gang.match(/^[mpsz]\d{4}$/))return this.delay((()=>this.gangzimo()),0);for(let e=1;e<4;e++){let i=(t.lunban+e)%4;if(this.get_reply(i).hule&&this.allow_hule(i)){if(1==this._rule["最大同時和了数"]&&this._hule.length)continue;this.say("rong",i),this._hule.push(i)}else{let e=this._gang[0]+this._gang.slice(-1),s=t.shoupai[i].clone().zimo(e);-1==n.Util.xiangting(s)&&(this._neng_rong[i]=!1)}}if(this._hule.length)return this.delay((()=>this.hule()));this.delay((()=>this.gangzimo()),0)}reply_hule(){let t=this._model;for(let e=0;e<4;e++)t.defen[t.player_id[e]]+=this._fenpei[e];return t.changbang=0,t.lizhibang=0,this._hule.length?this.delay((()=>this.hule())):(this._lianzhuang&&(t.changbang=this._changbang+1),this.delay((()=>this.last()),0))}reply_pingju(){let t=this._model;for(let e=0;e<4;e++)t.defen[t.player_id[e]]+=this._fenpei[e];t.changbang++,this.delay((()=>this.last()),0)}get_dapai(){let e=this._model;return t.get_dapai(this._rule,e.shoupai[e.lunban])}get_chi_mianzi(e){let i=this._model,n="_+=-"[(4+i.lunban-e)%4];return t.get_chi_mianzi(this._rule,i.shoupai[e],this._dapai+n,i.shan.paishu)}get_peng_mianzi(e){let i=this._model,n="_+=-"[(4+i.lunban-e)%4];return t.get_peng_mianzi(this._rule,i.shoupai[e],this._dapai+n,i.shan.paishu)}get_gang_mianzi(e){let i=this._model;if(null==e)return t.get_gang_mianzi(this._rule,i.shoupai[i.lunban],null,i.shan.paishu,this._n_gang.reduce(((t,e)=>t+e)));{let n="_+=-"[(4+i.lunban-e)%4];return t.get_gang_mianzi(this._rule,i.shoupai[e],this._dapai+n,i.shan.paishu,this._n_gang.reduce(((t,e)=>t+e)))}}allow_lizhi(e){let i=this._model;return t.allow_lizhi(this._rule,i.shoupai[i.lunban],e,i.shan.paishu,i.defen[i.player_id[i.lunban]])}allow_hule(e){let i=this._model;if(null==e){let e=i.shoupai[i.lunban].lizhi||"gangzimo"==this._status||0==i.shan.paishu;return t.allow_hule(this._rule,i.shoupai[i.lunban],null,i.zhuangfeng,i.lunban,e)}{let n=("gang"==this._status?this._gang[0]+this._gang.slice(-1):this._dapai)+"_+=-"[(4+i.lunban-e)%4],s=i.shoupai[e].lizhi||"gang"==this._status||0==i.shan.paishu;return t.allow_hule(this._rule,i.shoupai[e],n,i.zhuangfeng,e,s,this._neng_rong[e])}}allow_pingju(){let e=this._model;return t.allow_pingju(this._rule,e.shoupai[e.lunban],this._diyizimo)}static get_dapai(t,e){if(0==t["喰い替え許可レベル"])return e.get_dapai(!0);if(1==t["喰い替え許可レベル"]&&e._zimo&&e._zimo.length>2){let t=e._zimo[0]+(+e._zimo.match(/\d(?=[\+\=\-])/)||5);return e.get_dapai(!1).filter((e=>e.replace(/0/,"5")!=t))}return e.get_dapai(!1)}static get_chi_mianzi(t,e,i,n){let s=e.get_chi_mianzi(i,0==t["喰い替え許可レベル"]);return s?(1==t["喰い替え許可レベル"]&&3==e._fulou.length&&2==e._bingpai[i[0]][i[1]]&&(s=[]),0==n?[]:s):s}static get_peng_mianzi(t,e,i,n){let s=e.get_peng_mianzi(i);return s&&0==n?[]:s}static get_gang_mianzi(t,e,i,s,a){let o=e.get_gang_mianzi(i);if(!o||0==o.length)return o;if(e.lizhi){if(0==t["リーチ後暗槓許可レベル"])return[];if(1==t["リーチ後暗槓許可レベル"]){let t,i=0,s=0;t=e.clone().dapai(e._zimo);for(let e of n.Util.tingpai(t))i+=n.Util.hule_mianzi(t,e).length;t=e.clone().gang(o[0]);for(let e of n.Util.tingpai(t))s+=n.Util.hule_mianzi(t,e).length;if(i>s)return[]}else{let t;t=e.clone().dapai(e._zimo);let i=n.Util.tingpai(t).length;if(t=e.clone().gang(o[0]),n.Util.xiangting(t)>0)return[];if(i>n.Util.tingpai(t).length)return[]}}return 0==s||4==a?[]:o}static allow_lizhi(e,i,s,a,o){if(!i._zimo)return!1;if(i.lizhi)return!1;if(!i.menqian)return!1;if(!e["ツモ番なしリーチあり"]&&a<4)return!1;if(e["トビ終了あり"]&&o<1e3)return!1;if(n.Util.xiangting(i)>0)return!1;if(s){let t=i.clone().dapai(s);return 0==n.Util.xiangting(t)&&n.Util.tingpai(t).length>0}{let s=[];for(let a of t.get_dapai(e,i)){let t=i.clone().dapai(a);0==n.Util.xiangting(t)&&n.Util.tingpai(t).length>0&&s.push(a)}return!!s.length&&s}}static allow_hule(t,e,i,s,a,o,r){if(i&&!r)return!1;let l=e.clone();if(i&&l.zimo(i),-1!=n.Util.xiangting(l))return!1;if(o)return!0;let h={rule:t,zhuangfeng:s,menfeng:a,hupai:{},baopai:[],jicun:{changbang:0,lizhibang:0}};return null!=n.Util.hule(e,i,h).hupai}static allow_pingju(t,e,i){if(!i||!e._zimo)return!1;if(!t["途中流局あり"])return!1;let n=0;for(let t of["m","p","s","z"]){let i=e._bingpai[t],s="z"==t?[1,2,3,4,5,6,7]:[1,9];for(let t of s)i[t]>0&&n++}return n>=9}static allow_no_daopai(t,e,i){return!(i>0||e._zimo)&&(!!t["ノーテン宣言あり"]&&(!e.lizhi&&(0==n.Util.xiangting(e)&&n.Util.tingpai(e).length>0)))}}},5692:(t,e,i)=>{"use strict";const n={Shoupai:i(8496)};t.exports=class{constructor(){this._pai=[],this._find={}}dapai(t){if(!n.Shoupai.valid_pai(t))throw new Error(t);return this._pai.push(t.replace(/[\+\=\-]$/,"")),this._find[t[0]+(+t[1]||5)]=!0,this}fulou(t){if(!n.Shoupai.valid_mianzi(t))throw new Error(t);let e=t[0]+t.match(/\d(?=[\+\=\-])/),i=t.match(/[\+\=\-]/);if(!i)throw new Error(t);if(this._pai[this._pai.length-1].slice(0,2)!=e)throw new Error(t);return this._pai[this._pai.length-1]+=i,this}find(t){return this._find[t[0]+(+t[1]||5)]}}},1419:(t,e,i)=>{"use strict";const n={Shan:i(7551),rule:i(1041)};function s(t,e,i=1){if(i>9)return[[]];if(0==e[i])return s(t,e,i+1);let n=[];if(i<=7&&e[i]>0&&e[i+1]>0&&e[i+2]>0){e[i]--,e[i+1]--,e[i+2]--,n=s(t,e,i),e[i]++,e[i+1]++,e[i+2]++;for(let e of n)e.unshift(t+i+(i+1)+(i+2))}let a=[];if(3==e[i]){e[i]-=3,a=s(t,e,i+1),e[i]+=3;for(let e of a)e.unshift(t+i+i+i)}return n.concat(a)}function a(t){let e=[[]];for(let i of["m","p","s"]){let n=[];for(let a of e)for(let e of s(i,t._bingpai[i]))n.push(a.concat(e));e=n}let i=[];for(let e=1;e<=7;e++)if(0!=t._bingpai.z[e]){if(3!=t._bingpai.z[e])return[];i.push("z"+e+e+e)}let n=t._fulou.map((t=>t.replace(/0/g,"5")));return e.map((t=>t.concat(i).concat(n)))}function o(t,e){let[i,n,s]=e,a=new RegExp(`^(${i}.*${n})`),o=`$1${s}!`,r=[];for(let e=0;e<t.length;e++){if(t[e].match(/[\+\=\-]|\d{4}/))continue;if(e>0&&t[e]==t[e-1])continue;let i=t[e].replace(a,o);if(i==t[e])continue;let n=t.concat();n[e]=i,r.push(n)}return r}function r(t,e){let i=t.clone();if(e&&i.zimo(e),!i._zimo||i._zimo.length>2)return[];let n=(e||i._zimo+"_").replace(/0/,"5");return[].concat(function(t,e){let i=[];for(let n of["m","p","s","z"]){let s=t._bingpai[n];for(let r=1;r<s.length;r++){if(s[r]<2)continue;s[r]-=2;let l=n+r+r;for(let n of a(t))n.unshift(l),5==n.length&&(i=i.concat(o(n,e)));s[r]+=2}}return i}(i,n)).concat(function(t,e){if(t._fulou.length>0)return[];let i=[];for(let n of["m","p","s","z"]){let s=t._bingpai[n];for(let t=1;t<s.length;t++)if(0!=s[t]){if(2!=s[t])return[];{let s=n+t==e.slice(0,2)?n+t+t+e[2]+"!":n+t+t;i.push(s)}}}return 7==i.length?[i]:[]}(i,n)).concat(function(t,e){if(t._fulou.length>0)return[];let i=[],n=0;for(let s of["m","p","s","z"]){let a=t._bingpai[s],o="z"==s?[1,2,3,4,5,6,7]:[1,9];for(let t of o)if(2==a[t]){let a=s+t==e.slice(0,2)?s+t+t+e[2]+"!":s+t+t;i.unshift(a),n++}else{if(1!=a[t])return[];{let n=s+t==e.slice(0,2)?s+t+e[2]+"!":s+t;i.push(n)}}}return 1==n?[i]:[]}(i,n)).concat(function(t,e){if(t._fulou.length>0)return[];let i=e[0];if("z"==i)return[];let n=i,s=t._bingpai[i];for(let t=1;t<=9;t++){if(0==s[t])return[];if((1==t||9==t)&&s[t]<3)return[];let i=t==e[1]?s[t]-1:s[t];for(let e=0;e<i;e++)n+=t}return 14!=n.length?[]:(n+=e.slice(1)+"!",[[n]])}(i,n))}function l(t,e,i,n){const s=new RegExp(`^z${e+1}.*$`),a=new RegExp(`^z${i+1}.*$`),o=/^z[567].*$/,r=/^.*[z19].*$/,l=/^z.*$/,h=/^[mpsz](\d)\1\1.*$/,u=/^[mpsz](\d)\1\1(?:\1|_\!)?$/,p=/^[mpsz](\d)\1\1.*\1.*$/,c=/^[mpsz](\d)\1[\+\=\-\_]\!$/,f=/^[mps]\d\d[\+\=\-\_]\!\d$/,d=/^[mps](123[\+\=\-\_]\!|7[\+\=\-\_]\!89)$/;let g={fu:20,menqian:!0,zimo:!0,shunzi:{m:[0,0,0,0,0,0,0,0],p:[0,0,0,0,0,0,0,0],s:[0,0,0,0,0,0,0,0]},kezi:{m:[0,0,0,0,0,0,0,0,0,0],p:[0,0,0,0,0,0,0,0,0,0],s:[0,0,0,0,0,0,0,0,0,0],z:[0,0,0,0,0,0,0,0]},n_shunzi:0,n_kezi:0,n_ankezi:0,n_gangzi:0,n_yaojiu:0,n_zipai:0,danqi:!1,pinghu:!1,zhuangfeng:e,menfeng:i};for(let e of t)if(e.match(/[\+\=\-](?!\!)/)&&(g.menqian=!1),e.match(/[\+\=\-]\!/)&&(g.zimo=!1),1!=t.length&&(e.match(c)&&(g.danqi=!0),13!=t.length&&(e.match(r)&&g.n_yaojiu++,e.match(l)&&g.n_zipai++,5==t.length)))if(e==t[0]){let t=0;e.match(s)&&(t+=2),e.match(a)&&(t+=2),e.match(o)&&(t+=2),t=n["連風牌は2符"]&&t>2?2:t,g.fu+=t,g.danqi&&(g.fu+=2)}else if(e.match(h)){g.n_kezi++;let t=2;e.match(r)&&(t*=2),e.match(u)&&(t*=2,g.n_ankezi++),e.match(p)&&(t*=4,g.n_gangzi++),g.fu+=t,g.kezi[e[0]][e[1]]++}else g.n_shunzi++,e.match(f)&&(g.fu+=2),e.match(d)&&(g.fu+=2),g.shunzi[e[0]][e[1]]++;return 7==t.length?g.fu=25:5==t.length&&(g.pinghu=g.menqian&&20==g.fu,g.zimo?g.pinghu||(g.fu+=2):g.menqian?g.fu+=10:20==g.fu&&(g.fu=30),g.fu=10*Math.ceil(g.fu/10)),g}function h(t,e,i,n,s){let a=i.length>0&&"*"==i[0].fanshu[0]?i:[];a=a.concat(13!=t.length?[]:e.danqi?[{name:"国士無双十三面",fanshu:"**"}]:[{name:"国士無双",fanshu:"*"}]).concat(4!=e.n_ankezi?[]:e.danqi?[{name:"四暗刻単騎",fanshu:"**"}]:[{name:"四暗刻",fanshu:"*"}]).concat(function(){const i=e.kezi;if(i.z[5]+i.z[6]+i.z[7]==3){let e=t.filter((t=>t.match(/^z([567])\1\1(?:[\+\=\-]|\1)(?!\!)/))),i=e[2]&&e[2].match(/[\+\=\-]/);return i?[{name:"大三元",fanshu:"*",baojia:i[0]}]:[{name:"大三元",fanshu:"*"}]}return[]}()).concat(function(){const i=e.kezi;if(i.z[1]+i.z[2]+i.z[3]+i.z[4]==4){let e=t.filter((t=>t.match(/^z([1234])\1\1(?:[\+\=\-]|\1)(?!\!)/))),i=e[3]&&e[3].match(/[\+\=\-]/);return i?[{name:"大四喜",fanshu:"**",baojia:i[0]}]:[{name:"大四喜",fanshu:"**"}]}return i.z[1]+i.z[2]+i.z[3]+i.z[4]==3&&t[0].match(/^z[1234]/)?[{name:"小四喜",fanshu:"*"}]:[]}()).concat(e.n_zipai==t.length?[{name:"字一色",fanshu:"*"}]:[]).concat(t.filter((t=>t.match(/^[mp]/))).length>0||t.filter((t=>t.match(/^z[^6]/))).length>0||t.filter((t=>t.match(/^s.*[1579]/))).length>0?[]:[{name:"緑一色",fanshu:"*"}]).concat(5==e.n_yaojiu&&4==e.n_kezi&&0==e.n_zipai?[{name:"清老頭",fanshu:"*"}]:[]).concat(4==e.n_gangzi?[{name:"四槓子",fanshu:"*"}]:[]).concat(1!=t.length?[]:t[0].match(/^[mpsz]1112345678999/)?[{name:"純正九蓮宝燈",fanshu:"**"}]:[{name:"九蓮宝燈",fanshu:"*"}]);for(let t of a)s["ダブル役満あり"]||(t.fanshu="*"),s["役満パオあり"]||delete t.baojia;if(a.length>0)return a;let o=i.concat(e.menqian&&e.zimo?[{name:"門前清自摸和",fanshu:1}]:[]).concat(function(){let t=["東","南","西","北"],i=[];return e.kezi.z[e.zhuangfeng+1]&&i.push({name:"場風 "+t[e.zhuangfeng],fanshu:1}),e.kezi.z[e.menfeng+1]&&i.push({name:"自風 "+t[e.menfeng],fanshu:1}),e.kezi.z[5]&&i.push({name:"翻牌 白",fanshu:1}),e.kezi.z[6]&&i.push({name:"翻牌 發",fanshu:1}),e.kezi.z[7]&&i.push({name:"翻牌 中",fanshu:1}),i}()).concat(e.pinghu?[{name:"平和",fanshu:1}]:[]).concat(e.n_yaojiu>0?[]:s["クイタンあり"]||e.menqian?[{name:"断幺九",fanshu:1}]:[]).concat(function(){if(!e.menqian)return[];const t=e.shunzi;return 1==t.m.concat(t.p).concat(t.s).map((t=>t>>1)).reduce(((t,e)=>t+e))?[{name:"一盃口",fanshu:1}]:[]}()).concat(function(){const t=e.shunzi;for(let i=1;i<=7;i++)if(t.m[i]&&t.p[i]&&t.s[i])return[{name:"三色同順",fanshu:e.menqian?2:1}];return[]}()).concat(function(){const t=e.shunzi;for(let i of["m","p","s"])if(t[i][1]&&t[i][4]&&t[i][7])return[{name:"一気通貫",fanshu:e.menqian?2:1}];return[]}()).concat(5==e.n_yaojiu&&e.n_shunzi>0&&e.n_zipai>0?[{name:"混全帯幺九",fanshu:e.menqian?2:1}]:[]).concat(7==t.length?[{name:"七対子",fanshu:2}]:[]).concat(4==e.n_kezi?[{name:"対々和",fanshu:2}]:[]).concat(3==e.n_ankezi?[{name:"三暗刻",fanshu:2}]:[]).concat(3==e.n_gangzi?[{name:"三槓子",fanshu:2}]:[]).concat(function(){const t=e.kezi;for(let e=1;e<=9;e++)if(t.m[e]&&t.p[e]&&t.s[e])return[{name:"三色同刻",fanshu:2}];return[]}()).concat(e.n_yaojiu==t.length&&0==e.n_shunzi&&e.n_zipai>0?[{name:"混老頭",fanshu:2}]:[]).concat(function(){const i=e.kezi;return i.z[5]+i.z[6]+i.z[7]==2&&t[0].match(/^z[567]/)?[{name:"小三元",fanshu:2}]:[]}()).concat(function(){for(let i of["m","p","s"]){const n=new RegExp(`^[z${i}]`);if(t.filter((t=>t.match(n))).length==t.length&&e.n_zipai>0)return[{name:"混一色",fanshu:e.menqian?3:2}]}return[]}()).concat(5==e.n_yaojiu&&e.n_shunzi>0&&0==e.n_zipai?[{name:"純全帯幺九",fanshu:e.menqian?3:2}]:[]).concat(function(){if(!e.menqian)return[];const t=e.shunzi;return 2==t.m.concat(t.p).concat(t.s).map((t=>t>>1)).reduce(((t,e)=>t+e))?[{name:"二盃口",fanshu:3}]:[]}()).concat(function(){for(let i of["m","p","s"]){const n=new RegExp(`^[${i}]`);if(t.filter((t=>t.match(n))).length==t.length)return[{name:"清一色",fanshu:e.menqian?6:5}]}return[]}());return o.length>0&&(o=o.concat(n)),o}function u(t,e,i,n){if(0==e.length)return{defen:0};let s,a,o,r,l,h,u,p,c=n.menfeng;if("*"==e[0].fanshu[0]){t=void 0,a=n.rule["役満の複合あり"]?e.map((t=>t.fanshu.length)).reduce(((t,e)=>t+e)):1,r=8e3*a;let i=e.find((t=>t.baojia));i&&(p=(c+{"+":1,"=":2,"-":3}[i.baojia])%4,u=8e3*Math.min(i.fanshu.length,a))}else s=e.map((t=>t.fanshu)).reduce(((t,e)=>t+e)),r=s>=13&&n.rule["数え役満あり"]?8e3:s>=11?6e3:s>=8?4e3:s>=6?3e3:n.rule["切り上げ満貫あり"]&&t<<2+s==1920?2e3:Math.min(t<<2+s,2e3);let f=[0,0,0,0],d=n.jicun.changbang,g=n.jicun.lizhibang;if(null!=p?(i&&(u/=2),r-=u,h=u*(0==c?6:4),f[c]+=h,f[p]-=h):h=0,i||0==r)l=0==r?p:(c+{"+":1,"=":2,"-":3}[i[2]])%4,o=100*Math.ceil(r*(0==c?6:4)/100),f[c]+=o+300*d+1e3*g,f[l]-=o+300*d;else{let t=100*Math.ceil(2*r/100),e=100*Math.ceil(r/100);if(0==c){o=3*t;for(let e=0;e<4;e++)e==c?f[e]+=o+300*d+1e3*g:f[e]-=t+100*d}else{o=t+2*e;for(let i=0;i<4;i++)i==c?f[i]+=o+300*d+1e3*g:f[i]-=0==i?t+100*d:e+100*d}}return{hupai:e,fu:t,fanshu:s,damanguan:a,defen:o+h,fenpei:f}}t.exports={hule:function(t,e,i){if(e){if(!e.match(/[\+\=\-]$/))throw new Error(e);e=e.slice(0,2)+e.slice(-1)}let s,a=function(t){let e=[];return 1==t.lizhi&&e.push({name:"立直",fanshu:1}),2==t.lizhi&&e.push({name:"ダブル立直",fanshu:2}),t.yifa&&e.push({name:"一発",fanshu:1}),1==t.haidi&&e.push({name:"海底摸月",fanshu:1}),2==t.haidi&&e.push({name:"河底撈魚",fanshu:1}),t.lingshang&&e.push({name:"嶺上開花",fanshu:1}),t.qianggang&&e.push({name:"槍槓",fanshu:1}),1==t.tianhu&&(e=[{name:"天和",fanshu:"*"}]),2==t.tianhu&&(e=[{name:"地和",fanshu:"*"}]),e}(i.hupai),o=function(t,e,i,s){let a=t.clone();e&&a.zimo(e);let o=a.toString(),r=[],l=o.match(/[mpsz][^mpsz,]*/g),h=0;for(let t of i){t=n.Shan.zhenbaopai(t);const e=new RegExp(t[1],"g");for(let i of l){if(i[0]!=t[0])continue;i=i.replace(/0/,"5");let n=i.match(e);n&&(h+=n.length)}}h&&r.push({name:"ドラ",fanshu:h});let u=0,p=o.match(/0/g);p&&(u=p.length),u&&r.push({name:"赤ドラ",fanshu:u});let c=0;for(let t of s||[]){t=n.Shan.zhenbaopai(t);const e=new RegExp(t[1],"g");for(let i of l){if(i[0]!=t[0])continue;i=i.replace(/0/,"5");let n=i.match(e);n&&(c+=n.length)}}return c&&r.push({name:"裏ドラ",fanshu:c}),r}(t,e,i.baopai,i.fubaopai);for(let n of r(t,e)){let t=l(n,i.zhuangfeng,i.menfeng,i.rule),r=h(n,t,a,o,i.rule),p=u(t.fu,r,e,i);(!s||p.defen>s.defen||p.defen==s.defen&&(!p.fanshu||p.fanshu>s.fanshu||p.fanshu==s.fanshu&&p.fu>s.fu))&&(s=p)}return s},hule_param:function(t={}){return{rule:t.rule??n.rule(),zhuangfeng:t.zhuangfeng??0,menfeng:t.menfeng??1,hupai:{lizhi:t.lizhi??0,yifa:t.yifa??!1,qianggang:t.qianggang??!1,lingshang:t.lingshang??!1,haidi:t.haidi??0,tianhu:t.tianhu??0},baopai:t.baopai?[].concat(t.baopai):[],fubaopai:t.fubaopai?[].concat(t.fubaopai):null,jicun:{changbang:t.changbang??0,lizhibang:t.lizhibang??0}}},hule_mianzi:r}},8739:(t,e,i)=>{"use strict";
/*!
 *  @kobalab/majiang-core v1.3.1
 *
 *  Copyright(C) 2021 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/majiang-core/blob/master/LICENSE
 */t.exports={rule:i(1041),Shoupai:i(8496),Shan:i(7551),He:i(5692),Board:i(1015),Game:i(9101),Player:i(2118),Util:Object.assign(i(5598),i(1419))}},2118:(t,e,i)=>{"use strict";const n={Shoupai:i(8496),He:i(5692),Game:i(9101),Board:i(1015),Util:Object.assign(i(5598),i(1419))};t.exports=class{constructor(){this._model=new n.Board}action(t,e){this._callback=e,t.kaiju?this.kaiju(t.kaiju):t.qipai?this.qipai(t.qipai):t.zimo?this.zimo(t.zimo):t.dapai?this.dapai(t.dapai):t.fulou?this.fulou(t.fulou):t.gang?this.gang(t.gang):t.gangzimo?this.zimo(t.gangzimo,!0):t.kaigang?this.kaigang(t.kaigang):t.hule?this.hule(t.hule):t.pingju?this.pingju(t.pingju):t.jieju&&this.jieju(t.jieju)}get shoupai(){return this._model.shoupai[this._menfeng]}get he(){return this._model.he[this._menfeng]}get shan(){return this._model.shan}get hulepai(){return 0==n.Util.xiangting(this.shoupai)&&n.Util.tingpai(this.shoupai)||[]}get model(){return this._model}set view(t){this._view=t}kaiju(t){this._id=t.id,this._rule=t.rule,this._model.kaiju(t),this._view&&this._view.kaiju(t.id),this._callback&&this.action_kaiju(t)}qipai(t){this._model.qipai(t),this._menfeng=this._model.menfeng(this._id),this._diyizimo=!0,this._n_gang=0,this._neng_rong=!0,this._view&&this._view.redraw(),this._callback&&this.action_qipai(t)}zimo(t,e){this._model.zimo(t),e&&this._n_gang++,this._view&&(e?this._view.update({gangzimo:t}):this._view.update({zimo:t})),this._callback&&this.action_zimo(t,e)}dapai(t){if(t.l==this._menfeng&&(this.shoupai.lizhi||(this._neng_rong=!0)),this._model.dapai(t),this._view&&this._view.update({dapai:t}),this._callback&&this.action_dapai(t),t.l==this._menfeng)this._diyizimo=!1,this.hulepai.find((t=>this.he.find(t)))&&(this._neng_rong=!1);else{let e=t.p[0],i=+t.p[1]||5;this.hulepai.find((t=>t==e+i))&&(this._neng_rong=!1)}}fulou(t){this._model.fulou(t),this._view&&this._view.update({fulou:t}),this._callback&&this.action_fulou(t),this._diyizimo=!1}gang(t){if(this._model.gang(t),this._view&&this._view.update({gang:t}),this._callback&&this.action_gang(t),this._diyizimo=!1,t.l!=this._menfeng&&!t.m.match(/^[mpsz]\d{4}$/)){let e=t.m[0],i=+t.m.slice(-1)||5;this.hulepai.find((t=>t==e+i))&&(this._neng_rong=!1)}}kaigang(t){this._model.kaigang(t),this._view&&this._view.update({kaigang:t})}hule(t){this._model.hule(t),this._view&&this._view.update({hule:t}),this._callback&&this.action_hule(t)}pingju(t){this._model.pingju(t),this._view&&this._view.update({pingju:t}),this._callback&&this.action_pingju(t)}jieju(t){this._model.jieju(t),this._paipu=t,this._view&&this._view.summary(t),this._callback&&this.action_jieju(t)}get_dapai(t){return n.Game.get_dapai(this._rule,t)}get_chi_mianzi(t,e){return n.Game.get_chi_mianzi(this._rule,t,e,this.shan.paishu)}get_peng_mianzi(t,e){return n.Game.get_peng_mianzi(this._rule,t,e,this.shan.paishu)}get_gang_mianzi(t,e){return n.Game.get_gang_mianzi(this._rule,t,e,this.shan.paishu,this._n_gang)}allow_lizhi(t,e){return n.Game.allow_lizhi(this._rule,t,e,this.shan.paishu,this._model.defen[this._id])}allow_hule(t,e,i){return i=i||t.lizhi||0==this.shan.paishu,n.Game.allow_hule(this._rule,t,e,this._model.zhuangfeng,this._menfeng,i,this._neng_rong)}allow_pingju(t){return n.Game.allow_pingju(this._rule,t,this._diyizimo)}allow_no_daopai(t){return n.Game.allow_no_daopai(this._rule,t,this.shan.paishu)}}},1041:t=>{"use strict";t.exports=function(t={}){let e={配給原点:25e3,順位点:["20.0","10.0","-10.0","-20.0"],連風牌は2符:!1,赤牌:{m:1,p:1,s:1},クイタンあり:!0,喰い替え許可レベル:0,場数:2,途中流局あり:!0,流し満貫あり:!0,ノーテン宣言あり:!1,ノーテン罰あり:!0,最大同時和了数:2,連荘方式:2,トビ終了あり:!0,オーラス止めあり:!0,延長戦方式:1,一発あり:!0,裏ドラあり:!0,カンドラあり:!0,カン裏あり:!0,カンドラ後乗せ:!0,ツモ番なしリーチあり:!1,リーチ後暗槓許可レベル:2,役満の複合あり:!0,ダブル役満あり:!0,数え役満あり:!0,役満パオあり:!0,切り上げ満貫あり:!1};for(let i of Object.keys(t))e[i]=t[i];return e}},7551:(t,e,i)=>{"use strict";const n={Shoupai:i(8496)};t.exports=class{static zhenbaopai(t){if(!n.Shoupai.valid_pai(t))throw new Error(t);let e=t[0],i=+t[1]||5;return"z"==e?i<5?e+(i%4+1):e+((i-4)%3+5):e+(i%9+1)}constructor(t){this._rule=t;let e=t["赤牌"],i=[];for(let t of["m","p","s","z"])for(let n=1;n<=("z"==t?7:9);n++)for(let s=0;s<4;s++)5==n&&s<e[t]?i.push(t+0):i.push(t+n);for(this._pai=[];i.length;)this._pai.push(i.splice(Math.random()*i.length,1)[0]);this._baopai=[this._pai[4]],this._fubaopai=t["裏ドラあり"]?[this._pai[9]]:null,this._weikaigang=!1,this._closed=!1}zimo(){if(this._closed)throw new Error(this);if(0==this.paishu)throw new Error(this);if(this._weikaigang)throw new Error(this);return this._pai.pop()}gangzimo(){if(this._closed)throw new Error(this);if(0==this.paishu)throw new Error(this);if(this._weikaigang)throw new Error(this);if(5==this._baopai.length)throw new Error(this);return this._weikaigang=this._rule["カンドラあり"],this._weikaigang||this._baopai.push(""),this._pai.shift()}kaigang(){if(this._closed)throw new Error(this);if(!this._weikaigang)throw new Error(this);return this._baopai.push(this._pai[4]),this._fubaopai&&this._rule["カン裏あり"]&&this._fubaopai.push(this._pai[9]),this._weikaigang=!1,this}close(){return this._closed=!0,this}get paishu(){return this._pai.length-14}get baopai(){return this._baopai.filter((t=>t))}get fubaopai(){return this._closed&&this._fubaopai?this._fubaopai.concat():null}}},8496:t=>{"use strict";t.exports=class t{static valid_pai(t){if(t.match(/^(?:[mps]\d|z[1-7])_?\*?[\+\=\-]?$/))return t}static valid_mianzi(t){if(t.match(/^z.*[089]/))return;let e=t.replace(/0/g,"5");if(e.match(/^[mpsz](\d)\1\1[\+\=\-]\1?$/))return t.replace(/([mps])05/,"$150");if(e.match(/^[mpsz](\d)\1\1\1[\+\=\-]?$/))return t[0]+t.match(/\d(?![\+\=\-])/g).sort().reverse().join("")+(t.match(/\d[\+\=\-]$/)||[""])[0];if(e.match(/^[mps]\d+\-\d*$/)){let i=t.match(/0/),n=e.match(/\d/g).sort();if(3!=n.length)return;if(+n[0]+1!=+n[1]||+n[1]+1!=+n[2])return;return e=e[0]+e.match(/\d[\+\=\-]?/g).sort().join(""),i?e.replace(/5/,"0"):e}}constructor(e=[]){this._bingpai={_:0,m:[0,0,0,0,0,0,0,0,0,0],p:[0,0,0,0,0,0,0,0,0,0],s:[0,0,0,0,0,0,0,0,0,0],z:[0,0,0,0,0,0,0,0]},this._fulou=[],this._zimo=null,this._lizhi=!1;for(let i of e){if("_"==i){this._bingpai._++;continue}if(!(i=t.valid_pai(i)))throw new Error(i);let e=i[0],n=+i[1];if(4==this._bingpai[e][n])throw new Error([this,i]);this._bingpai[e][n]++,"z"!=e&&0==n&&this._bingpai[e][5]++}}static fromString(e=""){let i=e.split(","),n=i.shift(),s=n.match(/_/g)||[];for(let t of n.match(/[mpsz]\d+/g)||[]){let e=t[0];for(let i of t.match(/\d/g))"z"==e&&(i<1||7<i)||s.push(e+i)}s=s.slice(0,14-3*i.filter((t=>t)).length);let a=(s.length-2)%3==0&&s.slice(-1)[0];const o=new t(s);let r;for(let e of i){if(!e){o._zimo=r;break}e=t.valid_mianzi(e),e&&(o._fulou.push(e),r=e)}return o._zimo=o._zimo||a||null,o._lizhi="*"==n.slice(-1),o}toString(){let t="_".repeat(this._bingpai._+("_"==this._zimo?-1:0));for(let e of["m","p","s","z"]){let i=e,n=this._bingpai[e],s="z"==e?0:n[0];for(let t=1;t<n.length;t++){let a=n[t];this._zimo&&(e+t==this._zimo&&a--,5==t&&e+0==this._zimo&&(a--,s--));for(let e=0;e<a;e++)5==t&&s>0?(i+=0,s--):i+=t}i.length>1&&(t+=i)}this._zimo&&this._zimo.length<=2&&(t+=this._zimo),this._lizhi&&(t+="*");for(let e of this._fulou)t+=","+e;return this._zimo&&this._zimo.length>2&&(t+=","),t}clone(){const e=new t;return e._bingpai={_:this._bingpai._,m:this._bingpai.m.concat(),p:this._bingpai.p.concat(),s:this._bingpai.s.concat(),z:this._bingpai.z.concat()},e._fulou=this._fulou.concat(),e._zimo=this._zimo,e._lizhi=this._lizhi,e}fromString(e){const i=t.fromString(e);return this._bingpai={_:i._bingpai._,m:i._bingpai.m.concat(),p:i._bingpai.p.concat(),s:i._bingpai.s.concat(),z:i._bingpai.z.concat()},this._fulou=i._fulou.concat(),this._zimo=i._zimo,this._lizhi=i._lizhi,this}decrease(t,e){let i=this._bingpai[t];if(0==i[e]||5==e&&i[0]==i[5]){if(0==this._bingpai._)throw new Error([this,t+e]);this._bingpai._--}else i[e]--,0==e&&i[5]--}zimo(e,i=!0){if(i&&this._zimo)throw new Error([this,e]);if("_"==e)this._bingpai._++,this._zimo=e;else{if(!t.valid_pai(e))throw new Error(e);let i=e[0],n=+e[1],s=this._bingpai[i];if(4==s[n])throw new Error([this,e]);if(s[n]++,0==n){if(4==s[5])throw new Error([this,e]);s[5]++}this._zimo=i+n}return this}dapai(e,i=!0){if(i&&!this._zimo)throw new Error([this,e]);if(!t.valid_pai(e))throw new Error(e);let n=e[0],s=+e[1];return this.decrease(n,s),this._zimo=null,"*"==e.slice(-1)&&(this._lizhi=!0),this}fulou(e,i=!0){if(i&&this._zimo)throw new Error([this,e]);if(e!=t.valid_mianzi(e))throw new Error(e);if(e.match(/\d{4}$/))throw new Error([this,e]);if(e.match(/\d{3}[\+\=\-]\d$/))throw new Error([this,e]);let n=e[0];for(let t of e.match(/\d(?![\+\=\-])/g))this.decrease(n,t);return this._fulou.push(e),e.match(/\d{4}/)||(this._zimo=e),this}gang(e,i=!0){if(i&&!this._zimo)throw new Error([this,e]);if(i&&this._zimo.length>2)throw new Error([this,e]);if(e!=t.valid_mianzi(e))throw new Error(e);let n=e[0];if(e.match(/\d{4}$/)){for(let t of e.match(/\d/g))this.decrease(n,t);this._fulou.push(e)}else{if(!e.match(/\d{3}[\+\=\-]\d$/))throw new Error([this,e]);{let t=e.slice(0,5),i=this._fulou.findIndex((e=>t==e));if(i<0)throw new Error([this,e]);this._fulou[i]=e,this.decrease(n,e.slice(-1))}}return this._zimo=null,this}get menqian(){return 0==this._fulou.filter((t=>t.match(/[\+\=\-]/))).length}get lizhi(){return this._lizhi}get_dapai(t=!0){if(!this._zimo)return null;let e={};if(t&&this._zimo.length>2){let t=this._zimo,i=t[0],n=+t.match(/\d(?=[\+\=\-])/)||5;e[i+n]=!0,t.replace(/0/,"5").match(/^[mpsz](\d)\1\1/)||(n<7&&t.match(/^[mps]\d\-\d\d$/)&&(e[i+(n+3)]=!0),3<n&&t.match(/^[mps]\d\d\d\-$/)&&(e[i+(n-3)]=!0))}let i=[];if(!this._lizhi)for(let t of["m","p","s","z"]){let n=this._bingpai[t];for(let s=1;s<n.length;s++)0!=n[s]&&(e[t+s]||t+s==this._zimo&&1==n[s]||("z"==t||5!=s?i.push(t+s):((n[0]>0&&t+0!=this._zimo||n[0]>1)&&i.push(t+0),n[0]<n[5]&&i.push(t+s))))}return 2==this._zimo.length&&i.push(this._zimo+"_"),i}get_chi_mianzi(e,i=!0){if(this._zimo)return null;if(!t.valid_pai(e))throw new Error(e);let n=[],s=e[0],a=+e[1]||5,o=e.match(/[\+\=\-]$/);if(!o)throw new Error(e);if("z"==s||"-"!=o)return n;if(this._lizhi)return n;let r=this._bingpai[s];return 3<=a&&r[a-2]>0&&r[a-1]>0&&(!i||(3<a?r[a-3]:0)+r[a]<14-3*(this._fulou.length+1))&&(a-2==5&&r[0]>0&&n.push(s+"067-"),a-1==5&&r[0]>0&&n.push(s+"406-"),(a-2!=5&&a-1!=5||r[0]<r[5])&&n.push(s+(a-2)+(a-1)+(e[1]+o))),2<=a&&a<=8&&r[a-1]>0&&r[a+1]>0&&(!i||r[a]<14-3*(this._fulou.length+1))&&(a-1==5&&r[0]>0&&n.push(s+"06-7"),a+1==5&&r[0]>0&&n.push(s+"34-0"),(a-1!=5&&a+1!=5||r[0]<r[5])&&n.push(s+(a-1)+(e[1]+o)+(a+1))),a<=7&&r[a+1]>0&&r[a+2]>0&&(!i||r[a]+(a<7?r[a+3]:0)<14-3*(this._fulou.length+1))&&(a+1==5&&r[0]>0&&n.push(s+"4-06"),a+2==5&&r[0]>0&&n.push(s+"3-40"),(a+1!=5&&a+2!=5||r[0]<r[5])&&n.push(s+(e[1]+o)+(a+1)+(a+2))),n}get_peng_mianzi(e){if(this._zimo)return null;if(!t.valid_pai(e))throw new Error(e);let i=[],n=e[0],s=+e[1]||5,a=e.match(/[\+\=\-]$/);if(!a)throw new Error(e);if(this._lizhi)return i;let o=this._bingpai[n];return o[s]>=2&&(5==s&&o[0]>=2&&i.push(n+"00"+e[1]+a),5==s&&o[0]>=1&&o[5]-o[0]>=1&&i.push(n+"50"+e[1]+a),(5!=s||o[5]-o[0]>=2)&&i.push(n+s+s+e[1]+a)),i}get_gang_mianzi(e){let i=[];if(e){if(this._zimo)return null;if(!t.valid_pai(e))throw new Error(e);let n=e[0],s=+e[1]||5,a=e.match(/[\+\=\-]$/);if(!a)throw new Error(e);if(this._lizhi)return i;let o=this._bingpai[n];3==o[s]&&(i=5==s?[n+"5".repeat(3-o[0])+"0".repeat(o[0])+e[1]+a]:[n+s+s+s+s+a])}else{if(!this._zimo)return null;if(this._zimo.length>2)return null;let t=this._zimo.replace(/0/,"5");for(let e of["m","p","s","z"]){let n=this._bingpai[e];for(let s=1;s<n.length;s++)if(0!=n[s])if(4==n[s]){if(this._lizhi&&e+s!=t)continue;5==s?i.push(e+"5".repeat(4-n[0])+"0".repeat(n[0])):i.push(e+s+s+s+s)}else{if(this._lizhi)continue;for(let t of this._fulou)t.replace(/0/g,"5").slice(0,4)==e+s+s+s&&(5==s&&n[0]>0?i.push(t+0):i.push(t+s))}}}return i}}},5598:t=>{"use strict";function e(t,e,i,n){let s=n?4:5;return t>4&&(e+=t-4,t=4),t+e>4&&(i+=t+e-4,e=4-t),t+e+i>s&&(i=s-t-e),n&&e++,13-3*t-2*e-i}function i(t,e=1){if(e>9)return function(t){let e=0,i=0,n=0;for(let s=1;s<=9;s++)e+=t[s],s<=7&&0==t[s+1]&&0==t[s+2]&&(i+=e>>1,n+=e%2,e=0);return i+=e>>1,n+=e%2,{a:[0,i,n],b:[0,i,n]}}(t);let n=i(t,e+1);if(e<=7&&t[e]>0&&t[e+1]>0&&t[e+2]>0){t[e]--,t[e+1]--,t[e+2]--;let s=i(t,e);t[e]++,t[e+1]++,t[e+2]++,s.a[0]++,s.b[0]++,(s.a[2]<n.a[2]||s.a[2]==n.a[2]&&s.a[1]<n.a[1])&&(n.a=s.a),(s.b[0]>n.b[0]||s.b[0]==n.b[0]&&s.b[1]>n.b[1])&&(n.b=s.b)}if(t[e]>=3){t[e]-=3;let s=i(t,e);t[e]+=3,s.a[0]++,s.b[0]++,(s.a[2]<n.a[2]||s.a[2]==n.a[2]&&s.a[1]<n.a[1])&&(n.a=s.a),(s.b[0]>n.b[0]||s.b[0]==n.b[0]&&s.b[1]>n.b[1])&&(n.b=s.b)}return n}function n(t,n){let s=i(t._bingpai.m),a=i(t._bingpai.p),o=i(t._bingpai.s),r=[0,0,0];for(let e=1;e<=7;e++)t._bingpai.z[e]>=3?r[0]++:2==t._bingpai.z[e]?r[1]++:1==t._bingpai.z[e]&&r[2]++;let l=t._fulou.length,h=13;for(let t of[s.a,s.b])for(let i of[a.a,a.b])for(let s of[o.a,o.b]){let a=[l,0,0];for(let e=0;e<3;e++)a[e]+=t[e]+i[e]+s[e]+r[e];let o=e(a[0],a[1],a[2],n);o<h&&(h=o)}return h}function s(t){let e=n(t);for(let i of["m","p","s","z"]){let s=t._bingpai[i];for(let i=1;i<s.length;i++)if(s[i]>=2){s[i]-=2;let a=n(t,!0);s[i]+=2,a<e&&(e=a)}}return-1==e&&t._zimo&&t._zimo.length>2?0:e}function a(t){if(t._fulou.length)return 1/0;let e=0,i=0;for(let n of["m","p","s","z"]){let s=t._bingpai[n],a="z"==n?[1,2,3,4,5,6,7]:[1,9];for(let t of a)s[t]>=1&&e++,s[t]>=2&&i++}return i?12-e:13-e}function o(t){if(t._fulou.length)return 1/0;let e=0,i=0;for(let n of["m","p","s","z"]){let s=t._bingpai[n];for(let t=1;t<s.length;t++)s[t]>=2?e++:1==s[t]&&i++}return e>7&&(e=7),e+i>7&&(i=7-e),13-2*e-i}function r(t){return Math.min(s(t),a(t),o(t))}t.exports={xiangting_guoshi:a,xiangting_qidui:o,xiangting_yiban:s,xiangting:r,tingpai:function(t,e=r){if(t._zimo)return null;let i=[],n=e(t);for(let s of["m","p","s","z"]){let a=t._bingpai[s];for(let o=1;o<a.length;o++)a[o]>=4||(a[o]++,e(t)<n&&i.push(s+o),a[o]--)}return i}}},1166:(t,e,i)=>{"use strict";const n=i(5209),s=i(4761),{show:a,hide:o}=i(8521);t.exports=class extends n{constructor(t,e,i,n){super(),this._node={root:t,shoupai:$("> .shoupai",t),dapai:$("> .dapai",t),r_shoupai:$("> .shoupai .row",t).eq(0),r_dapai:$("> .dapai   .row",t).eq(0)},this._pai=i,this.close=n,this.action(e)}id(t){this.action({kaiju:{id:t,rule:this._rule,title:this._model.title,player:this._model.player,qijia:this._model.qijia}})}next(t){super.action(t)}action(t){super.action(t,(()=>{}))}action_kaiju(){this.clear()}action_qipai(){this.redraw_shoupai([]),this.active(!0)}action_zimo(t,e){if(t.l!=this._menfeng)return void this.redraw_shoupai([]);let i=[];if(this.select_hule(null,e,i))return this.redraw_shoupai(i),void this.active(!0);let n=this.select_gang(i);n&&i.forEach((t=>{t.m==n&&(t.selected=!0)}));let s=this.select_dapai(i).slice(0,2);n||i.forEach((t=>{t.m||t.p!=s||(t.selected=!0)})),this.redraw_dapai(i)}action_dapai(t){if(t.l==this._menfeng)return void this.update_dapai(t.p.slice(0,2));let e=[];if(this.select_hule(t,null,e))return this.redraw_shoupai(e),void this.active(!0);let i=this.select_fulou(t,e);i||(i=""),e.forEach((t=>{t.m==i&&(t.selected=!0)})),this.redraw_shoupai(e)}action_fulou(t){if(t.l!=this._menfeng)return void this.redraw_shoupai([]);if(t.m.match(/\d{4}/))return;let e=[],i=this.select_dapai(e).slice(0,2);e.forEach((t=>{t.p==i&&(t.selected=!0)})),this.redraw_dapai(e),this.active(!0)}action_gang(t){if(t.l==this._menfeng)return void this.update_dapai(t.m);let e=[];return this.select_hule(t,!0,e)?(this.redraw_shoupai(e),void this.active(!0)):void 0}action_hule(){this.clear()}action_pingju(){this.clear()}active(t){t?this._node.root.addClass("active"):this._node.root.removeClass("active")}clear(){this.active(!1),o(this._node.shoupai),o(this._node.dapai)}redraw_shoupai(t){if(a(this._node.shoupai.empty()),o(this._node.dapai),!t.length){let e=Majiang.Util.xiangting(this.shoupai),i=this._suanpai.paishu_all(),n=this.eval_shoupai(this.shoupai,i),s=Majiang.Util.tingpai(this.shoupai).map((t=>this._suanpai._paishu[t[0]][t[1]])).reduce(((t,e)=>t+e),0);t.push({m:"",n_xiangting:e,n_tingpai:s,ev:n,shoupai:this.shoupai.toString()})}const e=(t,e)=>t.selected?-1:e.selected?1:e.ev-t.ev;for(let i of t.sort(e)){let t=this._node.r_shoupai.clone();if($(".xiangting",t).text(i.n_xiangting<0?"和了形":0==i.n_xiangting?"聴牌":`${i.n_xiangting}向聴`),null==i.ev)$(".eval",t).text("");else if(i.n_xiangting>2){let e=i.ev-i.n_tingpai;$(".eval",t).text(e?`${i.n_tingpai}(+${e})枚`:`${i.n_tingpai}枚`)}else $(".eval",t).text(i.ev.toFixed(2));new s($(".shoupai",t),this._pai,Majiang.Shoupai.fromString(i.shoupai)).redraw(!0);let e=i.n_xiangting<0?"和了":i.m?i.m.match(/\d{4}/)?"カン":i.m.replace(/0/,"5").match(/(\d)\1\1/)?"ポン":"チー":"";$(".action",t).text(e),this._node.shoupai.append(t)}1==t.length?this.active(!1):this.active(!0)}redraw_dapai(t){o(this._node.shoupai),t.length?a(this._node.dapai.empty()):o(this._node.dapai);const e=(t,e)=>t.selected?-1:e.selected?1:e.ev-t.ev;for(let i of t.sort(e)){let t=this._node.r_dapai.clone().removeClass("selected").attr("data-dapai",i.m||i.p);if($(".p",t).empty().append(this._pai(i.p)),i.m&&$(".p",t).append($("<span>").text("カン")),$(".xiangting",t).text(i.n_xiangting?`${i.n_xiangting}向聴`:"聴牌"),null==i.ev)$(".eval",t).text("オリ");else if(i.n_xiangting>2){let e=i.ev>i.n_tingpai?i.ev-i.n_tingpai:0;$(".eval",t).text(e?`${i.n_tingpai}(+${e})枚`:`${i.n_tingpai}枚`)}else $(".eval",t).text(i.ev.toFixed(2));$(".tingpai",t).empty();for(let e of i.tingpai||[])$(".tingpai",t).append(this._pai(e));i.n_xiangting<=2&&null!=i.ev&&$(".tingpai",t).append($("<span>").text(`(${i.n_tingpai}枚)`));let e=null==i.weixian?"":i.weixian>=13.5?"high":i.weixian>=8?"middle":i.weixian>=3?"low":0==i.weixian?"none":"";$(".eval",t).removeClass("high middle low none").addClass(e),this._node.dapai.append(t)}this.shoupai.lizhi&&1==t.length?this.active(!1):this.active(!0)}update_dapai(t){$(`.row[data-dapai="${t}"]`,this._node.dapai).addClass("selected")}}},4180:(t,e,i)=>{"use strict";const n=i(4692);t.exports=function(t){const e={};return n("audio",t).each((function(){let t=n(this).data("name");e[t]=n(this)})),function(t){let i=e[t].clone()[0],n=e[t].attr("volume");return n&&(i.oncanplaythrough=()=>{i.volume=+n,i.oncanplaythrough=null}),i}}},8482:(t,e,i)=>{"use strict";const n=i(4692),s=i(4761),a=i(5644),o=i(2819),r=i(2532),l=i(5910),{hide:h,show:u,fadeIn:p,fadeOut:c}=i(8521),f=["main","xiajia","duimian","shangjia"],d=["東","南","西","北"],g=["一","二","三","四"],_={chi:"チー",peng:"ポン",gang:"カン",lizhi:"リーチ",rong:"ロン",zimo:"ツモ"};class m{constructor(t,e){this._model=e,this._view={root:t,jushu:n(".jushu",t),changbang:n(".changbang",t),lizhibang:n(".lizhibang",t),defen:[]},this._viewpoint=0,h(this._view.root)}redraw(t){null!=t&&(this._viewpoint=t),u(this._view.root);let e=d[this._model.zhuangfeng]+g[this._model.jushu]+"局";this._view.jushu.text(e),this._view.changbang.text(this._model.changbang),this._view.lizhibang.text(this._model.lizhibang);for(let t=0;t<4;t++){let e=this._model.player_id[t],i=""+this._model.defen[e];i=i.replace(/(\d)(\d{3})$/,"$1,$2"),i=`${d[t]}: ${i}`;let s=f[(e+4-this._viewpoint)%4];this._view.defen[t]=n(`.defen .${s}`,this._root),this._view.defen[t].removeClass("lunban").text(i),t==this._model.lunban&&this._view.defen[t].addClass("lunban")}return this}update(){let t=this._model.lunban<0?0:this._model.lunban;for(let e=0;e<4;e++)e==t?this._view.defen[e].addClass("lunban"):this._view.defen[e].removeClass("lunban");return this}}t.exports=class{constructor(t,e,i,s){this._root=t,this._model=s,this._pai=e,this._view={score:new m(n(".score",t),s),shan:null,shoupai:[],he:[],say:[],dialog:null,summary:h(n("> .summary",t)),kaiju:h(n("> .kaiju",t))},this._say=[],this._lizhi=!1,this.viewpoint=0,this.sound_on=!0,this.open_shoupai,this.open_he,this.no_player_name,this._timeout_id,this.set_audio(i),n("> .player",this._root).removeClass("disconnect"),n(window).on("resize",(()=>this._view.shoupai.forEach((t=>t.adjust()))))}set_audio(t){this._audio={};for(let e of["dapai","chi","peng","gang","rong","zimo","lizhi"]){this._audio[e]=[];for(let i=0;i<4;i++)this._audio[e][i]=t(e)}return this._audio.gong=t("gong"),this}redraw(){this._timeout_id=clearTimeout(this._timeout_id),h(this._view.summary),h(this._view.kaiju),this._view.score.redraw(this.viewpoint),this._view.shan=new a(n(".score .shan",this._root),this._pai,this._model.shan).redraw();for(let t=0;t<4;t++){let e=this._model.player_id[t],i=f[(e+4-this.viewpoint)%4];u(n(`> .player.${i}`,this._root).text(this._model.player[e].replace(/\n.*$/,""))),this.no_player_name&&h(n(`> .player.${i}`,this._root));let a=this._model.player_id[t]==this.viewpoint;this._view.shoupai[t]=new s(u(n(`.shoupai.${i}`,this._root)),this._pai,this._model.shoupai[t]).redraw(a||this.open_shoupai).adjust(),this._view.he[t]=new o(u(n(`.he.${i}`,this._root)),this._pai,this._model.he[t]).redraw(this.open_he),this._view.say[t]=h(n(`.say.${i}`,this._root).text("")),this._say[t]=null}return this._lunban=this._model.lunban,this._view.score.update(),this._view.dialog=new r(n(".hule-dialog",this._root),this._pai,this._model,this.viewpoint).hide(),this}update(t={}){return this._lunban>=0&&this._lunban!=this._model.lunban&&(this._say[this._lunban]?(c(this._view.say[this._lunban]),this._say[this._lunban]=null):h(this._view.say[this._lunban].text("")),this._lizhi&&(this._view.score.redraw(),this._lizhi=!1),this._view.he[this._lunban].redraw(),this._view.shoupai[this._lunban].redraw()),("lizhi"==this._say[this._lunban]||"chi"==this._say[this._lunban]&&!t.fulou||"peng"==this._say[this._lunban]&&!t.fulou||"gang"==this._say[this._lunban]&&!(t.fulou||t.gang||t.kaigang))&&(c(this._view.say[this._lunban]),this._say[this._lunban]=null),t.zimo?(this._view.shan.update(),this._view.shoupai[t.zimo.l].redraw().adjust()):t.dapai?(this._view.shoupai[t.dapai.l].dapai(t.dapai.p),this.sound_on&&(this._audio.dapai[t.dapai.l].currentTime=0,this._audio.dapai[t.dapai.l].play()),this._view.he[t.dapai.l].dapai(t.dapai.p),this._lizhi="*"==t.dapai.p.slice(-1)):t.fulou?this._view.shoupai[t.fulou.l].redraw().adjust():t.gang?this._view.shoupai[t.gang.l].redraw().adjust():t.gangzimo?(this._view.shan.update(),this._view.shoupai[t.gangzimo.l].redraw().adjust()):t.kaigang?this._view.shan.redraw():t.hule?this.hule(t.hule):t.pingju?this.pingju(t.pingju):this._view.score.redraw(),this._lunban=this._model.lunban,this._lunban>=0&&this._view.score.update(),this}hule(t){for(let t=0;t<4;t++)c(this._view.say[t]),this._say[t]=null;this._timeout_id=setTimeout((()=>{this._view.shoupai[t.l].redraw(!0),this._view.dialog.hule(t),this.sound_on&&t.damanguan&&this._audio.gong.play()}),400)}pingju(t){for(let t=0;t<4;t++)c(this._view.say[t]),this._say[t]=null;let e=0;t.name.match(/^三家和/)?e=400:(this._view.he[this._lunban].redraw(),this._view.shoupai[this._lunban].redraw()),this._timeout_id=setTimeout((()=>{for(let e=0;e<4;e++){let i=this._model.player_id[e]==this.viewpoint||t.shoupai[e];this._view.shoupai[e].redraw(i)}this._view.dialog.pingju(t)}),e)}say(t,e){this.sound_on&&(this._audio[t][e].currentTime=0,this._audio[t][e].play()),u(this._view.say[e].text(_[t])),this._say[e]=t}kaiju(t){if(null!=t&&(this.viewpoint=t),this.no_player_name)return;h(n("> *",this._root));let e=n("<span>").text(this._model.title).html().replace(/\n/g,"<br>");n(".title",this._view.kaiju).html(e);for(let t=0;t<4;t++){let e=f[(4-this.viewpoint+t)%4],i=this._model.player[t].replace(/\n.*$/,"");n(`.player .${e}`,this._view.kaiju).text(i)}u(this._view.kaiju)}summary(t){this._timeout_id=clearTimeout(this._timeout_id),this._view.dialog.hide(),this._view.summary.scrollTop(0),t?p(l(this._view.summary,t,this.viewpoint)):h(this._view.summary)}players(t){for(let e=0;e<4;e++){let i=f[(e+4-this.viewpoint)%4];t[e]?n(`> .player.${i}`,this._root).removeClass("disconnect"):n(`> .player.${i}`,this._root).addClass("disconnect")}}}},2532:(t,e,i)=>{"use strict";const n=i(4692),s=i(8739),a=i(4761),o=i(5644),{hide:r,show:l,fadeIn:h,fadeOut:u}=i(8521);t.exports=class{constructor(t,e,i,s=0){this._node={root:t,hule:n(".hule",t),pingju:n(".pingju",t),fenpei:n(".fenpai",t)},this._r_hupai=n(".r_hupai",t).eq(0),this._r_defen=n(".r_defen",t).eq(0),this.hide(),this._pai=e,this._model=i,this._viewpoint=s}hule(t){r(this._node.root),r(this._node.pingju),l(this._node.hule),t.fubaopai?l(n(".shan.fubaopai",this._node.hule)):r(n(".shan.fubaopai",this._node.hule)),new o(n(".shan",this._node.hule),this._pai,this._model.shan).redraw(),new a(n(".shoupai",this._node.hule),this._pai,s.Shoupai.fromString(t.shoupai)).redraw(!0);let e=n(".hupai",this._node.hule).empty();if(t.hupai){for(let i of t.hupai){let t=this._r_hupai.clone();n(".name",t).text(i.name),n(".fanshu",t).text(i.fanshu+("*"==i.fanshu[0]?"":"翻")),e.append(l(t))}let i=t.damanguan?"":t.fu+"符 "+t.fanshu+"翻 ",s=t.defen/(0==t.l?6:4)/2e3;i+=s>=24?"六倍役満 ":s>=20?"五倍役満 ":s>=16?"四倍役満 ":s>=12?"トリプル役満 ":s>=8?"ダブル役満 ":s>=4?"役満 ":s>=3?"三倍満 ":s>=2?"倍満 ":s>=1.5?"跳満 ":s>=1?"満貫 ":"",i+=t.defen+"点";let a=this._r_defen.clone();n(".defen",a).text(i).removeClass("no_hule"),e.append(a)}else{let t=this._r_hupai.clone();e.append(r(t));let i=this._r_defen.clone();n(".defen",i).text("役なし").addClass("no_hule"),e.append(i)}return n(".jicun .changbang",this._node.hule).text(this._model.changbang),n(".jicun .lizhibang",this._node.hule).text(this._model.lizhibang),t.fenpei&&this.fenpei(t.fenpei),this._node.root.attr("aria-label","ホーラ情報"),h(this._node.root),this}pingju(t){return r(this._node.root),r(this._node.hule),l(this._node.pingju),this._node.pingju.text(t.name),t.fenpei&&this.fenpei(t.fenpei),this._node.root.attr("aria-label","流局情報"),h(this._node.root),this}fenpei(t){const e=["東","南","西","北"],i=["main","xiajia","duimian","shangjia"];n(".diff",this._node.fenpai).removeClass("plus minus");for(let s=0;s<4;s++){let a=this._model.player_id[s],o=i[(a+4-this._viewpoint)%4],r=n(`.${o}`,this._node.fenpai);n(".feng",r).text(e[s]);let l=this._model.player[a].replace(/\n.*$/,"");n(".player",r).text(l);let h=(""+this._model.defen[a]).replace(/(\d)(\d{3})$/,"$1,$2");n(".defen",r).text(h);let u=t[s];u>0?n(".diff",r).addClass("plus"):u<0&&n(".diff",r).addClass("minus"),u=u>0?"+"+u:u<0?""+u:"",u=u.replace(/(\d)(\d{3})$/,"$1,$2"),n(".diff",r).text(u)}}hide(){return this._node.root.scrollTop(0),r(this._node.root),this}}},6521:(t,e,i)=>{"use strict";const n=i(4692),s=i(8739),a=i(4761),{hide:o,show:r,fadeIn:l,fadeOut:h}=i(8521),u=i(1367);function p(t){let e=[];for(let i of t.match(/[mpsz]\d[\d\+\=\-]*/g)||[]){let t=i[0];for(let n of i.match(/\d/g))e.push(t+n)}return e}function c(t,e,i,n){let a=t.children().eq(0).empty().removeClass("error");t.empty();let o=0;for(let r of p(s.Shoupai.fromString(i).toString())){let i=a.clone().append(e(r));n(r)&&i.addClass("error"),t.append(i),o++}for(let i=0;i<13-o;i++){let i=a.clone().append(e("_"));t.append(i)}}function f(t,e){return function(i,a,o,r,l,h){const u=(e,i,s)=>"m"==s?n(".moda",n(".mo",t).eq(i)).eq(e):n(".moda",n(".da",t).eq(i)).eq(e);if(null==r)return n("input",u(i,a,o)).val();h&&u(i,a,o).addClass("error"),n("input",u(i,a,o)).val(r),"d"==o&&"_"==r[0]&&(n(".pai",u(i,a,"m")).text("↓"),r=n("input",u(i,a,"m")).val()+r,u(i,a,"m").hasClass("error")&&(u(i,a,"m").removeClass("error"),u(i,a,"d").addClass("error"))),s.Shoupai.valid_pai(r)||s.Shoupai.valid_mianzi(r)?(n(".pai",u(i,a,o)).append(e(r.replace(/^([mpsz])\d{3}[+\=\-](\d)$/,"$1$2").replace(/^([mpsz]).*(\d)[\+\=\-].*$/,"$1$2").replace(/^([mpsz]\d).*$/,"$1"))),n(".text",u(i,a,o)).text(l)):(u(i,a,o).addClass("error"),n(".pai",u(i,a,o)).text(r))}}function d(t){function e(t){let e=t.eq(0).children().eq(0).clone();return n(".flip >.pai",e).empty(),n(".flip >input",e).val(""),n(".text",e).text(""),e.removeClass("error"),e}const i=e(n(".paipu .mo",t)),s=e(n(".paipu .da",t));return function(e){for(let a=0;a<4;a++){let o=n(".paipu .mo",t).eq(a);for(;o.children().length<=e;){let t=i.clone();u(n(".flip",t).attr("tabindex",o.children().length+1)),o.append(t)}let r=n(".paipu .da",t).eq(a);for(;r.children().length<=e;){let t=s.clone();u(n(".flip",t).attr("tabindex",r.children().length+1)),r.append(t)}}}}function g(t){return function(e){try{e.qipai?t.qipai(e.qipai):e.zimo?t.zimo(e.zimo):e.dapai?t.dapai(e.dapai):e.fulou?t.fulou(e.fulou):e.gang?t.gang(e.gang):e.gangzimo?t.zimo(e.gangzimo):e.kaigang?t.kaigang(e.kaigang):e.hule?t.hule(e.hule):e.pingju&&t.pingju(e.pingju)}catch(t){return t}}}function _(t,e,i){if(!i)return{zhuangfeng:0,jushu:0,changbang:0,lizhibang:0,defen:[0,0,0,0].map((t=>e["配給原点"])),baopai:"",shoupai:["","","",""]};let n=new s.Board(t);const a=g(n);let o;for(let t of i)a(t),t.hule?e["連荘方式"]>0&&0==t.hule.l&&(o=!0):t.pingju&&(n.shan.paishu>0||2==e["連荘方式"]&&0==s.Util.xiangting(n.shoupai[0])&&s.Util.tingpai(n.shoupai[0]).length||3==e["連荘方式"])&&(o=!0);n.last();let r=4*n.zhuangfeng+n.jushu;o||r++,0==e["連荘方式"]&&(n.changbang=0);let l=n.defen.concat();return{zhuangfeng:r>>2,jushu:r%4,changbang:n.changbang,lizhibang:n.lizhibang,defen:l.splice((t.qijia+r)%4).concat(l),baopai:"",shoupai:["","","",""]}}function m(t){let e=t._changbang,i=t._lizhibang,n=100*Math.floor(t.defen/2/100);for(let s=0;s<4;s++)null==t.baojia?t.fenpei[s]=t.l==s?t.defen+100*e*3+1e3*i:0==t.l?-(t.defen/3+100*e):0==s?-(n+100*e):-((t.defen-n)/2+100*e):t.fenpei[s]=t.l==s?t.defen+100*e*3+1e3*i:t.baojia==s?-(t.defen+100*e*3):0;return t}function v(t){t.fenpei=[0,0,0,0];let e=t.shoupai.filter((t=>t)).length;if(0<e&&e<4)for(let i=0;i<4;i++)t.fenpei[i]=t.shoupai[i]?3e3/e:-3e3/(4-e);return t}function y(t,e){const i=t.log[t.log.length-1];let n=_(t,e,i),s=t.defen.concat();t.defen.length||(s=n.defen.concat(),s=s.splice((8-t.qijia-n.jushu)%4).concat(s));let a=[];for(let e=0;e<4;e++){let i=(t.qijia+e)%4;for(let t=0;t<4;t++)if(t==a.length||s[i]>s[a[t]]){a.splice(t,0,i);break}}let o=[0,0,0,0];for(let t=0;t<4;t++)o[a[t]]=t+1;if(!t.defen.length&&(s[a[0]]+=1e3*n.lizhibang,!i.find((t=>t.hule||t.pingju))))return{defen:[],rank:o,point:[]};const r=!e["順位点"].find((t=>t.match(/\.\d$/)));let l=[0,0,0,0];for(let t=1;t<4;t++){let i=a[t];l[i]=(s[i]-3e4)/1e3+ +e["順位点"][t],r&&(l[i]=Math.round(l[i])),l[a[0]]-=l[i]}return l=l.map((t=>t.toFixed(r?0:1))),{defen:s,rank:o,point:l}}t.exports=class{constructor(t,e,i,a,o,r,l){this._root=t,this._paipu=e,this._rule=i,this._pai=a,this._model=new s.Board(e),this.init_menu(o,r,l),e.log.length?this.select_log(0):(this.add_log(-1),this.select_log(-1)),n(window).off("beforeunload"),this._unsaved=!1}changed(){n(window).on("beforeunload",(t=>{const e="ページを離れますがよろしいですか？";return t.returnValue=e,e})),this._unsaved=!0}init_menu(t,e,i){const s=n(".menu",this._root);n(".title",s).text(this._paipu.title),n(".save",s).off("click").on("click",(()=>{-1==this._log_idx&&this.update_overview(),this._paipu.rank=y(this._paipu,this._rule).rank,e(),l(this._root),this._unsaved=!1,n(window).off("beforeunload")})),n(".replay",s).off("click").on("click",(()=>{i(this._paipu).preview(this._log_idx)})),n(".exit",s).off("click").on("click",(()=>{this._unsaved&&!window.confirm("未保存の修正がありますが、編集を終了しますか？")||(n(window).off("beforeunload"),t())}));const a=n(".score",this._root),o=n('select[name="game"]',a),r=o.children().eq(0);o.empty();for(let t=0;t<16;t++){let e=["東","南","西","北"][t>>2]+["一","二","三","四"][t%4]+"局",i=r.clone().text(e).attr("value",t);o.append(i)}u(n(".shan .flip",a))}select_log(t){this._log_idx=t,t>=0?(o(n(".overview",this._root)),this.init_paipu(),this.draw_logs(),this.draw_paipu(),n(".menu .score",this._root).css("visibility","visible"),r(n(".paipu",this._root))):(o(n(".paipu",this._root)),n(".menu .score",this._root).css("visibility","hidden"),this.draw_logs(),this.draw_overview(),r(n(".overview",this._root)))}add_log(t){let e=_(this._paipu,this._rule,this._paipu.log[t]);return this._paipu.log.splice(t+1,0,[{qipai:e}]),this.changed(),this.select_log(t+1),n('.score *[name="game"]',this._root).focus(),!1}delete_log(t){return this._paipu.log.splice(t,1),this.changed(),this.select_log(t-1),!1}update_score(){const t=this._paipu.log[this._log_idx][0].qipai,e=n(".score",this._root);let i=n('.paipu [name="defen"]').toArray().map((t=>+n(t).val())),s=t.jushu;t.zhuangfeng=n('[name="game"]',e).val()>>2,t.jushu=n('[name="game"]',e).val()%4,t.changbang=+n('[name="changbang"]',e).val(),t.lizhibang=+n('[name="lizhibang"]',e).val(),t.baopai=n("[name=baopai]",e).eq(0).val(),t.defen=i.splice(t.jushu-s).concat(i),this.draw_logs(),this.draw_paipu(),this.changed()}draw_logs(){const t=n(".menu .log",this._root),e=t.children().eq(0).removeClass("selected");t.empty(),t.append(e);for(let i=0;i<this._paipu.log.length;i++){let s=e.clone(),a=this._paipu.log[i][0].qipai;n(".name",s).text(["東","南","西","北"][a.zhuangfeng]+["一","二","三","四"][a.jushu]+"局 "+a.changbang+"本場"),s.on("click",(()=>this.select_log(i))),t.append(s),i==this._log_idx&&s.addClass("selected")}t.children().each(((t,e)=>{n(".plus",e).off("click").on("click",(()=>this.add_log(t-1)));let i=n(".name",e).text()+" を削除しますか？";t>0&&n(".minus",e).off("click").on("click",(()=>window.confirm(i)&&this.delete_log(t-1)))})),e.on("click",(()=>this.select_log(-1))),-1==this._log_idx&&e.addClass("selected")}draw_overview(){const t=n(".overview",this._root),e=this._paipu;let i;i=e.defen.length?e:y(e,this._rule),n('[name="title"]',t).val(e.title),n('[name="qijia"]',t).val([e.qijia]);for(let s=0;s<4;s++)n('[name="player"]',t).eq(s).val(e.player[s]),n('[name="defen"]',t).eq(s).val(i.defen[s]),n('[name="point"]',t).eq(s).val(i.point[s]);t.off("change").on("change",(()=>this.update_overview()))}update_overview(){const t=n(".overview",this._root),e=this._paipu;e.title=n('[name="title"]',t).val(),e.qijia=+n('[name="qijia"]:checked',t).val(),e.player=n('[name="player"]',t).toArray().map((t=>n(t).val())),e.defen=n('[name="defen"]',t).toArray().map((t=>n(t).val()&&+n(t).val())),e.point=n('[name="point"]',t).toArray().map((t=>n(t).val())),e.defen.filter((t=>""!=t)).length||(e.defen=[]),e.point.filter((t=>""!=t)).length||(e.point=[]),this.changed(),n(".menu .title",this._root).text(e.title)}init_paipu(){u(n(".paipu .qipai.flip",this._root).attr("tabindex",1));const t=d(this._root);n(".paipu .mo",this._root).empty(),n(".paipu .da",this._root).empty(),t(0)}draw_paipu(){const t=n(".score",this._root),e=n(".paipu",this._root),i=this._paipu.log[this._log_idx],l=f(e,this._pai),h=function(t,e){n(".pai",t).empty().append(e("_")),n('[name="baopai"]',t).val(""),t.children().attr("tabindex",-1).removeClass("error");let i=0;return function(a,o){if(t.children().eq(i).attr("tabindex",0),!a)return;let r=a.replace(/^>+/,"");s.Shoupai.valid_pai(r)?n(">.pai",t.children().eq(i)).empty().append(e(r)):(t.children().eq(i).addClass("error"),n(">.pai",t.children().eq(i)).empty().text(r)),o&&t.children().eq(i).addClass("error"),n('[name="baopai"]',t).eq(i).val(a),i++}}(n(".shan",t),this._pai),u=d(this._root),_=g(this._model);n(".moda",e).removeClass("error"),n("input",e).val(""),n(".pai",e).empty(),n(".text",e).text(""),n(".defen .fenpei",e).removeClass("plus minus").text(""),o(n(".result",e)),o(n(".result .button",e)),r(n(".result .text",e));const m=function(t){let e={m:[0,4,4,4,4,4,4,4,4,4],p:[0,4,4,4,4,4,4,4,4,4],s:[0,4,4,4,4,4,4,4,4,4],z:[0,4,4,4,4,4,4,4]},i=[],n={};function s(t){let i=t[0],s=+t[1]||5;e[i]&&(e[i][s]--,e[i][s]<0&&(n[t]=!0))}for(let e of t)if(e.qipai){for(let t=0;t<4;t++)for(let i of p(e.qipai.shoupai[t]))s(i);e.qipai.baopai&&s(e.qipai.baopai)}else e.zimo?s(e.zimo.p):e.gangzimo?s(e.gangzimo.p):e.kaigang?s(e.kaigang.baopai):e.hule&&e.hule.fubaopai&&(i=e.hule.fubaopai);return i.forEach((t=>s(t))),function(t){let e=t[0],i=+t[1]||5;return n[e+i]}}(i);let v,y=-1,b=0,w=[],x=[];for(let a=0;a<i.length;a++){let o=i[a],p=_(o);if(o.qipai){n('[name="game"]',t).val(4*o.qipai.zhuangfeng+o.qipai.jushu),n('[name="changbang"]',t).val(o.qipai.changbang),n('[name="lizhibang"]',t).val(o.qipai.lizhibang),h(o.qipai.baopai,m(o.qipai.baopai));for(let t=0;t<4;t++){n(".player .jia",e).eq(t).text(["東","南","西","北"][t]);let i=(this._paipu.qijia+o.qipai.jushu+t)%4;n(".player .name",e).eq(t).text(this._paipu.player[i].replace(/\n.*$/,"")),n('[name="defen"]',e).eq(t).val(o.qipai.defen[t]),n('[name="qipai"]',e).eq(t).val(o.qipai.shoupai[t]),c(n(".qipai .shoupai",e).eq(t),this._pai,o.qipai.shoupai[t],m)}}else if(o.zimo){let t;o.zimo.l<=y&&b++,i[a+1]&&i[a+1].hule&&(t="ツモ"),y=o.zimo.l,v="m",p=p||m(o.zimo.p),l(b,y,v,o.zimo.p,t,p)}else if(o.dapai){(o.dapai.l<y||o.dapai.l==y&&"d"==v)&&b++;let t="";o.dapai.p.replace(/[\+\=\-]$/,"").match(/\*$/)&&(t="リーチ"),i[a+1]&&i[a+1].hule&&(t+="放銃"),y=o.dapai.l,v="d",l(b,y,v,"_"==o.dapai.p[2]?o.dapai.p.slice(2):o.dapai.p,t,p)}else if(o.fulou){let t;b++;let e=o.fulou.m.replace(/0/,"5");t=e.match(/(\d)\1\1\1/)?"カン":e.match(/(\d)\1\1/)?"ポン":"チー",y=o.fulou.l,v="m",l(b,y,v,o.fulou.m,t,p)}else if(o.gang){(o.gang.l<y||o.gang.l==y&&"d"==v)&&b++;let t="カン";i[a+1]&&i[a+1].hule&&(t+="放銃"),v="d",l(b,y,v,o.gang.m,t,p)}else if(o.gangzimo){let t;b++,i[a+1]&&i[a+1].hule&&(t="ツモ"),y=o.gangzimo.l,v="m",p=p||m(o.gangzimo.p),l(b,y,v,o.gangzimo.p,t,p)}else if(o.kaigang)h((w.shift()||"")+o.kaigang.baopai,m(o.kaigang.baopai));else if(o.hule){let t=o.hule;x[t.l]=s.Shoupai.fromString(t.shoupai);let i=(null!=t.baojia?"ロン: ":"ツモ: ")+(null!=t.baojia?t.defen:0==y?t.defen/3+" オール":100*Math.ceil(t.defen/200)/2+" / "+100*Math.floor(t.defen/200));n(".result .text",e).eq(t.l).text(i),r(n(".result",e).eq(t.l)),n(".defen .fenpei",e).eq(t.l).addClass("plus"),null!=t.baojia&&n(".defen .fenpei",e).eq(t.baojia).addClass("minus"),n(".result",e).eq(t.l).off("click").on("click",(()=>this.open_hule_dialog(this.make_hule(t.l))))}else if(o.pingju){let t=o.pingju,i="流局";t.name!=i&&(i+=`(${t.name})`),n(".result .text",e).eq(0).text(i),r(n(".result",e).eq(0)),n(".result",e).eq(0).off("click").on("click",(()=>this.open_pingju_dialog(t)))}o.kaigang||w.forEach(((t,e)=>w[e]+=">")),o.gangzimo&&w.push(""),u(b+1)}this._model.last();for(let t=0;t<4;t++){i[0].qipai.shoupai[t]?(n(">.shoupai",e).eq(t).css("visibility","visible"),new a(n(">.shoupai",e).eq(t),this._pai,x[t]||this._model.shoupai[t]).redraw(!0)):n(">.shoupai",e).eq(t).css("visibility","hidden");let s=this._model.player_id[t],o=this._model.defen[s]-i[0].qipai.defen[t];o>0&&(o="+"+o),0!=o&&n(".defen .fenpei",e).eq(t).text(o)}i.find((t=>t.hule||t.pingju))||(o(n(".result .text",e)),r(n(".result .button",e).eq(0)),r(n(".result",e).eq(0)),n(".result",e).off("click").on("click",(()=>this.open_dialog()))),t.off("change").on("change",(()=>this.update_score())),n("[name=baopai]",t).off("change").on("change",(()=>this.update_paipu())),n("input",e).off("change").on("change",(()=>this.update_paipu()))}update_paipu(){const t=n(".score",this._root),e=n(".paipu",this._root),i=f(e);let s=[],a=n('.score [name="baopai"]',this._root).toArray().map((t=>n(t).val())),o=[];const r=()=>{o[0]&&">"!=o[0][0]&&s.push({kaigang:{baopai:o.shift()}}),o.forEach(((t,e)=>o[e]=t.slice(1)))};let l={zhuangfeng:n('[name="game"]',t).val()>>2,jushu:n('[name="game"]',t).val()%4,changbang:+n('[name="changbang"]',t).val(),lizhibang:+n('[name="lizhibang"]',t).val(),defen:n('[name="defen"]',e).toArray().map((t=>+n(t).val())),baopai:a.shift(),shoupai:n('[name="qipai"]',e).toArray().map((t=>n(t).val()))};s.push({qipai:l});let h=!1,u=n(".mo .moda",e.eq(0)).length;for(let t=0;t<u;t++)for(let e=0;e<4;e++){let n=i(t,e,"m");n&&(n.match(/\d\d/)?(s.push({fulou:{l:e,m:n}}),n.match(/\d{3}.*\d/)&&(h=!0)):h?(s.push({gangzimo:{l:e,p:n}}),h=!1,o.push(a.shift())):s.push({zimo:{l:e,p:n}}),o.length&&r());let l=i(t,e,"d");if(l){if(l.match(/\d\d/))s.push({gang:{l:e,m:l}}),h=!0;else{let t="_"==l[0]?n+l:l;s.push({dapai:{l:e,p:t}})}o.length&&r()}}a.forEach((t=>t&&s.push({kaigang:{baopai:t}}))),this._paipu.log[this._log_idx].filter((t=>t.hule||t.pingju)).forEach((t=>s.push(t))),this._paipu.log[this._log_idx]=s,this.changed(),this.draw_paipu()}open_dialog(){let t=this.search_hule();t.defen?this.open_hule_dialog(t):this.open_pingju_dialog(this.make_pingju())}close_dialog(){n("dialog.hule",this._root).get(0).close(),n("dialog.pingju",this._root).get(0).close()}open_hule_dialog(t){t||(t=this.search_hule()),this.init_hule_dialog(),this.draw_hule_dialog(t),n("dialog.pingju",this._root).get(0).close(),n("dialog.hule",this._root).get(0).showModal()}search_hule(){const t=this._model;if(t.lunban>=0)for(let e=0;e<4;e++){let i=(t.lunban+e)%4,n=this.make_hule(i);if(n.defen)return n}return{fubaopai:[],hupai:[],fenpei:[]}}make_hule(t,e){const i=this._paipu.log[this._log_idx],n=this._model;let a={rule:this._rule,zhuangfeng:n.zhuangfeng,menfeng:t,baopai:n.shan.baopai,fubaopai:e||n.shan.fubaopai},o=function(t,e,i){let s,a,o,r;for(let n of e){if(n.qipai)i.changbang=n.qipai.changbang,i.lizhibang=n.qipai.lizhibang,a=!0;else if(n.dapai)"*"==n.dapai.p.slice(-1)?(n.dapai.l==t&&(i.lizhi=a?2:1,r=!0),o=!0):n.dapai.l==t&&(r=!1);else{if(n.kaigang)continue;if(n.hule){if(n.hule.l==t)return n;i.changbang=0,i.lizhibang=0;break}if(n.pingju)break}s=n,(s.dapai&&3==s.dapai.l||s.fulou||s.gang)&&(a=!1),(s.fulou||s.gangzimo)&&(r=!1),o&&(s.zimo||s.fulou)&&(i.lizhibang++,o=!1)}return r&&(i.yifa=!0),s.zimo&&a&&(i.tianhu=0==s.zimo.l?1:2),s.gang&&(i.qianggang=!0),s.gangzimo&&(i.lingshang=!0),n.shan.paishu||s.gangzimo||(i.haidi=s.zimo?1:2),s}(t,i,a);if(o.hule)return{l:t,shoupai:o.hule.shoupai,baojia:o.hule.baojia,fubaopai:o.hule.fubaopai,damanguan:o.hule.damanguan,fu:o.hule.fu,fanshu:o.hule.fanshu,defen:o.hule.defen,hupai:o.hule.hupai,fenpei:o.hule.fenpei,_changbang:a.changbang,_lizhibang:a.lizhibang};let r,l,h=n.shoupai[t].clone();(o.dapai||o.gang)&&(o.dapai&&(r=o.dapai.p.slice(0,2),l=o.dapai.l),o.gang&&(r=o.gang.m[0]+o.gang.m.slice(-1),l=o.gang.l),h._zimo==r&&h.dapai(r),r+=["_","+","=","-"][(4+l-t)%4],l==t&&(r=null));let u=s.Util.hule(h,r,s.Util.hule_param(a));return u&&u.defen?{l:t,shoupai:(r?h.zimo(r):h).toString(),baojia:l,fubaopai:a.fubaopai,damanguan:u.damanguan,fu:u.fu,fanshu:u.fanshu,defen:u.defen,hupai:u.hupai,fenpei:u.fenpei,_changbang:a.changbang,_lizhibang:a.lizhibang}:{l:t,shoupai:(r?h.zimo(r):h).toString(),baojia:l,fubaopai:e,hupai:[],fenpei:[],_changbang:a.changbang,_lizhibang:a.lizhibang}}init_hule_dialog(){const t=this._paipu.player,e=this._model.player_id,i=n(".hule form",this._root);let s,a,o=(t=>{let e;for(let i of t)(i.zimo||i.dapai||i.fulou||i.gang||i.gangzimo)&&(e=i);return e})(this._paipu.log[this._log_idx]);o&&(o.zimo?s=o.zimo.l:o.dapai?a=o.dapai.l:o.gang?a=o.gang.l:o.gangzimo&&(s=o.gangzimo.l));for(let o of["l","baojia"]){const r=n(`select[name="${o}"]`,i),l=r.children().eq(0);r.empty(),r.append(l);for(let i=0;i<4;i++){if("l"==o){if(a==i)continue;if(null==a&&s!=i)continue}else if(a!=i)continue;let n=l.clone().text(["東","南","西","北"][i]+": "+t[e[i]].replace(/\n.*$/,"")).val(i);r.append(n)}}u(n(".flip",i)),n('[name="l"], [name="fubaopai"]',i).off("change").on("change",(()=>{let t=n('[name="l"]',i).val(),e=n('[name="fubaopai"]',i).toArray().map((t=>n(t).val())).filter((t=>t));t?this.draw_hule_dialog(this.make_hule(+t,e)):this.open_pingju_dialog(this.make_pingju())})),n('.hupai, [name="fu"], [name="damanguan"]',i).off("change").on("change",(()=>{this.draw_hule_dialog(m(function(t,e){let i;if(t.hupai.find((t=>"*"==t.fanshu[0]))?(delete t.fu,delete t.fanshu,t.hupai.forEach((t=>{"*"!=t.fanshu[0]&&(t.fanshu=""),delete t.baojia})),t.damanguan=Math.min(t.hupai.filter((t=>t.fanshu.match(/^\*+$/))).map((t=>t.fanshu.length)).reduce(((t,e)=>t+e)),t.damanguan||1/0),i=8e3*t.damanguan):(delete t.damanguan,t.hupai=t.hupai.filter((t=>t.name)),t.fu=t.fu||30,t.fanshu=t.hupai.map((t=>t.fanshu)).reduce(((t,e)=>t+e)),i=t.fanshu>=13&&e["数え役満あり"]?8e3:t.fanshu>=11?6e3:t.fanshu>=8?4e3:t.fanshu>=6?3e3:e["切り上げ満貫あり"]&&t.fu<<2+t.fanshu==1920?2e3:Math.min(t.fu<<2+t.fanshu,2e3)),null==t.baojia){let e=100*Math.ceil(2*i/100),n=100*Math.ceil(i/100);t.defen=0==t.l?3*e:e+2*n}else t.defen=0==t.l?100*Math.ceil(6*i/100):100*Math.ceil(4*i/100);return t}(this.get_hule(),this._rule)))})),n('[name="defen"], .jicun').off("change").on("change",(()=>{this.draw_hule_dialog(m(this.get_hule()))})),n("input.close",i).off("click").on("click",(()=>this.close_dialog())),n("input.delete",i).off("click").on("click",(()=>this.delete_hule())),i.off("submit").on("submit",(()=>this.update_hule()))}draw_hule_dialog(t){const e=this._pai,i=n(".hule form",this._root);n('[name="l"]',i).val(t.l),n('[name="baojia"]',i).val(t.baojia);const l=s.Shoupai.fromString(t.shoupai),h=n(".shan",i);n('[name="fubaopai"]',i).val(""),n(".flip",h).attr("tabindex",-1),l.lizhi||t.fubaopai&&t.fubaopai.length?(r(n(".fubaopai"),i),(t.fubaopai||[]).forEach(((t,e)=>{n('[name="fubaopai"]',i).eq(e).val(t)})),(t=>{for(let a=0;a<5;a++){let o=s.Shoupai.valid_pai(n('[name="fubaopai"]',i).eq(a).val());n(".flip >.pai",h).eq(a).empty().append(e(o||"_")),a<t&&n(".flip",h).eq(a).attr("tabindex",0)}})(this._model.shan.baopai.length)):o(n(".fubaopai"),i),n('[name="shoupai"]',i).val(t.shoupai),new a(n(".shoupai",i),this._pai,l).redraw(!0);const u=n(".hupai",i);n("input",u).val("");const p=u.children().eq(0);u.empty();for(let e of t.hupai){let t=p.clone();n('[name="hupai"]',t).val(e.name),n('[name="fanshu"]',t).val(e.fanshu),n('[name="baojia"]',t).val(e.baojia),u.append(t)}u.append(p),t.damanguan?(r(n(".damanguan",i)),o(n(".normal",i)),n('[name="damanguan"]',i).val(t.damanguan)):(o(n(".damanguan",i)),r(n(".normal",i)),n('[name="damanguan"]',i).val("")),n('.defen [name="fu"]',i).val(t.fu),n('.defen [name="fanshu"]',i).val(t.fanshu),n('.defen [name="defen"]',i).val(t.defen),n('[name="changbang"]',i).val(t._changbang),n('[name="lizhibang"]',i).val(t._lizhibang);for(let e=0;e<4;e++)n('[name="fenpei"]',i).eq(e).val(t.fenpei[e])}get_hule(){const t=n(".hule form",this._root);let e,i,s=n('[name="baojia"]',t).val(),a=n('[name="fubaopai"]',t).toArray().map((t=>n(t).val())).filter((t=>t)),o=n('[name="damanguan"]',t).val();o=o?+o:void 0,o||(e=+n('.defen [name="fu"]',t).val(),i=+n('.defen [name="fanshu"]',t).val());let r=[];return n(".hupai",t).children().each(((t,e)=>{let i=n('[name="hupai"]',e).val(),s=n('[name="fanshu"]',e).val();"*"!=s[0]&&(s=+(s||0));let a=n('[name="baojia"]',e).val();i&&(a?r.push({name:i,fanshu:s,baojia:a}):r.push({name:i,fanshu:s}))})),{l:+n('[name="l"]',t).val(),shoupai:n('[name="shoupai"]',t).val(),baojia:""==s?null:+s,fubaopai:a.length?a:null,damanguan:o,fu:e,fanshu:i,defen:+n('.defen [name="defen"]',t).val(),hupai:r,fenpei:n('[name="fenpei"]',t).toArray().map((t=>+(n(t).val()||0))),_changbang:+n('[name="changbang"]',t).val(),_lizhibang:+n('[name="lizhibang"]',t).val()}}update_hule(){const t=this._log_idx,e=this.get_hule();delete e._changbang,delete e._lizhibang;const i=this._paipu.log[t].filter((t=>!t.pingju));let n=-1;i.forEach(((t,i)=>{t.hule&&t.hule.l==e.l&&(n=i)})),n>=0?i[n]={hule:e}:i.push({hule:e}),this._paipu.log[t]=i,this.update_paipu(),this.changed()}delete_hule(){const t=this._log_idx;n("dialog.hule",this._root).get(0).close(),n("dialog.pingju",this._root).get(0).close();let e=this._paipu.log[t].filter((t=>!(t.hule||t.pingju)));this._paipu.log[t]=e,this.update_paipu(),this.changed()}open_pingju_dialog(t){this.init_pingju_dialog(),this.draw_pingju_dialog(t),n("dialog.hule",this._root).get(0).close(),n("dialog.pingju",this._root).get(0).showModal()}make_pingju(){const t=this._paipu.log[this._log_idx],e=this._model;let i,n={name:"",shoupai:["","","",""],fenpei:[0,0,0,0]},a=0,o=0,r=!0,l=null;for(let e of t)e.dapai&&"*"==e.dapai.p.slice(-1)&&a++,e.kaigang&&o++,e.dapai&&null==l&&(l=e.dapai.p.slice(0,2)),e.dapai&&l&&(r&&e.dapai.p.match(/^z[0-3]/)?e.dapai.p.slice(0,2)!=l&&(l=!1):l=!1),(e.fulou||e.gang||e.dapai&&3==e.dapai.l)&&(r=!1),e.kaigang||e.hule||e.pingju||(i=e);if(i.dapai){for(let t=0;t<4;t++)0==s.Util.xiangting(e.shoupai[t])&&(n.shoupai[t]=e.shoupai[t].toString());e.shan.paishu?(l&&(n.name="四風連打",n.shoupai=["","","",""]),4==o&&(n.name="四開槓",n.shoupai=["","","",""]),4==a&&(n.name="四家立直")):(this._rule["流し満貫あり"]&&(n=function(t,e){for(let i=0;i<4;i++){let n=!0;for(let e of t.he[i]._pai){if(e.match(/[\+\=\-]$/)){n=!1;break}if(!e.match(/^z/)&&!e.match(/^[mps][19]/)){n=!1;break}}if(n){e.name="流し満貫";for(let t=0;t<4;t++)e.fenpei[t]+=0==i&&t==i?12e3:0==i?-4e3:0!=i&&t==i?8e3:0!=i&&0==t?-4e3:-2e3}}return e}(this._model,n)),n.name||(n.name="荒牌平局",n=v(n)))}return i.zimo&&s.Game.allow_pingju(s.rule({途中流局あり:!0}),e.shoupai[i.zimo.l],r)&&(n.name="九種九牌",n.shoupai[i.zimo.l]=e.shoupai[i.zimo.l].toString()),n}init_pingju_dialog(){const t=n(".pingju form",this._root),e=this._model;n('[name="pingju"]',t).off("change").on("change",(()=>{n('[name="daopai"]',t).val([0]),n('[name="fenpei"]',t).val(0),this.draw_pingju_dialog(this.get_pingju())})),n('[name="daopai"]',t).off("change").on("change",(()=>{e.shan.paishu?this.draw_pingju_dialog(this.get_pingju()):this.draw_pingju_dialog(v(this.get_pingju()))})),n("input.hule",t).off("click").on("click",(()=>this.open_hule_dialog())),n("input.delete",t).off("click").on("click",(()=>this.delete_pingju())),n("input.close",t).off("click").on("click",(()=>this.close_dialog())),t.off("submit").on("submit",(()=>this.update_pingju()))}draw_pingju_dialog(t){const e=n(".pingju form",this._root),i=this._model;n('[name="pingju"]',e).val(t.name);for(let o=0;o<4;o++){n('[name="fenpei"]',e).eq(o).val(t.fenpei[o]),n('[name="daopai"]',e).eq(o).val([t.shoupai[o]?1:0]);let r=t.shoupai[o]||i.shoupai[o].toString();n('[name="shoupai"]',e).eq(o).val(r),new a(n(".shoupai",e).eq(o),this._pai,s.Shoupai.fromString(n('[name="shoupai"]',e).eq(o).val())).redraw(n('[name="daopai"]',e).eq(o).prop("checked"))}}get_pingju(){const t=n(".pingju form",this._root);return{name:n('[name="pingju"]',t).val()||"流局",shoupai:n('[name="daopai"]',t).toArray().map(((e,i)=>n(e).prop("checked")?n('[name="shoupai"]',t).eq(i).val():"")),fenpei:n('[name="fenpei"]',t).toArray().map((t=>+n(t).val()))}}update_pingju(){const t=this._log_idx;let e=this.get_pingju(),i=this._paipu.log[t].filter((t=>!(t.hule||t.pingju)));i.push({pingju:e}),this._paipu.log[t]=i,this.update_paipu(),this.changed()}delete_pingju(){this.delete_hule()}}},8521:t=>{"use strict";t.exports={show:t=>t.removeClass("hide fadeout"),hide:t=>t.addClass("hide fadeout"),fadeIn:t=>(t.addClass("hide fadeout"),setTimeout((()=>{t.removeClass("hide"),setTimeout((()=>t.off("transitionend").removeClass("fadeout")),20)}),100),t),fadeOut:t=>t.on("transitionend",(()=>t.off("transitionend").addClass("hide"))).addClass("fadeout")}},6750:(t,e,i)=>{"use strict";const n=i(4692);i(5285);const{hide:s,show:a,fadeIn:o,fadeOut:r}=i(8521);function l(t){const e=["title","player","qijia","log","defen","rank","point"];for(let i of[].concat(t))for(let t of e)if(null==i[t])throw new Error(`${t}: undefined`);return t}class h{constructor(t){this._paipu=[],this._name=t;try{t&&(this._paipu=l(JSON.parse(localStorage.getItem(t)||"[]")))}catch(t){console.log(t)}}get length(){return this._paipu.length}stringify(t){return JSON.stringify(null==t?this._paipu:this._paipu[t])}save(){if(this._name)try{localStorage.setItem(this._name,this.stringify())}catch(t){throw this._paipu=l(JSON.parse(localStorage.getItem(this._name)||"[]")),t}}add(t,e=!0){this._paipu=this._paipu.concat(l(t)),e&&this.save()}del(t){this._paipu.splice(t,1),this.save()}get(t){return null==t?this._paipu:this._paipu[t]}sort(t){let e=this._paipu.concat();for(let i=0;i<this.length;i++)this._paipu[i]=e[t[i]];this.save()}}t.exports=class{constructor(t,e,i,s,a,l,u,p){if(this._root=t,this._row=n(".row",t),this._storage=e,this._paipu=new h(e),this._max_idx=0,this.open_viewer=i,this.goto_stat=s,this.open_editor=a,l){let t=location.href.replace(/\?.*$/,"").replace(/[^\/]*$/,"");location.origin;l.slice(0,t.length)==t?this._tenhou=l.slice(t.length):l.slice(0,origin.length)==origin?this._tenhou=l.slice(origin.length):this._tenhou=l}n('input[name="storage"]',t).prop("checked",!0),n(".upload input",t).on("change",(t=>{for(let e of t.target.files)this.read_paipu(e);n(t.target).val(null)})),n('input[name="storage"]',t).on("change",(t=>{this.storage(n(t.target).prop("checked")),o(n("body"))})),n(".stat",t).on("click",(()=>{this._url&&history.replaceState("","","#stat"),this.goto_stat(this._paipu.get())})),n(".file > .button .edit",t).on("click",(()=>{let t={title:"(対局名)",player:["(東家)","(南家)","(西家)","(北家)"],qijia:0,log:[],defen:[],rank:[],point:[]};this._paipu.add(t,!1),this.open_editor(t,(()=>this._paipu.save()))})),n(".error",t).on("click",(()=>r(n(".error",t)))),n("form.tenhou",this._root).on("submit",(t=>{let e=n('input[name="url"]',n(t.target)).val(),i=e.match(/#.*$/)||"";if(!i){let t=""+(e.match(/\&.*$/)||""),n=(t.match(/\&tw=(\d+)/)||[])[1]||"",s=(t.match(/\&ts=(\d+)/)||[])[1]||"",a=(t.match(/\&tj=(\d+)/)||[])[1]||"";t&&(i=`#/${n}/${s}/${a}`)}let s=e.replace(/^.*\?log=/,"").replace(/\&.*$/,"").replace(/#.*$/,"").replace(/^.*\//,"").replace(/\..*$/,"");return location="?"+this._tenhou+s+".json"+i,!1})),u?this.load_paipu(u,p):this.isEmpty&&n('input[name="storage"]',t).trigger("click")}storage(t){t&&(delete this._url,history.replaceState("","",location.pathname)),this._paipu=new h(t?this._storage:null),n('input[name="storage"]',this._root).prop("checked",t),this.redraw()}get isEmpty(){return!this._paipu.length}add(t,e){for(delete this._url,this._paipu.add(t);this._paipu.length>e;)this._paipu.del(0)}read_paipu(t){if(!t.type.match(/^application\/json$/i)&&!t.name.match(/\.json$/i))return void this.error(`${t.name}: 不正なファイルです`);const e=new FileReader;e.onload=e=>{try{let t=JSON.parse(e.target.result);this.add(t)}catch(e){e instanceof DOMException?this.error("ローカルストレージ容量オーバー"):this.error(`${t.name}: 牌譜形式が不正です`)}this.redraw()},e.readAsText(t)}load_paipu(t,e){this.storage(!1),o(n(".loading",this._root)),fetch(t).then((e=>{if(!e.ok)throw this.error(`${decodeURI(t)}: ${function(t){return t.statusText?`${t.status} ${t.statusText}`:`${t.status} ${{400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"}[t.status]}`}(e)}`),new Error;return e.json()})).then((i=>{setTimeout((()=>s(n(".loading",this._root))),100),this.add(i),this.redraw(),this._url=t,e&&this.open(e)})).catch((e=>{setTimeout((()=>s(n(".loading",this._root))),100),e instanceof TypeError?this.error(`${decodeURI(t)}: ${e.message}`):e.message&&this.error(`${decodeURI(t)}: 牌譜形式が不正です`)}))}redraw(){let t=n(".list",this._root).empty();for(let e=0;e<this._paipu.length;e++){let i=this._paipu.get(e),o=[];if(!i.rank.length)for(let t=0;t<4;t++){let e=(i.qijia+t)%4;i.rank[e]=t+1}for(let t=0;t<4;t++){let e=(i.point[t]>0?"+":"")+(i.point[t]??"−");o[i.rank[t]-1]=`${i.player[t]} (${e})`}let r=this._row.clone();r.attr("data-idx",e),n(".title",r).text(i.title),n(".player",r).text(o.join(" / ")),t.append(s(r)),e<this._max_idx&&a(r)}this._max_idx=this._paipu.length,n('input[name="storage"]',this._root).prop("checked")?a(n(".file .edit"),this._root):s(n(".file .edit"),this._root),this.isEmpty?(s(n(".file > .button .stat",this._root)),s(n(".file > .button .download",this._root)),n('input[name="storage"]',this._root).prop("checked")?s(n("form.tenhou",this._root)):this._tenhou&&a(n("form.tenhou",this._root))):(a(n(".file > .button .stat",this._root)),a(n(".file > .button .download",this._root)),s(n("form.tenhou",this._root))),this.set_handler(),n(".list",this._node).sortable({opacity:.7,cursor:"move",axis:"y",containment:"parent",tolerance:"pointer",handle:".move",update:(t,e)=>{delete this._url;let i=n.makeArray(n(t.target).children().map(((t,e)=>n(e).data("idx"))));this._paipu.sort(i),this.redraw()}}),navigator.maxTouchPoints&&s(n(".move, .edit",this._node)),a(n(".file",this._root)),o(n(".row.hide"),this._root)}set_handler(){if(this.isEmpty)return;let t=n(".row",this._root);for(let e=0;e<this._paipu.length;e++){n(".replay",t.eq(e)).on("click",(()=>{const t=this.open_viewer(this._paipu.get(e));this._url&&t.set_fragment(`#${e||""}`),t.start()})),n(".edit",t.eq(e)).on("click",(()=>{this.open_editor(this._paipu.get(e),(()=>this._paipu.save()))})),n(".delete",t.eq(e)).on("click",(()=>{delete this._url,this._paipu.del(e),this.redraw()}));let i=this._paipu.get(e).title.replace(/[\s\n\\\/\:]/g,"_"),s=new Blob([this._paipu.stringify(e)],{type:"application/json"});n(".download",t.eq(e)).attr("href",URL.createObjectURL(s)).attr("download",`牌譜(${i}).json`)}let e=this._paipu.get(0).title.replace(/[\s\n\\\/\:]/g,"_"),i=new Blob([this._paipu.stringify()],{type:"application/json"});n(".file > .button .download",this._root).attr("href",URL.createObjectURL(i)).attr("download",`牌譜(${e}).json`)}open(t){if("stat"==t)this.goto_stat(this._paipu.get());else if(t){let[e,i]=t.split(":");e=e.split("/").map((t=>isNaN(t)?0:0|+t));let n=e.shift();if(n>=this._paipu.length)return;const s=this.open_viewer(this._paipu.get(n));if(s.set_fragment("#"+t),s.start(...e),i){i.match(/s/)&&s.shoupai(),i.match(/h/)&&s.he(),i.match(/i/)&&s.analyzer();for(let t of i.match(/\+/g)||[]){if(s._deny_repeat)break;s.next()}}}}error(t){const e=n(".error",this._root).text(t);o(e),setTimeout((()=>e.trigger("click")),5e3)}}},1367:t=>{"use strict";t.exports=function(t){t.off("focus").on("focus",(t=>{let e=$(t.target).attr("tabindex")||0;$(t.target).removeAttr("tabindex"),$(t.target).children().eq(0).hide();let i=$(t.target).children().eq(1);i.show(),i.attr("tabindex",e),i.trigger("focus")})),t.each(((t,e)=>{$(e).children().eq(1).off("blur").on("blur",(t=>{let e=$(t.target).attr("tabindex");$(t.target).removeAttr("tabindex"),$(t.target).hide(),$(t.target).parent().attr("tabindex",e),$(t.target).parent().children().eq(0).show()})),$(e).children().eq(1).hide()}))}},1601:(t,e,i)=>{"use strict";const{hide:n,show:s}=i(8521);t.exports=class{constructor(t,e,i,...n){this._node={controller:$(".controller",t),download:$(".download",t)},this._game=i,this._view=n,this._storage=e,this._pref=localStorage.getItem(e)?JSON.parse(localStorage.getItem(e)):{sound_on:!0,speed:3},i&&(i._view.no_player_name=!0),this.redraw()}redraw(){$(".speed span",this._node.controller).css("visibility","visible"),this.sound(this._pref.sound_on),this.speed(this._pref.speed),this.set_handler()}speed(t){return!!this._game&&(t<1&&(t=1),t>5&&(t=5),this._game.speed=t,$(".speed span",this._root).each(((e,i)=>{$(i).css("visibility",e<t?"visible":"hidden")})),this._pref.speed=t,localStorage.setItem(this._storage,JSON.stringify(this._pref)),!1)}sound(t){return this._view.forEach((e=>e.sound_on=t)),t?(n($(".sound.off",this._node.controller)),s($(".sound.on",this._node.controller))):(n($(".sound.on",this._node.controller)),s($(".sound.off",this._node.controller))),this._pref.sound_on=t,localStorage.setItem(this._storage,JSON.stringify(this._pref)),!1}set_handler(){this.clear_handler();const t=this._node.controller;$(".sound",t).on("click",(()=>this.sound(!this._pref.sound_on))),$(".minus",t).on("click",(()=>this.speed(this._game.speed-1))),$(".plus",t).on("click",(()=>this.speed(this._game.speed+1))),$(window).on("keyup.controler",(t=>{"a"==t.key?this.sound(!this._pref.sound_on):"-"==t.key?this.speed(this._game.speed-1):"+"==t.key&&this.speed(this._game.speed+1)}))}clear_handler(){$(".sound, .minus, .plus",this._node.controller).off("click"),$(window).off(".controler")}stop(){this._game.stop();let t=new Blob([JSON.stringify(this._game._paipu)],{type:"application/json"});$("a",this._node.download).attr("href",URL.createObjectURL(t)).attr("download","牌譜.json"),s(this._node.download),this.stoped=!0}start(){this.stoped=!1,n(this._node.download),this._game.start()}shoupai(){const t=this._game;return"hule"==t._status||("pingju"==t._status||("jieju"==t._status||(t._view.open_shoupai=!t._view.open_shoupai,t._view.redraw(),!1)))}he(){const t=this._game;return"hule"==t._status||("pingju"==t._status||("jieju"==t._status||(t._view.open_he=!t._view.open_he,t._view.redraw(),!1)))}}},2819:(t,e,i)=>{"use strict";const n=i(4692);t.exports=class{constructor(t,e,i,s){this._node={root:t,chouma:n(".chouma",t),dapai:n(".dapai",t)},this._pai=e,this._he=i,this._open=s,this._node.chouma.addClass("hide")}redraw(t){null!=t&&(this._open=t),this._node.root.attr("aria-label","捨て牌"),this._node.chouma.attr("aria-label","リーチ"),this._node.dapai.empty();let e=!1,i=0;for(let t of this._he._pai){if(t.match(/\*/)&&(e=!0,this._node.chouma.removeClass("hide")),t.match(/[\+\=\-]/))continue;let s=this._pai(t);this._open&&"_"==t[2]&&s.addClass("mopai"),e&&(s=n('<span class="lizhi">').attr("aria-label","リーチ").append(s),e=!1),this._node.dapai.append(s),i++,i<18&&i%6==0&&this._node.dapai.append(n('<span class="break">'))}return this}dapai(t){let e=this._pai(t).addClass("dapai").attr("aria-live","assertive");return"_"==t[2]&&e.addClass("mopai"),t.match(/\*/)&&(e=n('<span class="lizhi">').append(e)),this._node.dapai.append(e),this}}},2698:(t,e,i)=>{"use strict";
/*!
 *  @kobalab/majiang-ui v1.4.11
 *
 *  Copyright(C) 2021 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/majiang-ui/blob/master/LICENSE
 */t.exports={pai:i(9448),audio:i(4180),Shoupai:i(4761),He:i(2819),Shan:i(5644),Board:i(8482),HuleDialog:i(2532),Player:i(333),GameCtl:i(1601),PaipuFile:i(6750),Paipu:i(3635),Analyzer:i(1166),PaipuStat:i(4106),PaipuEditor:i(6521),Util:Object.assign(i(8521),i(9893),i(4864),{flipInput:i(1367)})}},4800:(t,e,i)=>{"use strict";const n=i(4692);t.exports=function(t){return function(e){let i=n('<span class="mianzi">'),s=e[0];if(e.replace(/0/g,"5").match(/^[mpsz](\d)\1\1\1$/)){let n=e.match(/\d/g);i.attr("aria-label","アンカン").append(t("_")).append(t(s+n[2])).append(t(s+n[3])).append(t("_"))}else if(e.replace(/0/g,"5").match(/^[mpsz](\d)\1\1/)){let a=e.match(/[\+\=\-]\d$/),o=e.match(/[\+\=\-]/),r=e.match(/\d/g),l=t(s+r[0]),h=n('<span class="rotate">').append(a?r.slice(-2).map((e=>t(s+e))):r.slice(-1).map((e=>t(s+e)))),u=a||4!=r.length?r.slice(1,2).map((e=>t(s+e))):r.slice(1,3).map((e=>t(s+e))),p=("+"==o?"シモチャから":"="==o?"トイメンから":"カミチャから")+(a?"カカン":4==r.length?"カン":"ポン");i.attr("aria-label",p),"+"==o&&i.append(l).append(u).append(h),"="==o&&i.append(l).append(h).append(u),"-"==o&&i.append(h).append(l).append(u)}else{let a=e.match(/\d(?=\-)/).concat(e.match(/\d(?!\-)/g));i.attr("aria-label","チー").append(n('<span class="rotate">').append(t(s+a[0]))).append(t(s+a[1])).append(t(s+a[2]))}return i}}},9448:(t,e,i)=>{"use strict";const n=i(4692);t.exports=function(t){const e={};return n(".pai",t).each((function(){let t=n(this).data("pai");e[t]=n(this)})),function(t){return e[t.slice(0,2)].clone()}}},3635:(t,e,i)=>{"use strict";const n=i(8739),s=i(8482),{hide:a,show:o}=i(8521),r=["main","xiajia","duimian","shangjia"];t.exports=class{constructor(t,e,i,a,o,r,l){this._root=t,this._paipu=e,this._model=new n.Board(e),this._view=new s($(".board",t),i,a,this._model),this._pref=o,this._log_idx=-1,this._idx=0,this._deny_repeat,this._repeat_timer,this._autoplay,this._autoplay_timer,this._view.open_shoupai=!0,this._view.open_he=!0,this._speed=3,this._summary=!1,this._callback=r,this._open_analyzer=l}get_pref(){return localStorage.getItem(this._pref)?JSON.parse(localStorage.getItem(this._pref)):{sound_on:this._view.sound_on,speed:this._speed}}set_pref(){let t={sound_on:this._view.sound_on,speed:this._speed};localStorage.setItem(this._pref,JSON.stringify(t))}set_handler(){this.clear_handler();const t=$(".controller",this._root);this._root.on("mousedown",(t=>!!t.button||(this.next(),!1))),this._root.on("mouseup mousemove touchend",(()=>{this._repeat_timer=clearInterval(this._repeat_timer),this._repeet&&(this._repeet=!1,this._analyzer&&(this._deny_repeat?this._analyzer.clear():(this.seek(this._log_idx,this._idx-1),this._analyzer.active(!0))))})),$(".next",t).on("mousedown touchstart",(()=>(this._repeat_timer||(this.next(),this._repeat_timer=setTimeout((()=>{this._repeet=!0,this._analyzer&&this._analyzer.active(!1),this._repeat_timer=setInterval((()=>{this._deny_repeat||this.next()}),80)}),200)),!1))),$(".prev",t).on("mousedown touchstart",(()=>(this._repeat_timer||(this.prev(),this._repeat_timer=setTimeout((()=>{this._repeet=!0,this._analyzer&&this._analyzer.active(!1),this._repeat_timer=setInterval((()=>this.prev()),80)}),200)),!1))),$(".last",t).on("mousedown",(()=>this.forward())),$(".first",t).on("mousedown",(()=>this.backward())),$(".play",t).on("mousedown",(()=>this.autoplay())),$(".summary",t).on("mousedown",(()=>this.summary())),$(".analyzer",t).on("mousedown",(()=>this.analyzer())),$(".sound",t).on("mousedown",(()=>this.sound(!this._view.sound_on))),$(".minus",t).on("mousedown",(()=>this.speed(this._speed-1))),$(".plus",t).on("mousedown",(()=>this.speed(this._speed+1))),$(".exit",t).on("mousedown",(()=>this.exit()));for(let t=0;t<4;t++)$(`.shoupai.${r[t]}`,this._root).on("mousedown",".pai",(()=>this.shoupai())),$(`.he.${r[t]}`,this._root).on("mousedown",".pai",(()=>this.he())),$(`.player.${r[t]}`,this._root).addClass("selectable").on("mousedown",(()=>this.viewpoint(this._view.viewpoint+t))),$(`.player .${r[t]}`,this._root).addClass("selectable").on("mousedown",(()=>{this.viewpoint(this._view.viewpoint+t)}));o($("> *",t)),a($(".play.off",t)),$(window).on("keyup.paipu",(t=>{this._repeet&&(this._repeet=!1,this._analyzer&&(this._deny_repeat?this._analyzer.clear():(this.seek(this._log_idx,this._idx-1),this._analyzer.active(!0)))),"ArrowRight"==t.key?this.forward():"ArrowLeft"==t.key?this.backward():" "==t.key?this.autoplay():"v"==t.key?this.viewpoint(this._view.viewpoint+1):"?"==t.key?this.summary():"i"==t.key?this.analyzer():"a"==t.key?this.sound(!this._view.sound_on):"-"==t.key?this.speed(this._speed-1):"+"==t.key?this.speed(this._speed+1):"s"==t.key?this.shoupai():"h"==t.key?this.he():"q"!=t.key&&"Escape"!=t.key||this.exit()})),$(window).on("keydown.paipu",(t=>{t.key.match(/^Arrow/)&&t.preventDefault(),t.originalEvent.repeat&&(this._repeet=!0,this._analyzer&&this._analyzer.active(!1),this._deny_repeat)||("Enter"==t.key||"ArrowDown"==t.key?this.next():"ArrowUp"==t.key&&this.prev())}));let e=this.get_pref();this.sound(e.sound_on),this.speed(e.speed)}clear_handler(){this._autoplay&&this.autoplay(),this.set_fragment("");const t=$(".controller",this._root);this._root.off("mousedown mouseup mousemove touchstart touchend"),$(".player *").removeClass("selectable").off("mousedown"),$(".player").removeClass("selectable").off("mousedown"),$(".shoupai",this._root).off("mousedown",".pai"),$(".he",this._root).off("mousedown",".pai"),$("*",t).off("mousedown touchstart"),$(window).off(".paipu")}start(t=0,e=-1,i=0){this._html_title=$("title").text();let n=this._paipu.title+" - "+this._html_title;$("title").text(n),$('meta[property="og:title"]').attr("content",n),this.set_handler(),this._view.viewpoint=(4+t%4)%4,this.set_fragment(),e<0?(a($(".controller",this._root)),this._view.kaiju()):this.seek(e,i)}suspend(){o($(".suspend",this._root)),this._deny_repeat=!0}exit(){$("title").text(this._html_title),$('meta[property="og:title"]').attr("content",this._html_title),this.clear_handler(),this._callback()}seek(t,e){let i;for(this._deny_repeat=!1,this._summary&&this.summary(),t=t<0?0:this._paipu.log.length-1<t?this._paipu.log.length-1:t,e=e<0?0:this._paipu.log[t].length-1<e?this._paipu.log[t].length-1:e,this._log_idx=t,this._idx=0,this._redo=!1;this._idx<=e;)i=this._paipu.log[this._log_idx][this._idx],i.qipai?this._model.qipai(i.qipai):i.zimo?this._model.zimo(i.zimo):i.dapai?this._model.dapai(i.dapai):i.fulou?this._model.fulou(i.fulou):i.gang?this._model.gang(i.gang):i.gangzimo?this._model.zimo(i.gangzimo):i.kaigang?this._model.kaigang(i.kaigang):i.hule?this._model.hule(i.hule):i.pingju&&this._model.pingju(i.pingju),this._analyzer&&!this._repeet&&(e==this._idx?this._analyzer.action(i):this._analyzer.next(i)),this._idx++;this.set_fragment(),this._view.redraw(),a($(".suspend",this._root)),o($(".controller",this._root)),(i.hule||i.pingju)&&this._view.update(i)}next(){if(a($(".suspend",this._root)),o($(".controller",this._root)),this._autoplay_timer=clearTimeout(this._autoplay_timer),this._log_idx<0&&(this._log_idx=0,this._idx=0),this._log_idx==this._paipu.log.length)return void this.exit();if(this._idx>=this._paipu.log[this._log_idx].length){if(!this._deny_repeat)return this.suspend();this._model.last(),this._log_idx++,this._idx=0}if(this._log_idx==this._paipu.log.length)return null!=this._target_log_idx&&this.exit(),this._deny_repeat=!1,this._paipu.defen.length&&this._model.jieju(this._paipu),this._view.update(),void this.summary();if(this._summary)return void this.summary();let t=this._paipu.log[this._log_idx][this._idx];if(t.qipai?this.qipai(t):t.zimo?this.zimo(t):t.dapai?this.dapai(t):t.fulou?this.fulou(t):t.gang?this.gang(t):t.gangzimo?this.gangzimo(t):t.kaigang?this.kaigang(t):t.hule?this.hule(t):t.pingju&&this.pingju(t),!this._analyzer||this._redo||this._repeet||this._analyzer.action(t),this._redo||this._idx++,this._paipu.log[this._log_idx][this._idx]&&this._paipu.log[this._log_idx][this._idx].kaigang&&this.next(),this._autoplay){let t=this._redo?500:this._deny_repeat?3e3+2e3*this._speed:200*this._speed;this._autoplay_timer=setTimeout((()=>this.next()),t)}this.set_fragment()}prev(){if(this._summary||this._log_idx<0||0==this._idx)return!0;this._autoplay&&this.autoplay();let t=this._idx>=2?this._idx-2:0,e=this._paipu.log[this._log_idx][t];for(;t>0&&!(e.zimo||e.gangzimo||e.fulou&&!e.fulou.m.match(/\d{4}/));)e=this._paipu.log[this._log_idx][--t];this.seek(this._log_idx,t)}qipai(t){null!=this._target_log_idx&&this._log_idx!=this._target_log_idx&&this.exit(),this._deny_repeat=!1,this._model.qipai(t.qipai),this._view.redraw()}zimo(t){this._model.zimo(t.zimo),this._view.update(t)}dapai(t){if("*"==t.dapai.p.slice(-1)&&!this._redo)return this._redo=!0,void this._view.say("lizhi",t.dapai.l);this._redo=!1,this._model.dapai(t.dapai),this._view.update(t)}fulou(t){if(this._redo)this._redo=!1,this._model.fulou(t.fulou),this._view.update(t);else{this._redo=!0;let e=t.fulou.m.replace(/0/,"5");e.match(/^[mpsz](\d)\1\1\1/)?this._view.say("gang",t.fulou.l):e.match(/^[mpsz](\d)\1\1/)?this._view.say("peng",t.fulou.l):this._view.say("chi",t.fulou.l)}}gang(t){if(!this._redo)return this._redo=!0,void this._view.say("gang",t.gang.l);this._redo=!1,this._model.gang(t.gang),this._view.update(t)}gangzimo(t){this._model.zimo(t.gangzimo),this._view.update(t)}kaigang(t){this._model.kaigang(t.kaigang),this._view.update(t)}hule(t){if(this._redo||this._paipu.log[this._log_idx][this._idx-1].hule)this._redo=!1,this._model.hule(t.hule),this._view.update(t),this._deny_repeat=!0;else{this._redo=!0,null==t.hule.baojia?this._view.say("zimo",t.hule.l):this._view.say("rong",t.hule.l);let e=1;for(;this._idx+e<this._paipu.log[this._log_idx].length;){let t=this._paipu.log[this._log_idx][this._idx+e];this._view.say("rong",t.hule.l),e++}}}pingju(t){if(this._redo||!t.pingju.name.match(/^三家和/))this._redo=!1,this._model.pingju(t.pingju),this._view.update(t),this._deny_repeat=!0;else{this._redo=!0;for(let t=1;t<4;t++){let e=(this._model.lunban+t)%4;this._view.say("rong",e)}}}top(t){return this._autoplay&&this.autoplay(),t<0||this._paipu.log.length<=t||(this.seek(t,0),null!=this._target_log_idx&&this._log_idx!=this._target_log_idx&&this.exit()),!1}last(){this._autoplay&&this.autoplay();let t=this._paipu.log[this._log_idx].length-1,e=this._paipu.log[this._log_idx][t];for(;t>0&&(e.hule||e.pingju);)e=this._paipu.log[this._log_idx][--t];return this.seek(this._log_idx,t),e=this._paipu.log[this._log_idx][this._idx],(e.hule||e.pingju)&&(this.next(),this._redo&&setTimeout((()=>this.next()),400)),!1}forward(){return!!this._summary||!(this._log_idx<0||this._paipu.log.length<=this._log_idx)&&(this._idx<this._paipu.log[this._log_idx].length&&!this._deny_repeat?this.last():(this.next(),!1))}backward(){return!!this._summary||(this._paipu.log.length<=this._log_idx||(this._idx>1?this.top(this._log_idx):this.top(this._log_idx-1)))}preview(t){this._target_log_idx=t;let e=this._paipu.qijia;if(t>=0){let i=this._paipu.log[t][0].qipai;e=(this._paipu.qijia+i.jushu)%4}this.start(e,t)}summary(){if(this._log_idx<0||this._deny_repeat)return!0;if(this._summary)return this._view.summary(),this._analyzer&&this._analyzer.active(!0),o($(".controller",this._root)),this._summary=!1,this._autoplay&&this.next(),!1;this._autoplay_timer=clearTimeout(this._autoplay_timer),a($(".controller",this._root)),this._analyzer&&this._analyzer.active(!1),this._view.summary(this._paipu);for(let t=0;t<this._paipu.log.length;t++)$(".summary tbody tr",this._root).eq(t).on("mousedown",(e=>this.top(t)));return $(".summary",this._root).addClass("paipu"),this._summary=!0,!1}viewpoint(t){if(this._summary)return!0;if(this._autoplay&&this.autoplay(),this._view.viewpoint=t%4,this._analyzer&&(this._analyzer.id(this._view.viewpoint),this._log_idx>=0&&this.seek(this._log_idx,this._idx-1)),this.set_fragment(),this._log_idx<0)return this._view.kaiju(),!1;this._view.redraw();let e=this._paipu.log[this._log_idx][this._idx-1];return(e.hule||e.pingju)&&this._view.update(e),!1}speed(t){t<1&&(t=1),t>5&&(t=5),this._speed=t;const e=$(".controller",this._root);return $(".speed span",e).each(((e,i)=>{$(i).css("visibility",e<t?"visible":"hidden")})),this.set_pref(),!1}sound(t){this._view.sound_on=t;const e=$(".controller",this._root);return t?(a($(".sound.off",e)),o($(".sound.on",e))):(a($(".sound.on",e)),o($(".sound.off",e))),this.set_pref(),!1}shoupai(){if(this._summary)return!0;if(this._view.open_shoupai=!this._view.open_shoupai,this.set_fragment(),this._log_idx<0)return!1;this._view.redraw();let t=this._paipu.log[this._log_idx][this._idx-1];return(t.hule||t.pingju)&&this._view.update(t),!1}he(){if(this._summary)return!0;if(this._view.open_he=!this._view.open_he,this.set_fragment(),this._log_idx<0)return!1;this._view.redraw();let t=this._paipu.log[this._log_idx][this._idx-1];return(t.hule||t.pingju)&&this._view.update(t),!1}autoplay(){if(this._summary&&!this._autoplay)return!0;this._autoplay_timer=clearTimeout(this._autoplay_timer),this._autoplay=!this._autoplay;const t=$(".controller",this._root);return this._autoplay?(a($(".play.on"),t),o($(".play.off"),t)):(a($(".play.off"),t),o($(".play.on"),t)),this._autoplay&&this.next(),!1}analyzer(){return!!this._summary||(this._analyzer?(this._analyzer.close(),delete this._analyzer):(this._autoplay&&this.autoplay(),this._analyzer=this._open_analyzer({kaiju:{id:this._view.viewpoint,rule:n.rule(),title:this._paipu.title,player:this._paipu.player,qijia:this._paipu.qijia}}),this._log_idx<0?this._analyzer.active(!1):(this.seek(this._log_idx,this._idx-1),this._analyzer.active(!0))),this.set_fragment(),!1)}set_fragment(t){if(t)this._fragment_base=t.replace(/\/.*$/,"");else if(""==t)history.replaceState("","",location.href.replace(/#.*$/,""));else{if(!this._fragment_base)return;let t=[this._view.viewpoint];this._log_idx>=0&&t.push(this._log_idx,this._idx-1);let e=(this._view.open_shoupai?"":"s")+(this._view.open_he?"":"h")+(this._analyzer?"i":""),i=this._fragment_base+"/"+t.join("/")+(e?`:${e}`:"");history.replaceState("","",i)}}}},333:(t,e,i)=>{"use strict";const n=i(4692),s=i(8739),{hide:a,show:o,fadeIn:r}=i(8521),{setSelector:l,clearSelector:h}=i(9893),u=i(4800);t.exports=class extends s.Player{constructor(t,e,i){super(),this._node={root:t,timer:n(".timer",t),button:n(".player-button",t),mianzi:n(".select-mianzi",t),dapai:n(".shoupai.main .bingpai",t)},this._mianzi=u(e),this.sound_on=!0,this._audio={beep:i("beep")},this.clear_handler()}clear_handler(){this.clear_button(),this.clear_mianzi(),this.clear_dapai(),h("kaiju"),h("dialog"),h("summary")}callback(t){return this.clear_timer(),this.clear_handler(),this._callback(t),!1}set_button(t,e){o(n(`.${t}`,this._node.button).attr("tabindex",0).on("click.button",e)),this._show_button=!0}show_button(t=()=>{}){if(this.show_timer(),!this._show_button)return t();const e=()=>{this.clear_button(),t()};this.set_button("cansel",e),this._node.root.on("click.button",e),o(this._node.button.width(n(this._node.dapai).width())),l(n(".button[tabindex]",this._node.button),"button",{focus:-1,touch:!1})}clear_button(){a(n(".button",this._node.button)),h("button"),a(this._node.button),this._node.root.off(".button"),this._show_button=!1}select_mianzi(t){this.clear_button(),this._node.mianzi.empty();for(let e of t){let t=4==e.match(/\d/g).length?{gang:e}:{fulou:e};this._default_reply||(this._default_reply=t),this._node.mianzi.append(this._mianzi(e,!0).on("click.mianzi",(()=>this.callback(t))))}return o(this._node.mianzi.width(n(this._node.dapai).width())),l(n(".mianzi",this._node.mianzi),"mianzi",{touch:!1,focus:null}),!1}clear_mianzi(){setTimeout((()=>a(this._node.mianzi)),400),h("mianzi")}select_dapai(t){t&&(this._default_reply={dapai:t[0]+"*"});for(let e of t||this.get_dapai(this.shoupai)){let i=n("_"==e.slice(-1)?`.zimo .pai[data-pai="${e.slice(0,2)}"]`:`> .pai[data-pai="${e}"]`,this._node.dapai);t&&(i.addClass("blink"),e+="*"),i.attr("tabindex",0).attr("role","button").on("click.dapai",(t=>{n(t.target).addClass("dapai"),this.callback({dapai:e})}))}l(n(".pai[tabindex]",this._node.dapai),"dapai",{focus:-1})}clear_dapai(){n(".pai",this._node.dapai).removeClass("blink"),h("dapai")}set_timer(t,e=0,i){delete this._default_reply;let n=Date.now()+1e3*(t+e);this._timer_id&&clearInterval(this._timer_id),this._timer_id=setInterval((()=>{if(n<=Date.now())return void this.callback(this._default_reply);let s=Math.ceil((n-Date.now())/1e3);(s<=t||s<=e)&&s!=this._node.timer.text()&&(this.sound_on&&i&&s<=5&&(i.currentTime=0,i.play()),this._node.timer.text(s))}),200)}show_timer(){o(this._node.timer.width(n(this._node.dapai).width()+20))}clear_timer(){this._timer_id=clearInterval(this._timer_id),a(this._node.timer.text(""))}action(t,e){let i,n;t.timer&&([i,n]=t.timer);let s=!(t.kaiju||t.hule||t.pingju)&&this._audio.beep;i&&this.set_timer(i,n,s),super.action(t,e)}action_kaiju(t){this._view||this.callback(),n(".kaiju",this._node.root).off("click").on("click.kaiju",(()=>this.callback())),setTimeout((()=>{l(n(".kaiju",this._node.root),"kaiju",{touch:!1})}),800)}action_qipai(t){this.callback()}action_zimo(t,e){if(t.l!=this._menfeng)return this.callback();this.allow_hule(this.shoupai,null,e)&&this.set_button("zimo",(()=>this.callback({hule:"-"}))),this.allow_pingju(this.shoupai)&&this.set_button("pingju",(()=>this.callback({daopai:"-"})));let i=this.get_gang_mianzi(this.shoupai);if(1==i.length?this.set_button("gang",(()=>this.callback({gang:i[0]}))):i.length>1&&this.set_button("gang",(()=>this.select_mianzi(i))),this.shoupai.lizhi)return void this.show_button((()=>this.callback({dapai:t.p+"_"})));let n=this.allow_lizhi(this.shoupai);n.length&&this.set_button("lizhi",(()=>{this.clear_handler(),this.select_dapai(n)})),this.show_button((()=>this.select_dapai()))}action_dapai(t){if(this.allow_no_daopai(this.shoupai)&&this.set_button("daopai",(()=>this.callback())),t.l==this._menfeng)return this._show_button?void setTimeout((()=>{this.show_button((()=>this.callback({daopai:"-"})))}),500):this.callback();let e=["","+","=","-"][(4+this._model.lunban-this._menfeng)%4],i=t.p+e;this.allow_hule(this.shoupai,i)&&this.set_button("rong",(()=>this.callback({hule:"-"})));let n=this.get_gang_mianzi(this.shoupai,i);1==n.length&&this.set_button("gang",(()=>this.callback({fulou:n[0]})));let a=this.get_peng_mianzi(this.shoupai,i);1==a.length?this.set_button("peng",(()=>this.callback({fulou:a[0]}))):a.length>1&&this.set_button("peng",(()=>this.select_mianzi(a)));let o=this.get_chi_mianzi(this.shoupai,i);1==o.length?this.set_button("chi",(()=>this.callback({fulou:o[0]}))):o.length>1&&this.set_button("chi",(()=>this.select_mianzi(o))),this.show_button((()=>{0==this._model.shan.paishu&&0==s.Util.xiangting(this.shoupai)?this.callback({daopai:"-"}):this.callback()}))}action_fulou(t){return t.l!=this._menfeng||t.m.match(/^[mpsz]\d{4}/)?this.callback():void this.show_button((()=>this.select_dapai()))}action_gang(t){if(t.l==this._menfeng)return this.callback();if(t.m.match(/^[mpsz]\d{4}$/))return this.callback();let e=["","+","=","-"][(4+this._model.lunban-this._menfeng)%4],i=t.m[0]+t.m.slice(-1)+e;this.allow_hule(this.shoupai,i,!0)&&this.set_button("rong",(()=>this.callback({hule:"-"}))),this.show_button((()=>this.callback()))}action_hule(){n(".hule-dialog",this._node.root).off("click").on("click.dialog",(()=>this.callback())),setTimeout((()=>{l(n(".hule-dialog",this._node.root),"dialog",{touch:!1})}),800)}action_pingju(){this.action_hule()}action_jieju(t){n(".summary",this._node.root).off("click").on("click.summary",(()=>this.callback())),setTimeout((()=>{l(n(".summary",this._node.root),"summary",{touch:!1})}),800)}}},4864:(t,e,i)=>{"use strict";const n=i(4692);t.exports={scale:function(t,e){let i=n("body").height(),s=t.height();if(s>i){let a=i/s,o=(i-s)/2;t.css("transform",`translate(0px, ${o}px) scale(${a})`),n(window).scrollTop(e.height())}else t.css("transform","")}}},9893:t=>{"use strict";let e=0,i=0;const n={};function s(t){"."!=t[0]&&(t="."+t),n[t]&&(n[t].removeAttr("tabindex role").off(t),$(window).off(t),delete n[t],e&&console.log("OFF",t))}t.exports={setSelector:function(t,a,o={}){s(a);let r={confirm:"Enter",prev:"ArrowLeft",next:"ArrowRight",tabindex:0,focus:0,touch:!0};Object.assign(r,o);const l=++i;"."!=a[0]&&(a="."+a),n[a]=t;let h=null,u=t.length;function p(t){if(r.touch)return $(t.target).off("touchstart"+a).trigger("focus"),!1;$(t.target).trigger("focus")}return t.attr("tabindex",r.tabindex).attr("role","button").on("touchstart"+a,p).on("focus"+a,(e=>{h=t.index($(e.target))})).on("blur"+a,(t=>{h=null,$(t.target).on("touchstart"+a,p)})).on("mouseover"+a,(t=>$(t.target).trigger("focus"))).on("mouseout"+a,(t=>$(t.target).trigger("blur"))),r.confirm&&$(window).on("keyup"+a,(i=>{if(e&&console.log(l,i.type+a,i.key,h),i.key==r.confirm&&null!=h)return t.eq(h).trigger("click"),!1})),(r.prev||prev.next)&&$(window).on("keydown"+a,(i=>(e&&console.log(l,i.type+a,i.key,h),i.key==r.prev?(h=null==h?u-1:h<=0?0:h-1,t.eq(h).trigger("touchstart"),!1):i.key==r.next?(h=null==h?0:h>=u-1?u-1:h+1,t.eq(h).trigger("touchstart"),!1):void 0))),null!=r.focus&&t.eq(r.focus).trigger("touchstart"),e&&console.log("ON",l,a,$._data(window).events),t},clearSelector:s}},5644:t=>{"use strict";t.exports=class{constructor(t,e,i){this._node={baopai:$(".baopai",t),fubaopai:$(".fubaopai",t),paishu:$(".paishu",t)},this._pai=e,this._shan=i}redraw(){let t=this._shan.baopai;this._node.baopai.attr("aria-label","ドラ"),this._node.baopai.empty();for(let e=0;e<5;e++)this._node.baopai.append(this._pai(t[e]||"_"));let e=this._shan.fubaopai||[];this._node.fubaopai.attr("aria-label","裏ドラ"),this._node.fubaopai.empty();for(let t=0;t<5;t++)this._node.fubaopai.append(this._pai(e[t]||"_"));return this._node.paishu.text(this._shan.paishu),this}update(){return this._node.paishu.text(this._shan.paishu),this}}},4761:(t,e,i)=>{"use strict";const n=i(4692),s=i(4800);t.exports=class{constructor(t,e,i,a){this._node={root:t,bingpai:n(".bingpai",t),fulou:n(".fulou",t)},this._pai=e,this._mianzi=s(e),this._shoupai=i,this._open=a}redraw(t){null!=t&&(this._open=t),this._node.bingpai.attr("aria-label","手牌"),this._node.bingpai.empty();let e=this._shoupai._zimo,i=this._shoupai._bingpai._+("_"==e?-1:0);for(let t=0;t<i;t++)this._node.bingpai.append(this._pai("_"));for(let t of["m","p","s","z"]){let n=this._shoupai._bingpai[t],s=n[0];for(let a=1;a<n.length;a++){i=n[a],t+a==e?i--:5==a&&t+0==e&&(i--,s--);for(let e=0;e<i;e++){let i=5==a&&s>e?t+0:t+a;this._node.bingpai.append(this._open?this._pai(i):this._pai("_"))}}}e&&e.length<=2&&this._node.bingpai.append(n('<span class="zimo">').append(this._open?this._pai(e):this._pai("_"))),this._node.fulou.empty();for(let t of this._shoupai._fulou)this._node.fulou.append(this._mianzi(t));return this}adjust(){let t=this._node.root.width(),e=this._node.bingpai.width(),i=this._node.fulou.width();if(i<t){let n=e+i-t;n>0?this._node.bingpai.css("margin-left",-n+"px"):this._node.bingpai.css("margin-left","")}else this._node.bingpai.css("margin-left","");return this}dapai(t){let e=n(".pai.dapai",this._node.bingpai);return e.length||"_"==t[2]&&(e=n(".zimo .pai",this._node.bingpai)),e.length||(this._open?e=n(`.pai[data-pai="${t.slice(0,2)}"]`,this._node.bingpai).eq(0):(e=n(".pai",this._node.bingpai),e=e.eq(Math.random()*(e.length-1)|0))),e.addClass("deleted"),this}}},4106:(t,e,i)=>{"use strict";const n=i(4692);function s(t,e,i){t||(t={n_game:0,n_rank:[0,0,0,0],sum_point:0,n_ju:0,n_hule:0,n_baojia:0,n_lizhi:0,n_fulou:0,sum_defen:0});for(let n of e.log){t.n_ju++;let s=(i+4-e.qijia+4-n[0].qipai.jushu)%4,a=n.find((t=>t.hule&&t.hule.l==s));a&&(t.n_hule++,t.sum_defen+=+a.hule.defen),n.find((t=>t.hule&&t.hule.baojia==s))&&t.n_baojia++,n.find((t=>t.dapai&&t.dapai.l==s&&"*"==t.dapai.p.slice(-1)))&&t.n_lizhi++,n.find((t=>t.fulou&&t.fulou.l==s))&&t.n_fulou++}return t.n_game++,t.n_rank[e.rank[i]-1]++,t.sum_point+=+e.point[i],t}function a(t,e,i){let n=t.toFixed(e);return 1==i?n.replace(/^0\./,"."):2==i&&t>0?"+"+n:n}t.exports=class{constructor(t,e,i){this._root=t,this._tr=n("tbody tr",t).eq(0);let{title:o,player:r}=function(t){let e=t[0].title.replace(/\n.*$/,""),i={};for(let n of t){n.title.replace(/\n.*$/,"")!=e&&(e="");for(let t=0;t<4;t++){let e=n.player[t].replace(/\n.*$/,"");i[e]=s(i[e],n,t)}}return{title:e,player:i}}(e);this._table=function(t){let e=[];for(let i of Object.keys(t)){let n=t[i];e.push([i,n.n_game,a(n.sum_point,1,2),a((n.n_rank[0]+2*n.n_rank[1]+3*n.n_rank[2]+4*n.n_rank[3])/n.n_game,2),a(n.n_rank[0]/n.n_game,3,1),a((n.n_rank[0]+n.n_rank[1])/n.n_game,3,1),a(n.n_rank[3]/n.n_game,3,1),a(n.n_hule/n.n_ju,3,1),a(n.n_baojia/n.n_ju,3,1),a(n.n_lizhi/n.n_ju,3,1),a(n.n_fulou/n.n_ju,3,1),a(n.sum_defen/(n.n_hule||1),0,0)])}return e}(r),n('input[name="cut-off"]',this._root).prop("checked",!0);let l=Math.max(...this._table.map((t=>t[1])))/5|0;n('input[name="n_game"]',this._root).val(l||""),n(".button input",this._root).on("change",(()=>this.show())),n(".title",this._root).text(o),n(".file",this._root).on("click",(()=>{n(".stat",this._root).scrollLeft(0),history.replaceState("","",location.href.replace(/#.*$/,"")),i()}));for(let t=1;t<this._table[0].length;t++)n("th",this._root).eq(t).on("click",(()=>this.sort(t).show()));this.sort(2).sort(1).show()}sort(t){return this._order=Math.abs(this._order)==t?-this._order:-t,n("th",this._root).removeClass("asc").removeClass("desc").eq(t).addClass(this._order>0?"asc":"desc"),this._table=this._table.sort(((e,i)=>this._order>0?e[t]-i[t]:i[t]-e[t])),this}show(){let t=n('input[name="cut-off"]',this._root).prop("checked")&&+n('input[name="n_game"]',this._root).val()||0;const e=n("tbody",this._root);e.empty();for(let i of this._table.filter((e=>e[1]>t))){let t=this._tr.clone();for(let e=0;e<i.length;e++)n("td",t).eq(e).text(i[e]);e.append(t)}}}},5910:(t,e,i)=>{"use strict";const n=i(4692),{hide:s,show:a,fadeIn:o,fadeOut:r}=(i(8739),i(8521));t.exports=function(t,e,i){let s=n(".r_player .player",t);for(let t=0;t<4;t++){let n=(i+t)%4;s.eq(t).text(e.player[n].replace(/\n.*$/,""))}let a=n(".r_diff",t).eq(0).clone(),o=n(".body",t).empty();for(let t of e.log){if(0==t.length)continue;let s=t[0].qipai,r=[],l=[0,0,0,0],h=null;for(let e of t)null!=h&&(e.hule||e.pingju&&e.pingju.name.match(/^三家和/)?h=null:l[h]=1),e.dapai&&"*"==e.dapai.p.slice(-1)&&(h=e.dapai.l),(e.hule||e.pingju)&&r.push(e);a=a.clone(),n(".jushu",a).text(["東","南","西","北"][s.zhuangfeng]+["一","二","三","四"][s.jushu]+"局"),n(".changbang",a).text(`${s.changbang}本場`),n(".last",a).text(0==r.length?"−":r[0].pingju?"流局":null==r[0].hule.baojia?"ツモ":"ロン"),n(".back",a).removeClass("zhuangjia"),n(".diff",a).removeClass("baojia hule").text(""),n(".lizhi",a).text("");for(let t=0;t<4;t++){let o=(i+4-e.qijia+4-s.jushu+t)%4;if(0==o&&n(".back",a).eq(t).addClass("zhuangjia"),0==r.length)continue;l[o]&&n(".lizhi",a).eq(t).text("*");let h=0;for(let e of r)e.hule&&(h+=e.hule.fenpei[o]),e.pingju&&(h+=e.pingju.fenpei[o]),e.hule&&(e.hule.baojia==o&&n(".diff",a).eq(t).addClass("baojia"),e.hule.l==o&&n(".diff",a).eq(t).addClass("hule"));h=h>0?"+"+h:h<0?""+h:"",h=h.replace(/(\d)(\d{3})$/,"$1,$2"),n(".diff",a).eq(t).text(h)}o.append(a)}let r=n(".r_defen .defen",t);for(let t=0;t<4;t++){r.eq(t).removeClass("plus minus");let n=(i+t)%4;r.eq(t).text((""+(e.defen[n]??"")).replace(/(\d)(\d{3})$/,"$1,$2")),1==e.rank[n]&&r.eq(t).addClass("plus"),e.defen[n]<0&&r.eq(t).addClass("minus")}let l=n(".r_point .point",t);for(let t=0;t<4;t++){l.eq(t).removeClass("plus minus");let n=(i+t)%4;l.eq(t).text((e.point[n]>0?"+":"")+(e.point[n]??"−")),e.point[n]>0&&l.eq(t).addClass("plus"),e.point[n]<0&&l.eq(t).addClass("minus")}return t}},9983:(t,e,i)=>{var n,s,a;
/*!
 * jQuery UI :data 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */!function(){"use strict";s=[i(4692),i(6883)],void 0===(a="function"==typeof(n=function(t){return t.extend(t.expr.pseudos,{data:t.expr.createPseudo?t.expr.createPseudo((function(e){return function(i){return!!t.data(i,e)}})):function(e,i,n){return!!t.data(e,n[3])}})})?n.apply(e,s):n)||(t.exports=a)}()},8045:(t,e,i)=>{var n,s,a;!function(){"use strict";s=[i(4692),i(6883)],void 0===(a="function"==typeof(n=function(t){return t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase())})?n.apply(e,s):n)||(t.exports=a)}()},2299:(t,e,i)=>{var n,s,a;
/*!
 * jQuery UI Scroll Parent 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */!function(){"use strict";s=[i(4692),i(6883)],void 0===(a="function"==typeof(n=function(t){return t.fn.scrollParent=function(e){var i=this.css("position"),n="absolute"===i,s=e?/(auto|scroll|hidden)/:/(auto|scroll)/,a=this.parents().filter((function(){var e=t(this);return(!n||"static"!==e.css("position"))&&s.test(e.css("overflow")+e.css("overflow-y")+e.css("overflow-x"))})).eq(0);return"fixed"!==i&&a.length?a:t(this[0].ownerDocument||document)}})?n.apply(e,s):n)||(t.exports=a)}()},6883:(t,e,i)=>{var n,s,a;!function(){"use strict";s=[i(4692)],void 0===(a="function"==typeof(n=function(t){return t.ui=t.ui||{},t.ui.version="1.13.2"})?n.apply(e,s):n)||(t.exports=a)}()},9139:(t,e,i)=>{var n,s,a;
/*!
 * jQuery UI Widget 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */!function(){"use strict";s=[i(4692),i(6883)],n=function(t){var e=0,i=Array.prototype.hasOwnProperty,n=Array.prototype.slice;return t.cleanData=function(e){return function(i){var n,s,a;for(a=0;null!=(s=i[a]);a++)(n=t._data(s,"events"))&&n.remove&&t(s).triggerHandler("remove");e(i)}}(t.cleanData),t.widget=function(e,i,n){var s,a,o,r={},l=e.split(".")[0],h=l+"-"+(e=e.split(".")[1]);return n||(n=i,i=t.Widget),Array.isArray(n)&&(n=t.extend.apply(null,[{}].concat(n))),t.expr.pseudos[h.toLowerCase()]=function(e){return!!t.data(e,h)},t[l]=t[l]||{},s=t[l][e],a=t[l][e]=function(t,e){if(!this||!this._createWidget)return new a(t,e);arguments.length&&this._createWidget(t,e)},t.extend(a,s,{version:n.version,_proto:t.extend({},n),_childConstructors:[]}),(o=new i).options=t.widget.extend({},o.options),t.each(n,(function(t,e){r[t]="function"==typeof e?function(){function n(){return i.prototype[t].apply(this,arguments)}function s(e){return i.prototype[t].apply(this,e)}return function(){var t,i=this._super,a=this._superApply;return this._super=n,this._superApply=s,t=e.apply(this,arguments),this._super=i,this._superApply=a,t}}():e})),a.prototype=t.widget.extend(o,{widgetEventPrefix:s&&o.widgetEventPrefix||e},r,{constructor:a,namespace:l,widgetName:e,widgetFullName:h}),s?(t.each(s._childConstructors,(function(e,i){var n=i.prototype;t.widget(n.namespace+"."+n.widgetName,a,i._proto)})),delete s._childConstructors):i._childConstructors.push(a),t.widget.bridge(e,a),a},t.widget.extend=function(e){for(var s,a,o=n.call(arguments,1),r=0,l=o.length;r<l;r++)for(s in o[r])a=o[r][s],i.call(o[r],s)&&void 0!==a&&(t.isPlainObject(a)?e[s]=t.isPlainObject(e[s])?t.widget.extend({},e[s],a):t.widget.extend({},a):e[s]=a);return e},t.widget.bridge=function(e,i){var s=i.prototype.widgetFullName||e;t.fn[e]=function(a){var o="string"==typeof a,r=n.call(arguments,1),l=this;return o?this.length||"instance"!==a?this.each((function(){var i,n=t.data(this,s);return"instance"===a?(l=n,!1):n?"function"!=typeof n[a]||"_"===a.charAt(0)?t.error("no such method '"+a+"' for "+e+" widget instance"):(i=n[a].apply(n,r))!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0:t.error("cannot call methods on "+e+" prior to initialization; attempted to call method '"+a+"'")})):l=void 0:(r.length&&(a=t.widget.extend.apply(null,[a].concat(r))),this.each((function(){var e=t.data(this,s);e?(e.option(a||{}),e._init&&e._init()):t.data(this,s,new i(a,this))}))),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(i,n){n=t(n||this.defaultElement||this)[0],this.element=t(n),this.uuid=e++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=t(),this.hoverable=t(),this.focusable=t(),this.classesElementLookup={},n!==this&&(t.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===n&&this.destroy()}}),this.document=t(n.style?n.ownerDocument:n.document||n),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this.options=t.widget.extend({},this.options,this._getCreateOptions(),i),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){var e=this;this._destroy(),t.each(this.classesElementLookup,(function(t,i){e._removeClass(i,t)})),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:t.noop,widget:function(){return this.element},option:function(e,i){var n,s,a,o=e;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof e)if(o={},n=e.split("."),e=n.shift(),n.length){for(s=o[e]=t.widget.extend({},this.options[e]),a=0;a<n.length-1;a++)s[n[a]]=s[n[a]]||{},s=s[n[a]];if(e=n.pop(),1===arguments.length)return void 0===s[e]?null:s[e];s[e]=i}else{if(1===arguments.length)return void 0===this.options[e]?null:this.options[e];o[e]=i}return this._setOptions(o),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(e){var i,n,s;for(i in e)s=this.classesElementLookup[i],e[i]!==this.options.classes[i]&&s&&s.length&&(n=t(s.get()),this._removeClass(s,i),n.addClass(this._classes({element:n,keys:i,classes:e,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(e){var i=[],n=this;function s(){var i=[];e.element.each((function(e,s){t.map(n.classesElementLookup,(function(t){return t})).some((function(t){return t.is(s)}))||i.push(s)})),n._on(t(i),{remove:"_untrackClassesElement"})}function a(a,o){var r,l;for(l=0;l<a.length;l++)r=n.classesElementLookup[a[l]]||t(),e.add?(s(),r=t(t.uniqueSort(r.get().concat(e.element.get())))):r=t(r.not(e.element).get()),n.classesElementLookup[a[l]]=r,i.push(a[l]),o&&e.classes[a[l]]&&i.push(e.classes[a[l]])}return(e=t.extend({element:this.element,classes:this.options.classes||{}},e)).keys&&a(e.keys.match(/\S+/g)||[],!0),e.extra&&a(e.extra.match(/\S+/g)||[]),i.join(" ")},_untrackClassesElement:function(e){var i=this;t.each(i.classesElementLookup,(function(n,s){-1!==t.inArray(e.target,s)&&(i.classesElementLookup[n]=t(s.not(e.target).get()))})),this._off(t(e.target))},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,n){n="boolean"==typeof n?n:i;var s="string"==typeof t||null===t,a={extra:s?e:i,keys:s?t:e,element:s?this.element:t,add:n};return a.element.toggleClass(this._classes(a),n),this},_on:function(e,i,n){var s,a=this;"boolean"!=typeof e&&(n=i,i=e,e=!1),n?(i=s=t(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,s=this.widget()),t.each(n,(function(n,o){function r(){if(e||!0!==a.options.disabled&&!t(this).hasClass("ui-state-disabled"))return("string"==typeof o?a[o]:o).apply(a,arguments)}"string"!=typeof o&&(r.guid=o.guid=o.guid||r.guid||t.guid++);var l=n.match(/^([\w:-]*)\s*(.*)$/),h=l[1]+a.eventNamespace,u=l[2];u?s.on(h,u,r):i.on(h,r)}))},_off:function(e,i){i=(i||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.off(i),this.bindings=t(this.bindings.not(e).get()),this.focusable=t(this.focusable.not(e).get()),this.hoverable=t(this.hoverable.not(e).get())},_delay:function(t,e){function i(){return("string"==typeof t?n[t]:t).apply(n,arguments)}var n=this;return setTimeout(i,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){this._addClass(t(e.currentTarget),null,"ui-state-hover")},mouseleave:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){this._addClass(t(e.currentTarget),null,"ui-state-focus")},focusout:function(e){this._removeClass(t(e.currentTarget),null,"ui-state-focus")}})},_trigger:function(e,i,n){var s,a,o=this.options[e];if(n=n||{},(i=t.Event(i)).type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(s in a)s in i||(i[s]=a[s]);return this.element.trigger(i,n),!("function"==typeof o&&!1===o.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},(function(e,i){t.Widget.prototype["_"+e]=function(n,s,a){var o;"string"==typeof s&&(s={effect:s});var r=s?!0===s||"number"==typeof s?i:s.effect||i:e;"number"==typeof(s=s||{})?s={duration:s}:!0===s&&(s={}),o=!t.isEmptyObject(s),s.complete=a,s.delay&&n.delay(s.delay),o&&t.effects&&t.effects.effect[r]?n[e](s):r!==e&&n[r]?n[r](s.duration,s.easing,a):n.queue((function(i){t(this)[e](),a&&a.call(n[0]),i()}))}})),t.widget},void 0===(a="function"==typeof n?n.apply(e,s):n)||(t.exports=a)}()},3662:(t,e,i)=>{var n,s,a;
/*!
 * jQuery UI Mouse 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */!function(){"use strict";s=[i(4692),i(8045),i(6883),i(9139)],void 0===(a="function"==typeof(n=function(t){var e=!1;return t(document).on("mouseup",(function(){e=!1})),t.widget("ui.mouse",{version:"1.13.2",options:{cancel:"input, textarea, button, select, option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,(function(t){return e._mouseDown(t)})).on("click."+this.widgetName,(function(i){if(!0===t.data(i.target,e.widgetName+".preventClickEvent"))return t.removeData(i.target,e.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1})),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(i){if(!e){this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(i),this._mouseDownEvent=i;var n=this,s=1===i.which,a=!("string"!=typeof this.options.cancel||!i.target.nodeName)&&t(i.target).closest(this.options.cancel).length;return!(s&&!a&&this._mouseCapture(i))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout((function(){n.mouseDelayMet=!0}),this.options.delay)),this._mouseDistanceMet(i)&&this._mouseDelayMet(i)&&(this._mouseStarted=!1!==this._mouseStart(i),!this._mouseStarted)?(i.preventDefault(),!0):(!0===t.data(i.target,this.widgetName+".preventClickEvent")&&t.removeData(i.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return n._mouseMove(t)},this._mouseUpDelegate=function(t){return n._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),i.preventDefault(),e=!0,!0))}},_mouseMove:function(e){if(this._mouseMoved){if(t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button)return this._mouseUp(e);if(!e.which)if(e.originalEvent.altKey||e.originalEvent.ctrlKey||e.originalEvent.metaKey||e.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(e)}return(e.which||e.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,e),this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(i){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,i.target===this._mouseDownEvent.target&&t.data(i.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(i)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=!1,e=!1,i.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})?n.apply(e,s):n)||(t.exports=a)}()},5285:(t,e,i)=>{var n,s,a;
/*!
 * jQuery UI Sortable 1.13.2
 * http://jqueryui.com
 *
 * Copyright jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 */!function(){"use strict";s=[i(4692),i(3662),i(9983),i(8045),i(2299),i(6883),i(9139)],n=function(t){return t.widget("ui.sortable",t.ui.mouse,{version:"1.13.2",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return t>=e&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache={},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var e=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),t.each(this.items,(function(){e._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")}))},_destroy:function(){this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(e,i){var n=null,s=!1,a=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(e),t(e.target).parents().each((function(){if(t.data(this,a.widgetName+"-item")===a)return n=t(this),!1})),t.data(e.target,a.widgetName+"-item")===a&&(n=t(e.target)),!!n&&(!(this.options.handle&&!i&&(t(this.options.handle,n).find("*").addBack().each((function(){this===e.target&&(s=!0)})),!s))&&(this.currentItem=n,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(e,i,n){var s,a,o=this.options;if(this.currentContainer=this,this.refreshPositions(),this.appendTo=t("parent"!==o.appendTo?o.appendTo:this.currentItem.parent()),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),t.extend(this.offset,{parent:this._getParentOffset()}),o.containment&&this._setContainment(),o.cursor&&"auto"!==o.cursor&&(a=this.document.find("body"),this.storedCursor=a.css("cursor"),a.css("cursor",o.cursor),this.storedStylesheet=t("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(a)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!n)for(s=this.containers.length-1;s>=0;s--)this.containers[s]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(e),!0},_scroll:function(t){var e=this.options,i=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-t.pageY<e.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+e.scrollSpeed:t.pageY-this.overflowOffset.top<e.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-e.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<e.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+e.scrollSpeed:t.pageX-this.overflowOffset.left<e.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-e.scrollSpeed)):(t.pageY-this.document.scrollTop()<e.scrollSensitivity?i=this.document.scrollTop(this.document.scrollTop()-e.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<e.scrollSensitivity&&(i=this.document.scrollTop(this.document.scrollTop()+e.scrollSpeed)),t.pageX-this.document.scrollLeft()<e.scrollSensitivity?i=this.document.scrollLeft(this.document.scrollLeft()-e.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<e.scrollSensitivity&&(i=this.document.scrollLeft(this.document.scrollLeft()+e.scrollSpeed))),i},_mouseDrag:function(e){var i,n,s,a,o=this.options;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),o.scroll&&!1!==this._scroll(e)&&(this._refreshItemPositions(!0),t.ui.ddmanager&&!o.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.dragDirection={vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},i=this.items.length-1;i>=0;i--)if(s=(n=this.items[i]).item[0],(a=this._intersectsWithPointer(n))&&n.instance===this.currentContainer&&!(s===this.currentItem[0]||this.placeholder[1===a?"next":"prev"]()[0]===s||t.contains(this.placeholder[0],s)||"semi-dynamic"===this.options.type&&t.contains(this.element[0],s))){if(this.direction=1===a?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(n))break;this._rearrange(e,n),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var n=this,s=this.placeholder.offset(),a=this.options.axis,o={};a&&"x"!==a||(o.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollLeft)),a&&"y"!==a||(o.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(o,parseInt(this.options.revert,10)||500,(function(){n._clear(e)}))}else this._clear(e,i);return!1}},cancel:function(){if(this.dragging){this._mouseUp(new t.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},t(i).each((function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);i&&n.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))})),!n.length&&e.key&&n.push(e.key+"="),n.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),n=[];return e=e||{},i.each((function(){n.push(t(e.item||this).attr(e.attribute||"id")||"")})),n},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,n=this.positionAbs.top,s=n+this.helperProportions.height,a=t.left,o=a+t.width,r=t.top,l=r+t.height,h=this.offset.click.top,u=this.offset.click.left,p="x"===this.options.axis||n+h>r&&n+h<l,c="y"===this.options.axis||e+u>a&&e+u<o,f=p&&c;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?f:a<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<o&&r<n+this.helperProportions.height/2&&s-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e,i,n="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),s="y"===this.options.axis||this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!(!n||!s)&&(e=this.dragDirection.vertical,i=this.dragDirection.horizontal,this.floating?"right"===i||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),i=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),n=this.dragDirection.vertical,s=this.dragDirection.horizontal;return this.floating&&s?"right"===s&&i||"left"===s&&!i:n&&("down"===n&&e||"up"===n&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i,n,s,a,o=[],r=[],l=this._connectWith();if(l&&e)for(i=l.length-1;i>=0;i--)for(n=(s=t(l[i],this.document[0])).length-1;n>=0;n--)(a=t.data(s[n],this.widgetFullName))&&a!==this&&!a.options.disabled&&r.push(["function"==typeof a.options.items?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a]);function h(){o.push(this)}for(r.push(["function"==typeof this.options.items?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),i=r.length-1;i>=0;i--)r[i][0].each(h);return t(o)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,(function(t){for(var i=0;i<e.length;i++)if(e[i]===t.item[0])return!1;return!0}))},_refreshItems:function(e){this.items=[],this.containers=[this];var i,n,s,a,o,r,l,h,u=this.items,p=[["function"==typeof this.options.items?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],c=this._connectWith();if(c&&this.ready)for(i=c.length-1;i>=0;i--)for(n=(s=t(c[i],this.document[0])).length-1;n>=0;n--)(a=t.data(s[n],this.widgetFullName))&&a!==this&&!a.options.disabled&&(p.push(["function"==typeof a.options.items?a.options.items.call(a.element[0],e,{item:this.currentItem}):t(a.options.items,a.element),a]),this.containers.push(a));for(i=p.length-1;i>=0;i--)for(o=p[i][1],n=0,h=(r=p[i][0]).length;n<h;n++)(l=t(r[n])).data(this.widgetName+"-item",o),u.push({item:l,instance:o,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(e){var i,n,s,a;for(i=this.items.length-1;i>=0;i--)n=this.items[i],this.currentContainer&&n.instance!==this.currentContainer&&n.item[0]!==this.currentItem[0]||(s=this.options.toleranceElement?t(this.options.toleranceElement,n.item):n.item,e||(n.width=s.outerWidth(),n.height=s.outerHeight()),a=s.offset(),n.left=a.left,n.top=a.top)},refreshPositions:function(t){var e,i;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(t),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;e>=0;e--)i=this.containers[e].element.offset(),this.containers[e].containerCache.left=i.left,this.containers[e].containerCache.top=i.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(e){var i,n,s=(e=e||this).options;s.placeholder&&s.placeholder.constructor!==String||(i=s.placeholder,n=e.currentItem[0].nodeName.toLowerCase(),s.placeholder={element:function(){var s=t("<"+n+">",e.document[0]);return e._addClass(s,"ui-sortable-placeholder",i||e.currentItem[0].className)._removeClass(s,"ui-sortable-helper"),"tbody"===n?e._createTrPlaceholder(e.currentItem.find("tr").eq(0),t("<tr>",e.document[0]).appendTo(s)):"tr"===n?e._createTrPlaceholder(e.currentItem,s):"img"===n&&s.attr("src",e.currentItem.attr("src")),i||s.css("visibility","hidden"),s},update:function(t,a){i&&!s.forcePlaceholderSize||(a.height()&&(!s.forcePlaceholderSize||"tbody"!==n&&"tr"!==n)||a.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),a.width()||a.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(s.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),s.placeholder.update(e,e.placeholder)},_createTrPlaceholder:function(e,i){var n=this;e.children().each((function(){t("<td>&#160;</td>",n.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)}))},_contactContainers:function(e){var i,n,s,a,o,r,l,h,u,p,c=null,f=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(c&&t.contains(this.containers[i].element[0],c.element[0]))continue;c=this.containers[i],f=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(c)if(1===this.containers.length)this.containers[f].containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1);else{for(s=1e4,a=null,o=(u=c.floating||this._isFloating(this.currentItem))?"left":"top",r=u?"width":"height",p=u?"pageX":"pageY",n=this.items.length-1;n>=0;n--)t.contains(this.containers[f].element[0],this.items[n].item[0])&&this.items[n].item[0]!==this.currentItem[0]&&(l=this.items[n].item.offset()[o],h=!1,e[p]-l>this.items[n][r]/2&&(h=!0),Math.abs(e[p]-l)<s&&(s=Math.abs(e[p]-l),a=this.items[n],this.direction=h?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[f])return void(this.currentContainer.containerCache.over||(this.containers[f]._trigger("over",e,this._uiHash()),this.currentContainer.containerCache.over=1));a?this._rearrange(e,a,null,!0):this._rearrange(e,null,this.containers[f].element,!0),this._trigger("change",e,this._uiHash()),this.containers[f]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[f],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[f]._trigger("over",e,this._uiHash(this)),this.containers[f].containerCache.over=1}},_createHelper:function(e){var i=this.options,n="function"==typeof i.helper?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"===i.helper?this.currentItem.clone():this.currentItem;return n.parents("body").length||this.appendTo[0].appendChild(n[0]),n[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),n[0].style.width&&!i.forceHelperSize||n.width(this.currentItem.width()),n[0].style.height&&!i.forceHelperSize||n.height(this.currentItem.height()),n},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),Array.isArray(t)&&(t={left:+t[0],top:+t[1]||0}),"left"in t&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,i,n,s=this.options;"parent"===s.containment&&(s.containment=this.helper[0].parentNode),"document"!==s.containment&&"window"!==s.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===s.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===s.containment?this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(s.containment)||(e=t(s.containment)[0],i=t(s.containment).offset(),n="hidden"!==t(e).css("overflow"),this.containment=[i.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,i.left+(n?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(n?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,i){i||(i=this.position);var n="absolute"===e?1:-1,s="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,a=/(html|body)/i.test(s[0].tagName);return{top:i.top+this.offset.relative.top*n+this.offset.parent.top*n-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():a?0:s.scrollTop())*n,left:i.left+this.offset.relative.left*n+this.offset.parent.left*n-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():a?0:s.scrollLeft())*n}},_generatePosition:function(e){var i,n,s=this.options,a=e.pageX,o=e.pageY,r="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,l=/(html|body)/i.test(r[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(a=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(o=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(a=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(o=this.containment[3]+this.offset.click.top)),s.grid&&(i=this.originalPageY+Math.round((o-this.originalPageY)/s.grid[1])*s.grid[1],o=this.containment?i-this.offset.click.top>=this.containment[1]&&i-this.offset.click.top<=this.containment[3]?i:i-this.offset.click.top>=this.containment[1]?i-s.grid[1]:i+s.grid[1]:i,n=this.originalPageX+Math.round((a-this.originalPageX)/s.grid[0])*s.grid[0],a=this.containment?n-this.offset.click.left>=this.containment[0]&&n-this.offset.click.left<=this.containment[2]?n:n-this.offset.click.left>=this.containment[0]?n-s.grid[0]:n+s.grid[0]:n)),{top:o-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():l?0:r.scrollTop()),left:a-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():l?0:r.scrollLeft())}},_rearrange:function(t,e,i,n){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var s=this.counter;this._delay((function(){s===this.counter&&this.refreshPositions(!n)}))},_clear:function(t,e){this.reverting=!1;var i,n=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function s(t,e,i){return function(n){i._trigger(t,n,e._uiHash(e))}}for(this.fromOutside&&!e&&n.push((function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))})),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||n.push((function(t){this._trigger("update",t,this._uiHash())})),this!==this.currentContainer&&(e||(n.push((function(t){this._trigger("remove",t,this._uiHash())})),n.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),n.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),i=this.containers.length-1;i>=0;i--)e||n.push(s("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(n.push(s("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(i=0;i<n.length;i++)n[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===t.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}})},void 0===(a="function"==typeof n?n.apply(e,s):n)||(t.exports=a)}()},4692:function(t,e){var i;
/*!
 * jQuery JavaScript Library v3.7.1
 * https://jquery.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2023-08-28T13:37Z
 */!function(e,i){"use strict";"object"==typeof t.exports?t.exports=e.document?i(e,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return i(t)}:i(e)}("undefined"!=typeof window?window:this,(function(n,s){"use strict";var a=[],o=Object.getPrototypeOf,r=a.slice,l=a.flat?function(t){return a.flat.call(t)}:function(t){return a.concat.apply([],t)},h=a.push,u=a.indexOf,p={},c=p.toString,f=p.hasOwnProperty,d=f.toString,g=d.call(Object),_={},m=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType&&"function"!=typeof t.item},v=function(t){return null!=t&&t===t.window},y=n.document,b={type:!0,src:!0,nonce:!0,noModule:!0};function w(t,e,i){var n,s,a=(i=i||y).createElement("script");if(a.text=t,e)for(n in b)(s=e[n]||e.getAttribute&&e.getAttribute(n))&&a.setAttribute(n,s);i.head.appendChild(a).parentNode.removeChild(a)}function x(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?p[c.call(t)]||"object":typeof t}var z="3.7.1",k=/HTML$/i,j=function(t,e){return new j.fn.init(t,e)};function C(t){var e=!!t&&"length"in t&&t.length,i=x(t);return!m(t)&&!v(t)&&("array"===i||0===e||"number"==typeof e&&e>0&&e-1 in t)}function S(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}j.fn=j.prototype={jquery:z,constructor:j,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=j.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return j.each(this,t)},map:function(t){return this.pushStack(j.map(this,(function(e,i){return t.call(e,i,e)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(j.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(j.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,i=+t+(t<0?e:0);return this.pushStack(i>=0&&i<e?[this[i]]:[])},end:function(){return this.prevObject||this.constructor()},push:h,sort:a.sort,splice:a.splice},j.extend=j.fn.extend=function(){var t,e,i,n,s,a,o=arguments[0]||{},r=1,l=arguments.length,h=!1;for("boolean"==typeof o&&(h=o,o=arguments[r]||{},r++),"object"==typeof o||m(o)||(o={}),r===l&&(o=this,r--);r<l;r++)if(null!=(t=arguments[r]))for(e in t)n=t[e],"__proto__"!==e&&o!==n&&(h&&n&&(j.isPlainObject(n)||(s=Array.isArray(n)))?(i=o[e],a=s&&!Array.isArray(i)?[]:s||j.isPlainObject(i)?i:{},s=!1,o[e]=j.extend(h,a,n)):void 0!==n&&(o[e]=n));return o},j.extend({expando:"jQuery"+(z+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,i;return!(!t||"[object Object]"!==c.call(t))&&(!(e=o(t))||"function"==typeof(i=f.call(e,"constructor")&&e.constructor)&&d.call(i)===g)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,i){w(t,{nonce:e&&e.nonce},i)},each:function(t,e){var i,n=0;if(C(t))for(i=t.length;n<i&&!1!==e.call(t[n],n,t[n]);n++);else for(n in t)if(!1===e.call(t[n],n,t[n]))break;return t},text:function(t){var e,i="",n=0,s=t.nodeType;if(!s)for(;e=t[n++];)i+=j.text(e);return 1===s||11===s?t.textContent:9===s?t.documentElement.textContent:3===s||4===s?t.nodeValue:i},makeArray:function(t,e){var i=e||[];return null!=t&&(C(Object(t))?j.merge(i,"string"==typeof t?[t]:t):h.call(i,t)),i},inArray:function(t,e,i){return null==e?-1:u.call(e,t,i)},isXMLDoc:function(t){var e=t&&t.namespaceURI,i=t&&(t.ownerDocument||t).documentElement;return!k.test(e||i&&i.nodeName||"HTML")},merge:function(t,e){for(var i=+e.length,n=0,s=t.length;n<i;n++)t[s++]=e[n];return t.length=s,t},grep:function(t,e,i){for(var n=[],s=0,a=t.length,o=!i;s<a;s++)!e(t[s],s)!==o&&n.push(t[s]);return n},map:function(t,e,i){var n,s,a=0,o=[];if(C(t))for(n=t.length;a<n;a++)null!=(s=e(t[a],a,i))&&o.push(s);else for(a in t)null!=(s=e(t[a],a,i))&&o.push(s);return l(o)},guid:1,support:_}),"function"==typeof Symbol&&(j.fn[Symbol.iterator]=a[Symbol.iterator]),j.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){p["[object "+e+"]"]=e.toLowerCase()}));var q=a.pop,T=a.sort,$=a.splice,E="[\\x20\\t\\r\\n\\f]",P=new RegExp("^"+E+"+|((?:^|[^\\\\])(?:\\\\.)*)"+E+"+$","g");j.contains=function(t,e){var i=e&&e.parentNode;return t===i||!(!i||1!==i.nodeType||!(t.contains?t.contains(i):t.compareDocumentPosition&&16&t.compareDocumentPosition(i)))};var N=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function D(t,e){return e?"\0"===t?"�":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t}j.escapeSelector=function(t){return(t+"").replace(N,D)};var A=y,I=h;!function(){var t,e,i,s,o,l,h,p,c,d,g=I,m=j.expando,v=0,y=0,b=tt(),w=tt(),x=tt(),z=tt(),k=function(t,e){return t===e&&(o=!0),0},C="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",N="(?:\\\\[\\da-fA-F]{1,6}"+E+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",D="\\["+E+"*("+N+")(?:"+E+"*([*^$|!~]?=)"+E+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+N+"))|)"+E+"*\\]",O=":("+N+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+D+")*)|.*)\\)|)",M=new RegExp(E+"+","g"),H=new RegExp("^"+E+"*,"+E+"*"),L=new RegExp("^"+E+"*([>+~]|"+E+")"+E+"*"),U=new RegExp(E+"|>"),R=new RegExp(O),W=new RegExp("^"+N+"$"),F={ID:new RegExp("^#("+N+")"),CLASS:new RegExp("^\\.("+N+")"),TAG:new RegExp("^("+N+"|[*])"),ATTR:new RegExp("^"+D),PSEUDO:new RegExp("^"+O),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+E+"*(even|odd|(([+-]|)(\\d*)n|)"+E+"*(?:([+-]|)"+E+"*(\\d+)|))"+E+"*\\)|)","i"),bool:new RegExp("^(?:"+C+")$","i"),needsContext:new RegExp("^"+E+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+E+"*((?:-\\d)?\\d*)"+E+"*\\)|)(?=[^-]|$)","i")},B=/^(?:input|select|textarea|button)$/i,X=/^h\d$/i,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,G=/[+~]/,Y=new RegExp("\\\\[\\da-fA-F]{1,6}"+E+"?|\\\\([^\\r\\n\\f])","g"),V=function(t,e){var i="0x"+t.slice(1)-65536;return e||(i<0?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320))},Q=function(){lt()},K=ct((function(t){return!0===t.disabled&&S(t,"fieldset")}),{dir:"parentNode",next:"legend"});try{g.apply(a=r.call(A.childNodes),A.childNodes),a[A.childNodes.length].nodeType}catch(t){g={apply:function(t,e){I.apply(t,r.call(e))},call:function(t){I.apply(t,r.call(arguments,1))}}}function Z(t,e,i,n){var s,a,o,r,h,u,f,d=e&&e.ownerDocument,v=e?e.nodeType:9;if(i=i||[],"string"!=typeof t||!t||1!==v&&9!==v&&11!==v)return i;if(!n&&(lt(e),e=e||l,p)){if(11!==v&&(h=J.exec(t)))if(s=h[1]){if(9===v){if(!(o=e.getElementById(s)))return i;if(o.id===s)return g.call(i,o),i}else if(d&&(o=d.getElementById(s))&&Z.contains(e,o)&&o.id===s)return g.call(i,o),i}else{if(h[2])return g.apply(i,e.getElementsByTagName(t)),i;if((s=h[3])&&e.getElementsByClassName)return g.apply(i,e.getElementsByClassName(s)),i}if(!(z[t+" "]||c&&c.test(t))){if(f=t,d=e,1===v&&(U.test(t)||L.test(t))){for((d=G.test(t)&&rt(e.parentNode)||e)==e&&_.scope||((r=e.getAttribute("id"))?r=j.escapeSelector(r):e.setAttribute("id",r=m)),a=(u=ut(t)).length;a--;)u[a]=(r?"#"+r:":scope")+" "+pt(u[a]);f=u.join(",")}try{return g.apply(i,d.querySelectorAll(f)),i}catch(e){z(t,!0)}finally{r===m&&e.removeAttribute("id")}}}return vt(t.replace(P,"$1"),e,i,n)}function tt(){var t=[];return function i(n,s){return t.push(n+" ")>e.cacheLength&&delete i[t.shift()],i[n+" "]=s}}function et(t){return t[m]=!0,t}function it(t){var e=l.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function nt(t){return function(e){return S(e,"input")&&e.type===t}}function st(t){return function(e){return(S(e,"input")||S(e,"button"))&&e.type===t}}function at(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&K(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function ot(t){return et((function(e){return e=+e,et((function(i,n){for(var s,a=t([],i.length,e),o=a.length;o--;)i[s=a[o]]&&(i[s]=!(n[s]=i[s]))}))}))}function rt(t){return t&&void 0!==t.getElementsByTagName&&t}function lt(t){var i,n=t?t.ownerDocument||t:A;return n!=l&&9===n.nodeType&&n.documentElement?(h=(l=n).documentElement,p=!j.isXMLDoc(l),d=h.matches||h.webkitMatchesSelector||h.msMatchesSelector,h.msMatchesSelector&&A!=l&&(i=l.defaultView)&&i.top!==i&&i.addEventListener("unload",Q),_.getById=it((function(t){return h.appendChild(t).id=j.expando,!l.getElementsByName||!l.getElementsByName(j.expando).length})),_.disconnectedMatch=it((function(t){return d.call(t,"*")})),_.scope=it((function(){return l.querySelectorAll(":scope")})),_.cssHas=it((function(){try{return l.querySelector(":has(*,:jqfake)"),!1}catch(t){return!0}})),_.getById?(e.filter.ID=function(t){var e=t.replace(Y,V);return function(t){return t.getAttribute("id")===e}},e.find.ID=function(t,e){if(void 0!==e.getElementById&&p){var i=e.getElementById(t);return i?[i]:[]}}):(e.filter.ID=function(t){var e=t.replace(Y,V);return function(t){var i=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return i&&i.value===e}},e.find.ID=function(t,e){if(void 0!==e.getElementById&&p){var i,n,s,a=e.getElementById(t);if(a){if((i=a.getAttributeNode("id"))&&i.value===t)return[a];for(s=e.getElementsByName(t),n=0;a=s[n++];)if((i=a.getAttributeNode("id"))&&i.value===t)return[a]}return[]}}),e.find.TAG=function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):e.querySelectorAll(t)},e.find.CLASS=function(t,e){if(void 0!==e.getElementsByClassName&&p)return e.getElementsByClassName(t)},c=[],it((function(t){var e;h.appendChild(t).innerHTML="<a id='"+m+"' href='' disabled='disabled'></a><select id='"+m+"-\r\\' disabled='disabled'><option selected=''></option></select>",t.querySelectorAll("[selected]").length||c.push("\\["+E+"*(?:value|"+C+")"),t.querySelectorAll("[id~="+m+"-]").length||c.push("~="),t.querySelectorAll("a#"+m+"+*").length||c.push(".#.+[+~]"),t.querySelectorAll(":checked").length||c.push(":checked"),(e=l.createElement("input")).setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),h.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&c.push(":enabled",":disabled"),(e=l.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||c.push("\\["+E+"*name"+E+"*="+E+"*(?:''|\"\")")})),_.cssHas||c.push(":has"),c=c.length&&new RegExp(c.join("|")),k=function(t,e){if(t===e)return o=!0,0;var i=!t.compareDocumentPosition-!e.compareDocumentPosition;return i||(1&(i=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!_.sortDetached&&e.compareDocumentPosition(t)===i?t===l||t.ownerDocument==A&&Z.contains(A,t)?-1:e===l||e.ownerDocument==A&&Z.contains(A,e)?1:s?u.call(s,t)-u.call(s,e):0:4&i?-1:1)},l):l}for(t in Z.matches=function(t,e){return Z(t,null,null,e)},Z.matchesSelector=function(t,e){if(lt(t),p&&!z[e+" "]&&(!c||!c.test(e)))try{var i=d.call(t,e);if(i||_.disconnectedMatch||t.document&&11!==t.document.nodeType)return i}catch(t){z(e,!0)}return Z(e,l,null,[t]).length>0},Z.contains=function(t,e){return(t.ownerDocument||t)!=l&&lt(t),j.contains(t,e)},Z.attr=function(t,i){(t.ownerDocument||t)!=l&&lt(t);var n=e.attrHandle[i.toLowerCase()],s=n&&f.call(e.attrHandle,i.toLowerCase())?n(t,i,!p):void 0;return void 0!==s?s:t.getAttribute(i)},Z.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},j.uniqueSort=function(t){var e,i=[],n=0,a=0;if(o=!_.sortStable,s=!_.sortStable&&r.call(t,0),T.call(t,k),o){for(;e=t[a++];)e===t[a]&&(n=i.push(a));for(;n--;)$.call(t,i[n],1)}return s=null,t},j.fn.uniqueSort=function(){return this.pushStack(j.uniqueSort(r.apply(this)))},e=j.expr={cacheLength:50,createPseudo:et,match:F,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(Y,V),t[3]=(t[3]||t[4]||t[5]||"").replace(Y,V),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||Z.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&Z.error(t[0]),t},PSEUDO:function(t){var e,i=!t[6]&&t[2];return F.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":i&&R.test(i)&&(e=ut(i,!0))&&(e=i.indexOf(")",i.length-e)-i.length)&&(t[0]=t[0].slice(0,e),t[2]=i.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(Y,V).toLowerCase();return"*"===t?function(){return!0}:function(t){return S(t,e)}},CLASS:function(t){var e=b[t+" "];return e||(e=new RegExp("(^|"+E+")"+t+"("+E+"|$)"))&&b(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,i){return function(n){var s=Z.attr(n,t);return null==s?"!="===e:!e||(s+="","="===e?s===i:"!="===e?s!==i:"^="===e?i&&0===s.indexOf(i):"*="===e?i&&s.indexOf(i)>-1:"$="===e?i&&s.slice(-i.length)===i:"~="===e?(" "+s.replace(M," ")+" ").indexOf(i)>-1:"|="===e&&(s===i||s.slice(0,i.length+1)===i+"-"))}},CHILD:function(t,e,i,n,s){var a="nth"!==t.slice(0,3),o="last"!==t.slice(-4),r="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var h,u,p,c,f,d=a!==o?"nextSibling":"previousSibling",g=e.parentNode,_=r&&e.nodeName.toLowerCase(),y=!l&&!r,b=!1;if(g){if(a){for(;d;){for(p=e;p=p[d];)if(r?S(p,_):1===p.nodeType)return!1;f=d="only"===t&&!f&&"nextSibling"}return!0}if(f=[o?g.firstChild:g.lastChild],o&&y){for(b=(c=(h=(u=g[m]||(g[m]={}))[t]||[])[0]===v&&h[1])&&h[2],p=c&&g.childNodes[c];p=++c&&p&&p[d]||(b=c=0)||f.pop();)if(1===p.nodeType&&++b&&p===e){u[t]=[v,c,b];break}}else if(y&&(b=c=(h=(u=e[m]||(e[m]={}))[t]||[])[0]===v&&h[1]),!1===b)for(;(p=++c&&p&&p[d]||(b=c=0)||f.pop())&&(!(r?S(p,_):1===p.nodeType)||!++b||(y&&((u=p[m]||(p[m]={}))[t]=[v,b]),p!==e)););return(b-=s)===n||b%n==0&&b/n>=0}}},PSEUDO:function(t,i){var n,s=e.pseudos[t]||e.setFilters[t.toLowerCase()]||Z.error("unsupported pseudo: "+t);return s[m]?s(i):s.length>1?(n=[t,t,"",i],e.setFilters.hasOwnProperty(t.toLowerCase())?et((function(t,e){for(var n,a=s(t,i),o=a.length;o--;)t[n=u.call(t,a[o])]=!(e[n]=a[o])})):function(t){return s(t,0,n)}):s}},pseudos:{not:et((function(t){var e=[],i=[],n=mt(t.replace(P,"$1"));return n[m]?et((function(t,e,i,s){for(var a,o=n(t,null,s,[]),r=t.length;r--;)(a=o[r])&&(t[r]=!(e[r]=a))})):function(t,s,a){return e[0]=t,n(e,null,a,i),e[0]=null,!i.pop()}})),has:et((function(t){return function(e){return Z(t,e).length>0}})),contains:et((function(t){return t=t.replace(Y,V),function(e){return(e.textContent||j.text(e)).indexOf(t)>-1}})),lang:et((function(t){return W.test(t||"")||Z.error("unsupported lang: "+t),t=t.replace(Y,V).toLowerCase(),function(e){var i;do{if(i=p?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(i=i.toLowerCase())===t||0===i.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(t){var e=n.location&&n.location.hash;return e&&e.slice(1)===t.id},root:function(t){return t===h},focus:function(t){return t===function(){try{return l.activeElement}catch(t){}}()&&l.hasFocus()&&!!(t.type||t.href||~t.tabIndex)},enabled:at(!1),disabled:at(!0),checked:function(t){return S(t,"input")&&!!t.checked||S(t,"option")&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!e.pseudos.empty(t)},header:function(t){return X.test(t.nodeName)},input:function(t){return B.test(t.nodeName)},button:function(t){return S(t,"input")&&"button"===t.type||S(t,"button")},text:function(t){var e;return S(t,"input")&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:ot((function(){return[0]})),last:ot((function(t,e){return[e-1]})),eq:ot((function(t,e,i){return[i<0?i+e:i]})),even:ot((function(t,e){for(var i=0;i<e;i+=2)t.push(i);return t})),odd:ot((function(t,e){for(var i=1;i<e;i+=2)t.push(i);return t})),lt:ot((function(t,e,i){var n;for(n=i<0?i+e:i>e?e:i;--n>=0;)t.push(n);return t})),gt:ot((function(t,e,i){for(var n=i<0?i+e:i;++n<e;)t.push(n);return t}))}},e.pseudos.nth=e.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})e.pseudos[t]=nt(t);for(t in{submit:!0,reset:!0})e.pseudos[t]=st(t);function ht(){}function ut(t,i){var n,s,a,o,r,l,h,u=w[t+" "];if(u)return i?0:u.slice(0);for(r=t,l=[],h=e.preFilter;r;){for(o in n&&!(s=H.exec(r))||(s&&(r=r.slice(s[0].length)||r),l.push(a=[])),n=!1,(s=L.exec(r))&&(n=s.shift(),a.push({value:n,type:s[0].replace(P," ")}),r=r.slice(n.length)),e.filter)!(s=F[o].exec(r))||h[o]&&!(s=h[o](s))||(n=s.shift(),a.push({value:n,type:o,matches:s}),r=r.slice(n.length));if(!n)break}return i?r.length:r?Z.error(t):w(t,l).slice(0)}function pt(t){for(var e=0,i=t.length,n="";e<i;e++)n+=t[e].value;return n}function ct(t,e,i){var n=e.dir,s=e.next,a=s||n,o=i&&"parentNode"===a,r=y++;return e.first?function(e,i,s){for(;e=e[n];)if(1===e.nodeType||o)return t(e,i,s);return!1}:function(e,i,l){var h,u,p=[v,r];if(l){for(;e=e[n];)if((1===e.nodeType||o)&&t(e,i,l))return!0}else for(;e=e[n];)if(1===e.nodeType||o)if(u=e[m]||(e[m]={}),s&&S(e,s))e=e[n]||e;else{if((h=u[a])&&h[0]===v&&h[1]===r)return p[2]=h[2];if(u[a]=p,p[2]=t(e,i,l))return!0}return!1}}function ft(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function dt(t,e,i,n,s){for(var a,o=[],r=0,l=t.length,h=null!=e;r<l;r++)(a=t[r])&&(i&&!i(a,n,s)||(o.push(a),h&&e.push(r)));return o}function gt(t,e,i,n,s,a){return n&&!n[m]&&(n=gt(n)),s&&!s[m]&&(s=gt(s,a)),et((function(a,o,r,l){var h,p,c,f,d=[],_=[],m=o.length,v=a||function(t,e,i){for(var n=0,s=e.length;n<s;n++)Z(t,e[n],i);return i}(e||"*",r.nodeType?[r]:r,[]),y=!t||!a&&e?v:dt(v,d,t,r,l);if(i?i(y,f=s||(a?t:m||n)?[]:o,r,l):f=y,n)for(h=dt(f,_),n(h,[],r,l),p=h.length;p--;)(c=h[p])&&(f[_[p]]=!(y[_[p]]=c));if(a){if(s||t){if(s){for(h=[],p=f.length;p--;)(c=f[p])&&h.push(y[p]=c);s(null,f=[],h,l)}for(p=f.length;p--;)(c=f[p])&&(h=s?u.call(a,c):d[p])>-1&&(a[h]=!(o[h]=c))}}else f=dt(f===o?f.splice(m,f.length):f),s?s(null,o,f,l):g.apply(o,f)}))}function _t(t){for(var n,s,a,o=t.length,r=e.relative[t[0].type],l=r||e.relative[" "],h=r?1:0,p=ct((function(t){return t===n}),l,!0),c=ct((function(t){return u.call(n,t)>-1}),l,!0),f=[function(t,e,s){var a=!r&&(s||e!=i)||((n=e).nodeType?p(t,e,s):c(t,e,s));return n=null,a}];h<o;h++)if(s=e.relative[t[h].type])f=[ct(ft(f),s)];else{if((s=e.filter[t[h].type].apply(null,t[h].matches))[m]){for(a=++h;a<o&&!e.relative[t[a].type];a++);return gt(h>1&&ft(f),h>1&&pt(t.slice(0,h-1).concat({value:" "===t[h-2].type?"*":""})).replace(P,"$1"),s,h<a&&_t(t.slice(h,a)),a<o&&_t(t=t.slice(a)),a<o&&pt(t))}f.push(s)}return ft(f)}function mt(t,n){var s,a=[],o=[],r=x[t+" "];if(!r){for(n||(n=ut(t)),s=n.length;s--;)(r=_t(n[s]))[m]?a.push(r):o.push(r);r=x(t,function(t,n){var s=n.length>0,a=t.length>0,o=function(o,r,h,u,c){var f,d,_,m=0,y="0",b=o&&[],w=[],x=i,z=o||a&&e.find.TAG("*",c),k=v+=null==x?1:Math.random()||.1,C=z.length;for(c&&(i=r==l||r||c);y!==C&&null!=(f=z[y]);y++){if(a&&f){for(d=0,r||f.ownerDocument==l||(lt(f),h=!p);_=t[d++];)if(_(f,r||l,h)){g.call(u,f);break}c&&(v=k)}s&&((f=!_&&f)&&m--,o&&b.push(f))}if(m+=y,s&&y!==m){for(d=0;_=n[d++];)_(b,w,r,h);if(o){if(m>0)for(;y--;)b[y]||w[y]||(w[y]=q.call(u));w=dt(w)}g.apply(u,w),c&&!o&&w.length>0&&m+n.length>1&&j.uniqueSort(u)}return c&&(v=k,i=x),b};return s?et(o):o}(o,a)),r.selector=t}return r}function vt(t,i,n,s){var a,o,r,l,h,u="function"==typeof t&&t,c=!s&&ut(t=u.selector||t);if(n=n||[],1===c.length){if((o=c[0]=c[0].slice(0)).length>2&&"ID"===(r=o[0]).type&&9===i.nodeType&&p&&e.relative[o[1].type]){if(!(i=(e.find.ID(r.matches[0].replace(Y,V),i)||[])[0]))return n;u&&(i=i.parentNode),t=t.slice(o.shift().value.length)}for(a=F.needsContext.test(t)?0:o.length;a--&&(r=o[a],!e.relative[l=r.type]);)if((h=e.find[l])&&(s=h(r.matches[0].replace(Y,V),G.test(o[0].type)&&rt(i.parentNode)||i))){if(o.splice(a,1),!(t=s.length&&pt(o)))return g.apply(n,s),n;break}}return(u||mt(t,c))(s,i,!p,n,!i||G.test(t)&&rt(i.parentNode)||i),n}ht.prototype=e.filters=e.pseudos,e.setFilters=new ht,_.sortStable=m.split("").sort(k).join("")===m,lt(),_.sortDetached=it((function(t){return 1&t.compareDocumentPosition(l.createElement("fieldset"))})),j.find=Z,j.expr[":"]=j.expr.pseudos,j.unique=j.uniqueSort,Z.compile=mt,Z.select=vt,Z.setDocument=lt,Z.tokenize=ut,Z.escape=j.escapeSelector,Z.getText=j.text,Z.isXML=j.isXMLDoc,Z.selectors=j.expr,Z.support=j.support,Z.uniqueSort=j.uniqueSort}();var O=function(t,e,i){for(var n=[],s=void 0!==i;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(s&&j(t).is(i))break;n.push(t)}return n},M=function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i},H=j.expr.match.needsContext,L=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function U(t,e,i){return m(e)?j.grep(t,(function(t,n){return!!e.call(t,n,t)!==i})):e.nodeType?j.grep(t,(function(t){return t===e!==i})):"string"!=typeof e?j.grep(t,(function(t){return u.call(e,t)>-1!==i})):j.filter(e,t,i)}j.filter=function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?j.find.matchesSelector(n,t)?[n]:[]:j.find.matches(t,j.grep(e,(function(t){return 1===t.nodeType})))},j.fn.extend({find:function(t){var e,i,n=this.length,s=this;if("string"!=typeof t)return this.pushStack(j(t).filter((function(){for(e=0;e<n;e++)if(j.contains(s[e],this))return!0})));for(i=this.pushStack([]),e=0;e<n;e++)j.find(t,s[e],i);return n>1?j.uniqueSort(i):i},filter:function(t){return this.pushStack(U(this,t||[],!1))},not:function(t){return this.pushStack(U(this,t||[],!0))},is:function(t){return!!U(this,"string"==typeof t&&H.test(t)?j(t):t||[],!1).length}});var R,W=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(j.fn.init=function(t,e,i){var n,s;if(!t)return this;if(i=i||R,"string"==typeof t){if(!(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:W.exec(t))||!n[1]&&e)return!e||e.jquery?(e||i).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof j?e[0]:e,j.merge(this,j.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:y,!0)),L.test(n[1])&&j.isPlainObject(e))for(n in e)m(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return(s=y.getElementById(n[2]))&&(this[0]=s,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):m(t)?void 0!==i.ready?i.ready(t):t(j):j.makeArray(t,this)}).prototype=j.fn,R=j(y);var F=/^(?:parents|prev(?:Until|All))/,B={children:!0,contents:!0,next:!0,prev:!0};function X(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}j.fn.extend({has:function(t){var e=j(t,this),i=e.length;return this.filter((function(){for(var t=0;t<i;t++)if(j.contains(this,e[t]))return!0}))},closest:function(t,e){var i,n=0,s=this.length,a=[],o="string"!=typeof t&&j(t);if(!H.test(t))for(;n<s;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&j.find.matchesSelector(i,t))){a.push(i);break}return this.pushStack(a.length>1?j.uniqueSort(a):a)},index:function(t){return t?"string"==typeof t?u.call(j(t),this[0]):u.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(j.uniqueSort(j.merge(this.get(),j(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),j.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return O(t,"parentNode")},parentsUntil:function(t,e,i){return O(t,"parentNode",i)},next:function(t){return X(t,"nextSibling")},prev:function(t){return X(t,"previousSibling")},nextAll:function(t){return O(t,"nextSibling")},prevAll:function(t){return O(t,"previousSibling")},nextUntil:function(t,e,i){return O(t,"nextSibling",i)},prevUntil:function(t,e,i){return O(t,"previousSibling",i)},siblings:function(t){return M((t.parentNode||{}).firstChild,t)},children:function(t){return M(t.firstChild)},contents:function(t){return null!=t.contentDocument&&o(t.contentDocument)?t.contentDocument:(S(t,"template")&&(t=t.content||t),j.merge([],t.childNodes))}},(function(t,e){j.fn[t]=function(i,n){var s=j.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=j.filter(n,s)),this.length>1&&(B[t]||j.uniqueSort(s),F.test(t)&&s.reverse()),this.pushStack(s)}}));var J=/[^\x20\t\r\n\f]+/g;function G(t){return t}function Y(t){throw t}function V(t,e,i,n){var s;try{t&&m(s=t.promise)?s.call(t).done(e).fail(i):t&&m(s=t.then)?s.call(t,e,i):e.apply(void 0,[t].slice(n))}catch(t){i.apply(void 0,[t])}}j.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return j.each(t.match(J)||[],(function(t,i){e[i]=!0})),e}(t):j.extend({},t);var e,i,n,s,a=[],o=[],r=-1,l=function(){for(s=s||t.once,n=e=!0;o.length;r=-1)for(i=o.shift();++r<a.length;)!1===a[r].apply(i[0],i[1])&&t.stopOnFalse&&(r=a.length,i=!1);t.memory||(i=!1),e=!1,s&&(a=i?[]:"")},h={add:function(){return a&&(i&&!e&&(r=a.length-1,o.push(i)),function e(i){j.each(i,(function(i,n){m(n)?t.unique&&h.has(n)||a.push(n):n&&n.length&&"string"!==x(n)&&e(n)}))}(arguments),i&&!e&&l()),this},remove:function(){return j.each(arguments,(function(t,e){for(var i;(i=j.inArray(e,a,i))>-1;)a.splice(i,1),i<=r&&r--})),this},has:function(t){return t?j.inArray(t,a)>-1:a.length>0},empty:function(){return a&&(a=[]),this},disable:function(){return s=o=[],a=i="",this},disabled:function(){return!a},lock:function(){return s=o=[],i||e||(a=i=""),this},locked:function(){return!!s},fireWith:function(t,i){return s||(i=[t,(i=i||[]).slice?i.slice():i],o.push(i),e||l()),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},j.extend({Deferred:function(t){var e=[["notify","progress",j.Callbacks("memory"),j.Callbacks("memory"),2],["resolve","done",j.Callbacks("once memory"),j.Callbacks("once memory"),0,"resolved"],["reject","fail",j.Callbacks("once memory"),j.Callbacks("once memory"),1,"rejected"]],i="pending",s={state:function(){return i},always:function(){return a.done(arguments).fail(arguments),this},catch:function(t){return s.then(null,t)},pipe:function(){var t=arguments;return j.Deferred((function(i){j.each(e,(function(e,n){var s=m(t[n[4]])&&t[n[4]];a[n[1]]((function(){var t=s&&s.apply(this,arguments);t&&m(t.promise)?t.promise().progress(i.notify).done(i.resolve).fail(i.reject):i[n[0]+"With"](this,s?[t]:arguments)}))})),t=null})).promise()},then:function(t,i,s){var a=0;function o(t,e,i,s){return function(){var r=this,l=arguments,h=function(){var n,h;if(!(t<a)){if((n=i.apply(r,l))===e.promise())throw new TypeError("Thenable self-resolution");h=n&&("object"==typeof n||"function"==typeof n)&&n.then,m(h)?s?h.call(n,o(a,e,G,s),o(a,e,Y,s)):(a++,h.call(n,o(a,e,G,s),o(a,e,Y,s),o(a,e,G,e.notifyWith))):(i!==G&&(r=void 0,l=[n]),(s||e.resolveWith)(r,l))}},u=s?h:function(){try{h()}catch(n){j.Deferred.exceptionHook&&j.Deferred.exceptionHook(n,u.error),t+1>=a&&(i!==Y&&(r=void 0,l=[n]),e.rejectWith(r,l))}};t?u():(j.Deferred.getErrorHook?u.error=j.Deferred.getErrorHook():j.Deferred.getStackHook&&(u.error=j.Deferred.getStackHook()),n.setTimeout(u))}}return j.Deferred((function(n){e[0][3].add(o(0,n,m(s)?s:G,n.notifyWith)),e[1][3].add(o(0,n,m(t)?t:G)),e[2][3].add(o(0,n,m(i)?i:Y))})).promise()},promise:function(t){return null!=t?j.extend(t,s):s}},a={};return j.each(e,(function(t,n){var o=n[2],r=n[5];s[n[1]]=o.add,r&&o.add((function(){i=r}),e[3-t][2].disable,e[3-t][3].disable,e[0][2].lock,e[0][3].lock),o.add(n[3].fire),a[n[0]]=function(){return a[n[0]+"With"](this===a?void 0:this,arguments),this},a[n[0]+"With"]=o.fireWith})),s.promise(a),t&&t.call(a,a),a},when:function(t){var e=arguments.length,i=e,n=Array(i),s=r.call(arguments),a=j.Deferred(),o=function(t){return function(i){n[t]=this,s[t]=arguments.length>1?r.call(arguments):i,--e||a.resolveWith(n,s)}};if(e<=1&&(V(t,a.done(o(i)).resolve,a.reject,!e),"pending"===a.state()||m(s[i]&&s[i].then)))return a.then();for(;i--;)V(s[i],o(i),a.reject);return a.promise()}});var Q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;j.Deferred.exceptionHook=function(t,e){n.console&&n.console.warn&&t&&Q.test(t.name)&&n.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)},j.readyException=function(t){n.setTimeout((function(){throw t}))};var K=j.Deferred();function Z(){y.removeEventListener("DOMContentLoaded",Z),n.removeEventListener("load",Z),j.ready()}j.fn.ready=function(t){return K.then(t).catch((function(t){j.readyException(t)})),this},j.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--j.readyWait:j.isReady)||(j.isReady=!0,!0!==t&&--j.readyWait>0||K.resolveWith(y,[j]))}}),j.ready.then=K.then,"complete"===y.readyState||"loading"!==y.readyState&&!y.documentElement.doScroll?n.setTimeout(j.ready):(y.addEventListener("DOMContentLoaded",Z),n.addEventListener("load",Z));var tt=function(t,e,i,n,s,a,o){var r=0,l=t.length,h=null==i;if("object"===x(i))for(r in s=!0,i)tt(t,e,r,i[r],!0,a,o);else if(void 0!==n&&(s=!0,m(n)||(o=!0),h&&(o?(e.call(t,n),e=null):(h=e,e=function(t,e,i){return h.call(j(t),i)})),e))for(;r<l;r++)e(t[r],i,o?n:n.call(t[r],r,e(t[r],i)));return s?t:h?e.call(t):l?e(t[0],i):a},et=/^-ms-/,it=/-([a-z])/g;function nt(t,e){return e.toUpperCase()}function st(t){return t.replace(et,"ms-").replace(it,nt)}var at=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function ot(){this.expando=j.expando+ot.uid++}ot.uid=1,ot.prototype={cache:function(t){var e=t[this.expando];return e||(e={},at(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,i){var n,s=this.cache(t);if("string"==typeof e)s[st(e)]=i;else for(n in e)s[st(n)]=e[n];return s},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][st(e)]},access:function(t,e,i){return void 0===e||e&&"string"==typeof e&&void 0===i?this.get(t,e):(this.set(t,e,i),void 0!==i?i:e)},remove:function(t,e){var i,n=t[this.expando];if(void 0!==n){if(void 0!==e){i=(e=Array.isArray(e)?e.map(st):(e=st(e))in n?[e]:e.match(J)||[]).length;for(;i--;)delete n[e[i]]}(void 0===e||j.isEmptyObject(n))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!j.isEmptyObject(e)}};var rt=new ot,lt=new ot,ht=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ut=/[A-Z]/g;function pt(t,e,i){var n;if(void 0===i&&1===t.nodeType)if(n="data-"+e.replace(ut,"-$&").toLowerCase(),"string"==typeof(i=t.getAttribute(n))){try{i=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:ht.test(t)?JSON.parse(t):t)}(i)}catch(t){}lt.set(t,e,i)}else i=void 0;return i}j.extend({hasData:function(t){return lt.hasData(t)||rt.hasData(t)},data:function(t,e,i){return lt.access(t,e,i)},removeData:function(t,e){lt.remove(t,e)},_data:function(t,e,i){return rt.access(t,e,i)},_removeData:function(t,e){rt.remove(t,e)}}),j.fn.extend({data:function(t,e){var i,n,s,a=this[0],o=a&&a.attributes;if(void 0===t){if(this.length&&(s=lt.get(a),1===a.nodeType&&!rt.get(a,"hasDataAttrs"))){for(i=o.length;i--;)o[i]&&0===(n=o[i].name).indexOf("data-")&&(n=st(n.slice(5)),pt(a,n,s[n]));rt.set(a,"hasDataAttrs",!0)}return s}return"object"==typeof t?this.each((function(){lt.set(this,t)})):tt(this,(function(e){var i;if(a&&void 0===e)return void 0!==(i=lt.get(a,t))||void 0!==(i=pt(a,t))?i:void 0;this.each((function(){lt.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){lt.remove(this,t)}))}}),j.extend({queue:function(t,e,i){var n;if(t)return e=(e||"fx")+"queue",n=rt.get(t,e),i&&(!n||Array.isArray(i)?n=rt.access(t,e,j.makeArray(i)):n.push(i)),n||[]},dequeue:function(t,e){e=e||"fx";var i=j.queue(t,e),n=i.length,s=i.shift(),a=j._queueHooks(t,e);"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete a.stop,s.call(t,(function(){j.dequeue(t,e)}),a)),!n&&a&&a.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return rt.get(t,i)||rt.access(t,i,{empty:j.Callbacks("once memory").add((function(){rt.remove(t,[e+"queue",i])}))})}}),j.fn.extend({queue:function(t,e){var i=2;return"string"!=typeof t&&(e=t,t="fx",i--),arguments.length<i?j.queue(this[0],t):void 0===e?this:this.each((function(){var i=j.queue(this,t,e);j._queueHooks(this,t),"fx"===t&&"inprogress"!==i[0]&&j.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){j.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var i,n=1,s=j.Deferred(),a=this,o=this.length,r=function(){--n||s.resolveWith(a,[a])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";o--;)(i=rt.get(a[o],t+"queueHooks"))&&i.empty&&(n++,i.empty.add(r));return r(),s.promise(e)}});var ct=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ft=new RegExp("^(?:([+-])=|)("+ct+")([a-z%]*)$","i"),dt=["Top","Right","Bottom","Left"],gt=y.documentElement,_t=function(t){return j.contains(t.ownerDocument,t)},mt={composed:!0};gt.getRootNode&&(_t=function(t){return j.contains(t.ownerDocument,t)||t.getRootNode(mt)===t.ownerDocument});var vt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&_t(t)&&"none"===j.css(t,"display")};function yt(t,e,i,n){var s,a,o=20,r=n?function(){return n.cur()}:function(){return j.css(t,e,"")},l=r(),h=i&&i[3]||(j.cssNumber[e]?"":"px"),u=t.nodeType&&(j.cssNumber[e]||"px"!==h&&+l)&&ft.exec(j.css(t,e));if(u&&u[3]!==h){for(l/=2,h=h||u[3],u=+l||1;o--;)j.style(t,e,u+h),(1-a)*(1-(a=r()/l||.5))<=0&&(o=0),u/=a;u*=2,j.style(t,e,u+h),i=i||[]}return i&&(u=+u||+l||0,s=i[1]?u+(i[1]+1)*i[2]:+i[2],n&&(n.unit=h,n.start=u,n.end=s)),s}var bt={};function wt(t){var e,i=t.ownerDocument,n=t.nodeName,s=bt[n];return s||(e=i.body.appendChild(i.createElement(n)),s=j.css(e,"display"),e.parentNode.removeChild(e),"none"===s&&(s="block"),bt[n]=s,s)}function xt(t,e){for(var i,n,s=[],a=0,o=t.length;a<o;a++)(n=t[a]).style&&(i=n.style.display,e?("none"===i&&(s[a]=rt.get(n,"display")||null,s[a]||(n.style.display="")),""===n.style.display&&vt(n)&&(s[a]=wt(n))):"none"!==i&&(s[a]="none",rt.set(n,"display",i)));for(a=0;a<o;a++)null!=s[a]&&(t[a].style.display=s[a]);return t}j.fn.extend({show:function(){return xt(this,!0)},hide:function(){return xt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){vt(this)?j(this).show():j(this).hide()}))}});var zt,kt,jt=/^(?:checkbox|radio)$/i,Ct=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,St=/^$|^module$|\/(?:java|ecma)script/i;zt=y.createDocumentFragment().appendChild(y.createElement("div")),(kt=y.createElement("input")).setAttribute("type","radio"),kt.setAttribute("checked","checked"),kt.setAttribute("name","t"),zt.appendChild(kt),_.checkClone=zt.cloneNode(!0).cloneNode(!0).lastChild.checked,zt.innerHTML="<textarea>x</textarea>",_.noCloneChecked=!!zt.cloneNode(!0).lastChild.defaultValue,zt.innerHTML="<option></option>",_.option=!!zt.lastChild;var qt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Tt(t,e){var i;return i=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&S(t,e)?j.merge([t],i):i}function $t(t,e){for(var i=0,n=t.length;i<n;i++)rt.set(t[i],"globalEval",!e||rt.get(e[i],"globalEval"))}qt.tbody=qt.tfoot=qt.colgroup=qt.caption=qt.thead,qt.th=qt.td,_.option||(qt.optgroup=qt.option=[1,"<select multiple='multiple'>","</select>"]);var Et=/<|&#?\w+;/;function Pt(t,e,i,n,s){for(var a,o,r,l,h,u,p=e.createDocumentFragment(),c=[],f=0,d=t.length;f<d;f++)if((a=t[f])||0===a)if("object"===x(a))j.merge(c,a.nodeType?[a]:a);else if(Et.test(a)){for(o=o||p.appendChild(e.createElement("div")),r=(Ct.exec(a)||["",""])[1].toLowerCase(),l=qt[r]||qt._default,o.innerHTML=l[1]+j.htmlPrefilter(a)+l[2],u=l[0];u--;)o=o.lastChild;j.merge(c,o.childNodes),(o=p.firstChild).textContent=""}else c.push(e.createTextNode(a));for(p.textContent="",f=0;a=c[f++];)if(n&&j.inArray(a,n)>-1)s&&s.push(a);else if(h=_t(a),o=Tt(p.appendChild(a),"script"),h&&$t(o),i)for(u=0;a=o[u++];)St.test(a.type||"")&&i.push(a);return p}var Nt=/^([^.]*)(?:\.(.+)|)/;function Dt(){return!0}function At(){return!1}function It(t,e,i,n,s,a){var o,r;if("object"==typeof e){for(r in"string"!=typeof i&&(n=n||i,i=void 0),e)It(t,r,i,n,e[r],a);return t}if(null==n&&null==s?(s=i,n=i=void 0):null==s&&("string"==typeof i?(s=n,n=void 0):(s=n,n=i,i=void 0)),!1===s)s=At;else if(!s)return t;return 1===a&&(o=s,s=function(t){return j().off(t),o.apply(this,arguments)},s.guid=o.guid||(o.guid=j.guid++)),t.each((function(){j.event.add(this,e,s,n,i)}))}function Ot(t,e,i){i?(rt.set(t,e,!1),j.event.add(t,e,{namespace:!1,handler:function(t){var i,n=rt.get(this,e);if(1&t.isTrigger&&this[e]){if(n)(j.event.special[e]||{}).delegateType&&t.stopPropagation();else if(n=r.call(arguments),rt.set(this,e,n),this[e](),i=rt.get(this,e),rt.set(this,e,!1),n!==i)return t.stopImmediatePropagation(),t.preventDefault(),i}else n&&(rt.set(this,e,j.event.trigger(n[0],n.slice(1),this)),t.stopPropagation(),t.isImmediatePropagationStopped=Dt)}})):void 0===rt.get(t,e)&&j.event.add(t,e,Dt)}j.event={global:{},add:function(t,e,i,n,s){var a,o,r,l,h,u,p,c,f,d,g,_=rt.get(t);if(at(t))for(i.handler&&(i=(a=i).handler,s=a.selector),s&&j.find.matchesSelector(gt,s),i.guid||(i.guid=j.guid++),(l=_.events)||(l=_.events=Object.create(null)),(o=_.handle)||(o=_.handle=function(e){return void 0!==j&&j.event.triggered!==e.type?j.event.dispatch.apply(t,arguments):void 0}),h=(e=(e||"").match(J)||[""]).length;h--;)f=g=(r=Nt.exec(e[h])||[])[1],d=(r[2]||"").split(".").sort(),f&&(p=j.event.special[f]||{},f=(s?p.delegateType:p.bindType)||f,p=j.event.special[f]||{},u=j.extend({type:f,origType:g,data:n,handler:i,guid:i.guid,selector:s,needsContext:s&&j.expr.match.needsContext.test(s),namespace:d.join(".")},a),(c=l[f])||((c=l[f]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(t,n,d,o)||t.addEventListener&&t.addEventListener(f,o)),p.add&&(p.add.call(t,u),u.handler.guid||(u.handler.guid=i.guid)),s?c.splice(c.delegateCount++,0,u):c.push(u),j.event.global[f]=!0)},remove:function(t,e,i,n,s){var a,o,r,l,h,u,p,c,f,d,g,_=rt.hasData(t)&&rt.get(t);if(_&&(l=_.events)){for(h=(e=(e||"").match(J)||[""]).length;h--;)if(f=g=(r=Nt.exec(e[h])||[])[1],d=(r[2]||"").split(".").sort(),f){for(p=j.event.special[f]||{},c=l[f=(n?p.delegateType:p.bindType)||f]||[],r=r[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=a=c.length;a--;)u=c[a],!s&&g!==u.origType||i&&i.guid!==u.guid||r&&!r.test(u.namespace)||n&&n!==u.selector&&("**"!==n||!u.selector)||(c.splice(a,1),u.selector&&c.delegateCount--,p.remove&&p.remove.call(t,u));o&&!c.length&&(p.teardown&&!1!==p.teardown.call(t,d,_.handle)||j.removeEvent(t,f,_.handle),delete l[f])}else for(f in l)j.event.remove(t,f+e[h],i,n,!0);j.isEmptyObject(l)&&rt.remove(t,"handle events")}},dispatch:function(t){var e,i,n,s,a,o,r=new Array(arguments.length),l=j.event.fix(t),h=(rt.get(this,"events")||Object.create(null))[l.type]||[],u=j.event.special[l.type]||{};for(r[0]=l,e=1;e<arguments.length;e++)r[e]=arguments[e];if(l.delegateTarget=this,!u.preDispatch||!1!==u.preDispatch.call(this,l)){for(o=j.event.handlers.call(this,l,h),e=0;(s=o[e++])&&!l.isPropagationStopped();)for(l.currentTarget=s.elem,i=0;(a=s.handlers[i++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==a.namespace&&!l.rnamespace.test(a.namespace)||(l.handleObj=a,l.data=a.data,void 0!==(n=((j.event.special[a.origType]||{}).handle||a.handler).apply(s.elem,r))&&!1===(l.result=n)&&(l.preventDefault(),l.stopPropagation()));return u.postDispatch&&u.postDispatch.call(this,l),l.result}},handlers:function(t,e){var i,n,s,a,o,r=[],l=e.delegateCount,h=t.target;if(l&&h.nodeType&&!("click"===t.type&&t.button>=1))for(;h!==this;h=h.parentNode||this)if(1===h.nodeType&&("click"!==t.type||!0!==h.disabled)){for(a=[],o={},i=0;i<l;i++)void 0===o[s=(n=e[i]).selector+" "]&&(o[s]=n.needsContext?j(s,this).index(h)>-1:j.find(s,this,null,[h]).length),o[s]&&a.push(n);a.length&&r.push({elem:h,handlers:a})}return h=this,l<e.length&&r.push({elem:h,handlers:e.slice(l)}),r},addProp:function(t,e){Object.defineProperty(j.Event.prototype,t,{enumerable:!0,configurable:!0,get:m(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[j.expando]?t:new j.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return jt.test(e.type)&&e.click&&S(e,"input")&&Ot(e,"click",!0),!1},trigger:function(t){var e=this||t;return jt.test(e.type)&&e.click&&S(e,"input")&&Ot(e,"click"),!0},_default:function(t){var e=t.target;return jt.test(e.type)&&e.click&&S(e,"input")&&rt.get(e,"click")||S(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},j.removeEvent=function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i)},j.Event=function(t,e){if(!(this instanceof j.Event))return new j.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Dt:At,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&j.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[j.expando]=!0},j.Event.prototype={constructor:j.Event,isDefaultPrevented:At,isPropagationStopped:At,isImmediatePropagationStopped:At,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Dt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Dt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Dt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},j.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},j.event.addProp),j.each({focus:"focusin",blur:"focusout"},(function(t,e){function i(t){if(y.documentMode){var i=rt.get(this,"handle"),n=j.event.fix(t);n.type="focusin"===t.type?"focus":"blur",n.isSimulated=!0,i(t),n.target===n.currentTarget&&i(n)}else j.event.simulate(e,t.target,j.event.fix(t))}j.event.special[t]={setup:function(){var n;if(Ot(this,t,!0),!y.documentMode)return!1;(n=rt.get(this,e))||this.addEventListener(e,i),rt.set(this,e,(n||0)+1)},trigger:function(){return Ot(this,t),!0},teardown:function(){var t;if(!y.documentMode)return!1;(t=rt.get(this,e)-1)?rt.set(this,e,t):(this.removeEventListener(e,i),rt.remove(this,e))},_default:function(e){return rt.get(e.target,t)},delegateType:e},j.event.special[e]={setup:function(){var n=this.ownerDocument||this.document||this,s=y.documentMode?this:n,a=rt.get(s,e);a||(y.documentMode?this.addEventListener(e,i):n.addEventListener(t,i,!0)),rt.set(s,e,(a||0)+1)},teardown:function(){var n=this.ownerDocument||this.document||this,s=y.documentMode?this:n,a=rt.get(s,e)-1;a?rt.set(s,e,a):(y.documentMode?this.removeEventListener(e,i):n.removeEventListener(t,i,!0),rt.remove(s,e))}}})),j.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){j.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=t.relatedTarget,s=t.handleObj;return n&&(n===this||j.contains(this,n))||(t.type=s.origType,i=s.handler.apply(this,arguments),t.type=e),i}}})),j.fn.extend({on:function(t,e,i,n){return It(this,t,e,i,n)},one:function(t,e,i,n){return It(this,t,e,i,n,1)},off:function(t,e,i){var n,s;if(t&&t.preventDefault&&t.handleObj)return n=t.handleObj,j(t.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof t){for(s in t)this.off(s,e,t[s]);return this}return!1!==e&&"function"!=typeof e||(i=e,e=void 0),!1===i&&(i=At),this.each((function(){j.event.remove(this,t,i,e)}))}});var Mt=/<script|<style|<link/i,Ht=/checked\s*(?:[^=]|=\s*.checked.)/i,Lt=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Ut(t,e){return S(t,"table")&&S(11!==e.nodeType?e:e.firstChild,"tr")&&j(t).children("tbody")[0]||t}function Rt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Wt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ft(t,e){var i,n,s,a,o,r;if(1===e.nodeType){if(rt.hasData(t)&&(r=rt.get(t).events))for(s in rt.remove(e,"handle events"),r)for(i=0,n=r[s].length;i<n;i++)j.event.add(e,s,r[s][i]);lt.hasData(t)&&(a=lt.access(t),o=j.extend({},a),lt.set(e,o))}}function Bt(t,e){var i=e.nodeName.toLowerCase();"input"===i&&jt.test(t.type)?e.checked=t.checked:"input"!==i&&"textarea"!==i||(e.defaultValue=t.defaultValue)}function Xt(t,e,i,n){e=l(e);var s,a,o,r,h,u,p=0,c=t.length,f=c-1,d=e[0],g=m(d);if(g||c>1&&"string"==typeof d&&!_.checkClone&&Ht.test(d))return t.each((function(s){var a=t.eq(s);g&&(e[0]=d.call(this,s,a.html())),Xt(a,e,i,n)}));if(c&&(a=(s=Pt(e,t[0].ownerDocument,!1,t,n)).firstChild,1===s.childNodes.length&&(s=a),a||n)){for(r=(o=j.map(Tt(s,"script"),Rt)).length;p<c;p++)h=s,p!==f&&(h=j.clone(h,!0,!0),r&&j.merge(o,Tt(h,"script"))),i.call(t[p],h,p);if(r)for(u=o[o.length-1].ownerDocument,j.map(o,Wt),p=0;p<r;p++)h=o[p],St.test(h.type||"")&&!rt.access(h,"globalEval")&&j.contains(u,h)&&(h.src&&"module"!==(h.type||"").toLowerCase()?j._evalUrl&&!h.noModule&&j._evalUrl(h.src,{nonce:h.nonce||h.getAttribute("nonce")},u):w(h.textContent.replace(Lt,""),h,u))}return t}function Jt(t,e,i){for(var n,s=e?j.filter(e,t):t,a=0;null!=(n=s[a]);a++)i||1!==n.nodeType||j.cleanData(Tt(n)),n.parentNode&&(i&&_t(n)&&$t(Tt(n,"script")),n.parentNode.removeChild(n));return t}j.extend({htmlPrefilter:function(t){return t},clone:function(t,e,i){var n,s,a,o,r=t.cloneNode(!0),l=_t(t);if(!(_.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||j.isXMLDoc(t)))for(o=Tt(r),n=0,s=(a=Tt(t)).length;n<s;n++)Bt(a[n],o[n]);if(e)if(i)for(a=a||Tt(t),o=o||Tt(r),n=0,s=a.length;n<s;n++)Ft(a[n],o[n]);else Ft(t,r);return(o=Tt(r,"script")).length>0&&$t(o,!l&&Tt(t,"script")),r},cleanData:function(t){for(var e,i,n,s=j.event.special,a=0;void 0!==(i=t[a]);a++)if(at(i)){if(e=i[rt.expando]){if(e.events)for(n in e.events)s[n]?j.event.remove(i,n):j.removeEvent(i,n,e.handle);i[rt.expando]=void 0}i[lt.expando]&&(i[lt.expando]=void 0)}}}),j.fn.extend({detach:function(t){return Jt(this,t,!0)},remove:function(t){return Jt(this,t)},text:function(t){return tt(this,(function(t){return void 0===t?j.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Xt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ut(this,t).appendChild(t)}))},prepend:function(){return Xt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Ut(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Xt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Xt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(j.cleanData(Tt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return j.clone(this,t,e)}))},html:function(t){return tt(this,(function(t){var e=this[0]||{},i=0,n=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Mt.test(t)&&!qt[(Ct.exec(t)||["",""])[1].toLowerCase()]){t=j.htmlPrefilter(t);try{for(;i<n;i++)1===(e=this[i]||{}).nodeType&&(j.cleanData(Tt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Xt(this,arguments,(function(e){var i=this.parentNode;j.inArray(this,t)<0&&(j.cleanData(Tt(this)),i&&i.replaceChild(e,this))}),t)}}),j.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){j.fn[t]=function(t){for(var i,n=[],s=j(t),a=s.length-1,o=0;o<=a;o++)i=o===a?this:this.clone(!0),j(s[o])[e](i),h.apply(n,i.get());return this.pushStack(n)}}));var Gt=new RegExp("^("+ct+")(?!px)[a-z%]+$","i"),Yt=/^--/,Vt=function(t){var e=t.ownerDocument.defaultView;return e&&e.opener||(e=n),e.getComputedStyle(t)},Qt=function(t,e,i){var n,s,a={};for(s in e)a[s]=t.style[s],t.style[s]=e[s];for(s in n=i.call(t),e)t.style[s]=a[s];return n},Kt=new RegExp(dt.join("|"),"i");function Zt(t,e,i){var n,s,a,o,r=Yt.test(e),l=t.style;return(i=i||Vt(t))&&(o=i.getPropertyValue(e)||i[e],r&&o&&(o=o.replace(P,"$1")||void 0),""!==o||_t(t)||(o=j.style(t,e)),!_.pixelBoxStyles()&&Gt.test(o)&&Kt.test(e)&&(n=l.width,s=l.minWidth,a=l.maxWidth,l.minWidth=l.maxWidth=l.width=o,o=i.width,l.width=n,l.minWidth=s,l.maxWidth=a)),void 0!==o?o+"":o}function te(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function t(){if(u){h.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",u.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",gt.appendChild(h).appendChild(u);var t=n.getComputedStyle(u);i="1%"!==t.top,l=12===e(t.marginLeft),u.style.right="60%",o=36===e(t.right),s=36===e(t.width),u.style.position="absolute",a=12===e(u.offsetWidth/3),gt.removeChild(h),u=null}}function e(t){return Math.round(parseFloat(t))}var i,s,a,o,r,l,h=y.createElement("div"),u=y.createElement("div");u.style&&(u.style.backgroundClip="content-box",u.cloneNode(!0).style.backgroundClip="",_.clearCloneStyle="content-box"===u.style.backgroundClip,j.extend(_,{boxSizingReliable:function(){return t(),s},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),i},reliableMarginLeft:function(){return t(),l},scrollboxSize:function(){return t(),a},reliableTrDimensions:function(){var t,e,i,s;return null==r&&(t=y.createElement("table"),e=y.createElement("tr"),i=y.createElement("div"),t.style.cssText="position:absolute;left:-11111px;border-collapse:separate",e.style.cssText="box-sizing:content-box;border:1px solid",e.style.height="1px",i.style.height="9px",i.style.display="block",gt.appendChild(t).appendChild(e).appendChild(i),s=n.getComputedStyle(e),r=parseInt(s.height,10)+parseInt(s.borderTopWidth,10)+parseInt(s.borderBottomWidth,10)===e.offsetHeight,gt.removeChild(t)),r}}))}();var ee=["Webkit","Moz","ms"],ie=y.createElement("div").style,ne={};function se(t){var e=j.cssProps[t]||ne[t];return e||(t in ie?t:ne[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),i=ee.length;i--;)if((t=ee[i]+e)in ie)return t}(t)||t)}var ae=/^(none|table(?!-c[ea]).+)/,oe={position:"absolute",visibility:"hidden",display:"block"},re={letterSpacing:"0",fontWeight:"400"};function le(t,e,i){var n=ft.exec(e);return n?Math.max(0,n[2]-(i||0))+(n[3]||"px"):e}function he(t,e,i,n,s,a){var o="width"===e?1:0,r=0,l=0,h=0;if(i===(n?"border":"content"))return 0;for(;o<4;o+=2)"margin"===i&&(h+=j.css(t,i+dt[o],!0,s)),n?("content"===i&&(l-=j.css(t,"padding"+dt[o],!0,s)),"margin"!==i&&(l-=j.css(t,"border"+dt[o]+"Width",!0,s))):(l+=j.css(t,"padding"+dt[o],!0,s),"padding"!==i?l+=j.css(t,"border"+dt[o]+"Width",!0,s):r+=j.css(t,"border"+dt[o]+"Width",!0,s));return!n&&a>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-a-l-r-.5))||0),l+h}function ue(t,e,i){var n=Vt(t),s=(!_.boxSizingReliable()||i)&&"border-box"===j.css(t,"boxSizing",!1,n),a=s,o=Zt(t,e,n),r="offset"+e[0].toUpperCase()+e.slice(1);if(Gt.test(o)){if(!i)return o;o="auto"}return(!_.boxSizingReliable()&&s||!_.reliableTrDimensions()&&S(t,"tr")||"auto"===o||!parseFloat(o)&&"inline"===j.css(t,"display",!1,n))&&t.getClientRects().length&&(s="border-box"===j.css(t,"boxSizing",!1,n),(a=r in t)&&(o=t[r])),(o=parseFloat(o)||0)+he(t,e,i||(s?"border":"content"),a,n,o)+"px"}function pe(t,e,i,n,s){return new pe.prototype.init(t,e,i,n,s)}j.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=Zt(t,"opacity");return""===i?"1":i}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(t,e,i,n){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var s,a,o,r=st(e),l=Yt.test(e),h=t.style;if(l||(e=se(r)),o=j.cssHooks[e]||j.cssHooks[r],void 0===i)return o&&"get"in o&&void 0!==(s=o.get(t,!1,n))?s:h[e];"string"===(a=typeof i)&&(s=ft.exec(i))&&s[1]&&(i=yt(t,e,s),a="number"),null!=i&&i==i&&("number"!==a||l||(i+=s&&s[3]||(j.cssNumber[r]?"":"px")),_.clearCloneStyle||""!==i||0!==e.indexOf("background")||(h[e]="inherit"),o&&"set"in o&&void 0===(i=o.set(t,i,n))||(l?h.setProperty(e,i):h[e]=i))}},css:function(t,e,i,n){var s,a,o,r=st(e);return Yt.test(e)||(e=se(r)),(o=j.cssHooks[e]||j.cssHooks[r])&&"get"in o&&(s=o.get(t,!0,i)),void 0===s&&(s=Zt(t,e,n)),"normal"===s&&e in re&&(s=re[e]),""===i||i?(a=parseFloat(s),!0===i||isFinite(a)?a||0:s):s}}),j.each(["height","width"],(function(t,e){j.cssHooks[e]={get:function(t,i,n){if(i)return!ae.test(j.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?ue(t,e,n):Qt(t,oe,(function(){return ue(t,e,n)}))},set:function(t,i,n){var s,a=Vt(t),o=!_.scrollboxSize()&&"absolute"===a.position,r=(o||n)&&"border-box"===j.css(t,"boxSizing",!1,a),l=n?he(t,e,n,r,a):0;return r&&o&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(a[e])-he(t,e,"border",!1,a)-.5)),l&&(s=ft.exec(i))&&"px"!==(s[3]||"px")&&(t.style[e]=i,i=j.css(t,e)),le(0,i,l)}}})),j.cssHooks.marginLeft=te(_.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Zt(t,"marginLeft"))||t.getBoundingClientRect().left-Qt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),j.each({margin:"",padding:"",border:"Width"},(function(t,e){j.cssHooks[t+e]={expand:function(i){for(var n=0,s={},a="string"==typeof i?i.split(" "):[i];n<4;n++)s[t+dt[n]+e]=a[n]||a[n-2]||a[0];return s}},"margin"!==t&&(j.cssHooks[t+e].set=le)})),j.fn.extend({css:function(t,e){return tt(this,(function(t,e,i){var n,s,a={},o=0;if(Array.isArray(e)){for(n=Vt(t),s=e.length;o<s;o++)a[e[o]]=j.css(t,e[o],!1,n);return a}return void 0!==i?j.style(t,e,i):j.css(t,e)}),t,e,arguments.length>1)}}),j.Tween=pe,pe.prototype={constructor:pe,init:function(t,e,i,n,s,a){this.elem=t,this.prop=i,this.easing=s||j.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=a||(j.cssNumber[i]?"":"px")},cur:function(){var t=pe.propHooks[this.prop];return t&&t.get?t.get(this):pe.propHooks._default.get(this)},run:function(t){var e,i=pe.propHooks[this.prop];return this.options.duration?this.pos=e=j.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):pe.propHooks._default.set(this),this}},pe.prototype.init.prototype=pe.prototype,pe.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=j.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){j.fx.step[t.prop]?j.fx.step[t.prop](t):1!==t.elem.nodeType||!j.cssHooks[t.prop]&&null==t.elem.style[se(t.prop)]?t.elem[t.prop]=t.now:j.style(t.elem,t.prop,t.now+t.unit)}}},pe.propHooks.scrollTop=pe.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},j.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},j.fx=pe.prototype.init,j.fx.step={};var ce,fe,de=/^(?:toggle|show|hide)$/,ge=/queueHooks$/;function _e(){fe&&(!1===y.hidden&&n.requestAnimationFrame?n.requestAnimationFrame(_e):n.setTimeout(_e,j.fx.interval),j.fx.tick())}function me(){return n.setTimeout((function(){ce=void 0})),ce=Date.now()}function ve(t,e){var i,n=0,s={height:t};for(e=e?1:0;n<4;n+=2-e)s["margin"+(i=dt[n])]=s["padding"+i]=t;return e&&(s.opacity=s.width=t),s}function ye(t,e,i){for(var n,s=(be.tweeners[e]||[]).concat(be.tweeners["*"]),a=0,o=s.length;a<o;a++)if(n=s[a].call(i,e,t))return n}function be(t,e,i){var n,s,a=0,o=be.prefilters.length,r=j.Deferred().always((function(){delete l.elem})),l=function(){if(s)return!1;for(var e=ce||me(),i=Math.max(0,h.startTime+h.duration-e),n=1-(i/h.duration||0),a=0,o=h.tweens.length;a<o;a++)h.tweens[a].run(n);return r.notifyWith(t,[h,n,i]),n<1&&o?i:(o||r.notifyWith(t,[h,1,0]),r.resolveWith(t,[h]),!1)},h=r.promise({elem:t,props:j.extend({},e),opts:j.extend(!0,{specialEasing:{},easing:j.easing._default},i),originalProperties:e,originalOptions:i,startTime:ce||me(),duration:i.duration,tweens:[],createTween:function(e,i){var n=j.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(s)return this;for(s=!0;i<n;i++)h.tweens[i].run(1);return e?(r.notifyWith(t,[h,1,0]),r.resolveWith(t,[h,e])):r.rejectWith(t,[h,e]),this}}),u=h.props;for(!function(t,e){var i,n,s,a,o;for(i in t)if(s=e[n=st(i)],a=t[i],Array.isArray(a)&&(s=a[1],a=t[i]=a[0]),i!==n&&(t[n]=a,delete t[i]),(o=j.cssHooks[n])&&"expand"in o)for(i in a=o.expand(a),delete t[n],a)i in t||(t[i]=a[i],e[i]=s);else e[n]=s}(u,h.opts.specialEasing);a<o;a++)if(n=be.prefilters[a].call(h,t,u,h.opts))return m(n.stop)&&(j._queueHooks(h.elem,h.opts.queue).stop=n.stop.bind(n)),n;return j.map(u,ye,h),m(h.opts.start)&&h.opts.start.call(t,h),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always),j.fx.timer(j.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h}j.Animation=j.extend(be,{tweeners:{"*":[function(t,e){var i=this.createTween(t,e);return yt(i.elem,t,ft.exec(e),i),i}]},tweener:function(t,e){m(t)?(e=t,t=["*"]):t=t.match(J);for(var i,n=0,s=t.length;n<s;n++)i=t[n],be.tweeners[i]=be.tweeners[i]||[],be.tweeners[i].unshift(e)},prefilters:[function(t,e,i){var n,s,a,o,r,l,h,u,p="width"in e||"height"in e,c=this,f={},d=t.style,g=t.nodeType&&vt(t),_=rt.get(t,"fxshow");for(n in i.queue||(null==(o=j._queueHooks(t,"fx")).unqueued&&(o.unqueued=0,r=o.empty.fire,o.empty.fire=function(){o.unqueued||r()}),o.unqueued++,c.always((function(){c.always((function(){o.unqueued--,j.queue(t,"fx").length||o.empty.fire()}))}))),e)if(s=e[n],de.test(s)){if(delete e[n],a=a||"toggle"===s,s===(g?"hide":"show")){if("show"!==s||!_||void 0===_[n])continue;g=!0}f[n]=_&&_[n]||j.style(t,n)}if((l=!j.isEmptyObject(e))||!j.isEmptyObject(f))for(n in p&&1===t.nodeType&&(i.overflow=[d.overflow,d.overflowX,d.overflowY],null==(h=_&&_.display)&&(h=rt.get(t,"display")),"none"===(u=j.css(t,"display"))&&(h?u=h:(xt([t],!0),h=t.style.display||h,u=j.css(t,"display"),xt([t]))),("inline"===u||"inline-block"===u&&null!=h)&&"none"===j.css(t,"float")&&(l||(c.done((function(){d.display=h})),null==h&&(u=d.display,h="none"===u?"":u)),d.display="inline-block")),i.overflow&&(d.overflow="hidden",c.always((function(){d.overflow=i.overflow[0],d.overflowX=i.overflow[1],d.overflowY=i.overflow[2]}))),l=!1,f)l||(_?"hidden"in _&&(g=_.hidden):_=rt.access(t,"fxshow",{display:h}),a&&(_.hidden=!g),g&&xt([t],!0),c.done((function(){for(n in g||xt([t]),rt.remove(t,"fxshow"),f)j.style(t,n,f[n])}))),l=ye(g?_[n]:0,n,c),n in _||(_[n]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?be.prefilters.unshift(t):be.prefilters.push(t)}}),j.speed=function(t,e,i){var n=t&&"object"==typeof t?j.extend({},t):{complete:i||!i&&e||m(t)&&t,duration:t,easing:i&&e||e&&!m(e)&&e};return j.fx.off?n.duration=0:"number"!=typeof n.duration&&(n.duration in j.fx.speeds?n.duration=j.fx.speeds[n.duration]:n.duration=j.fx.speeds._default),null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){m(n.old)&&n.old.call(this),n.queue&&j.dequeue(this,n.queue)},n},j.fn.extend({fadeTo:function(t,e,i,n){return this.filter(vt).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=j.isEmptyObject(t),a=j.speed(e,i,n),o=function(){var e=be(this,j.extend({},t),a);(s||rt.get(this,"finish"))&&e.stop(!0)};return o.finish=o,s||!1===a.queue?this.each(o):this.queue(a.queue,o)},stop:function(t,e,i){var n=function(t){var e=t.stop;delete t.stop,e(i)};return"string"!=typeof t&&(i=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each((function(){var e=!0,s=null!=t&&t+"queueHooks",a=j.timers,o=rt.get(this);if(s)o[s]&&o[s].stop&&n(o[s]);else for(s in o)o[s]&&o[s].stop&&ge.test(s)&&n(o[s]);for(s=a.length;s--;)a[s].elem!==this||null!=t&&a[s].queue!==t||(a[s].anim.stop(i),e=!1,a.splice(s,1));!e&&i||j.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,i=rt.get(this),n=i[t+"queue"],s=i[t+"queueHooks"],a=j.timers,o=n?n.length:0;for(i.finish=!0,j.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=a.length;e--;)a[e].elem===this&&a[e].queue===t&&(a[e].anim.stop(!0),a.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish}))}}),j.each(["toggle","show","hide"],(function(t,e){var i=j.fn[e];j.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(ve(e,!0),t,n,s)}})),j.each({slideDown:ve("show"),slideUp:ve("hide"),slideToggle:ve("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){j.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}})),j.timers=[],j.fx.tick=function(){var t,e=0,i=j.timers;for(ce=Date.now();e<i.length;e++)(t=i[e])()||i[e]!==t||i.splice(e--,1);i.length||j.fx.stop(),ce=void 0},j.fx.timer=function(t){j.timers.push(t),j.fx.start()},j.fx.interval=13,j.fx.start=function(){fe||(fe=!0,_e())},j.fx.stop=function(){fe=null},j.fx.speeds={slow:600,fast:200,_default:400},j.fn.delay=function(t,e){return t=j.fx&&j.fx.speeds[t]||t,e=e||"fx",this.queue(e,(function(e,i){var s=n.setTimeout(e,t);i.stop=function(){n.clearTimeout(s)}}))},function(){var t=y.createElement("input"),e=y.createElement("select").appendChild(y.createElement("option"));t.type="checkbox",_.checkOn=""!==t.value,_.optSelected=e.selected,(t=y.createElement("input")).value="t",t.type="radio",_.radioValue="t"===t.value}();var we,xe=j.expr.attrHandle;j.fn.extend({attr:function(t,e){return tt(this,j.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){j.removeAttr(this,t)}))}}),j.extend({attr:function(t,e,i){var n,s,a=t.nodeType;if(3!==a&&8!==a&&2!==a)return void 0===t.getAttribute?j.prop(t,e,i):(1===a&&j.isXMLDoc(t)||(s=j.attrHooks[e.toLowerCase()]||(j.expr.match.bool.test(e)?we:void 0)),void 0!==i?null===i?void j.removeAttr(t,e):s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:(t.setAttribute(e,i+""),i):s&&"get"in s&&null!==(n=s.get(t,e))?n:null==(n=j.find.attr(t,e))?void 0:n)},attrHooks:{type:{set:function(t,e){if(!_.radioValue&&"radio"===e&&S(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},removeAttr:function(t,e){var i,n=0,s=e&&e.match(J);if(s&&1===t.nodeType)for(;i=s[n++];)t.removeAttribute(i)}}),we={set:function(t,e,i){return!1===e?j.removeAttr(t,i):t.setAttribute(i,i),i}},j.each(j.expr.match.bool.source.match(/\w+/g),(function(t,e){var i=xe[e]||j.find.attr;xe[e]=function(t,e,n){var s,a,o=e.toLowerCase();return n||(a=xe[o],xe[o]=s,s=null!=i(t,e,n)?o:null,xe[o]=a),s}}));var ze=/^(?:input|select|textarea|button)$/i,ke=/^(?:a|area)$/i;function je(t){return(t.match(J)||[]).join(" ")}function Ce(t){return t.getAttribute&&t.getAttribute("class")||""}function Se(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(J)||[]}j.fn.extend({prop:function(t,e){return tt(this,j.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[j.propFix[t]||t]}))}}),j.extend({prop:function(t,e,i){var n,s,a=t.nodeType;if(3!==a&&8!==a&&2!==a)return 1===a&&j.isXMLDoc(t)||(e=j.propFix[e]||e,s=j.propHooks[e]),void 0!==i?s&&"set"in s&&void 0!==(n=s.set(t,i,e))?n:t[e]=i:s&&"get"in s&&null!==(n=s.get(t,e))?n:t[e]},propHooks:{tabIndex:{get:function(t){var e=j.find.attr(t,"tabindex");return e?parseInt(e,10):ze.test(t.nodeName)||ke.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),_.optSelected||(j.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),j.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){j.propFix[this.toLowerCase()]=this})),j.fn.extend({addClass:function(t){var e,i,n,s,a,o;return m(t)?this.each((function(e){j(this).addClass(t.call(this,e,Ce(this)))})):(e=Se(t)).length?this.each((function(){if(n=Ce(this),i=1===this.nodeType&&" "+je(n)+" "){for(a=0;a<e.length;a++)s=e[a],i.indexOf(" "+s+" ")<0&&(i+=s+" ");o=je(i),n!==o&&this.setAttribute("class",o)}})):this},removeClass:function(t){var e,i,n,s,a,o;return m(t)?this.each((function(e){j(this).removeClass(t.call(this,e,Ce(this)))})):arguments.length?(e=Se(t)).length?this.each((function(){if(n=Ce(this),i=1===this.nodeType&&" "+je(n)+" "){for(a=0;a<e.length;a++)for(s=e[a];i.indexOf(" "+s+" ")>-1;)i=i.replace(" "+s+" "," ");o=je(i),n!==o&&this.setAttribute("class",o)}})):this:this.attr("class","")},toggleClass:function(t,e){var i,n,s,a,o=typeof t,r="string"===o||Array.isArray(t);return m(t)?this.each((function(i){j(this).toggleClass(t.call(this,i,Ce(this),e),e)})):"boolean"==typeof e&&r?e?this.addClass(t):this.removeClass(t):(i=Se(t),this.each((function(){if(r)for(a=j(this),s=0;s<i.length;s++)n=i[s],a.hasClass(n)?a.removeClass(n):a.addClass(n);else void 0!==t&&"boolean"!==o||((n=Ce(this))&&rt.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||!1===t?"":rt.get(this,"__className__")||""))})))},hasClass:function(t){var e,i,n=0;for(e=" "+t+" ";i=this[n++];)if(1===i.nodeType&&(" "+je(Ce(i))+" ").indexOf(e)>-1)return!0;return!1}});var qe=/\r/g;j.fn.extend({val:function(t){var e,i,n,s=this[0];return arguments.length?(n=m(t),this.each((function(i){var s;1===this.nodeType&&(null==(s=n?t.call(this,i,j(this).val()):t)?s="":"number"==typeof s?s+="":Array.isArray(s)&&(s=j.map(s,(function(t){return null==t?"":t+""}))),(e=j.valHooks[this.type]||j.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,s,"value")||(this.value=s))}))):s?(e=j.valHooks[s.type]||j.valHooks[s.nodeName.toLowerCase()])&&"get"in e&&void 0!==(i=e.get(s,"value"))?i:"string"==typeof(i=s.value)?i.replace(qe,""):null==i?"":i:void 0}}),j.extend({valHooks:{option:{get:function(t){var e=j.find.attr(t,"value");return null!=e?e:je(j.text(t))}},select:{get:function(t){var e,i,n,s=t.options,a=t.selectedIndex,o="select-one"===t.type,r=o?null:[],l=o?a+1:s.length;for(n=a<0?l:o?a:0;n<l;n++)if(((i=s[n]).selected||n===a)&&!i.disabled&&(!i.parentNode.disabled||!S(i.parentNode,"optgroup"))){if(e=j(i).val(),o)return e;r.push(e)}return r},set:function(t,e){for(var i,n,s=t.options,a=j.makeArray(e),o=s.length;o--;)((n=s[o]).selected=j.inArray(j.valHooks.option.get(n),a)>-1)&&(i=!0);return i||(t.selectedIndex=-1),a}}}}),j.each(["radio","checkbox"],(function(){j.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=j.inArray(j(t).val(),e)>-1}},_.checkOn||(j.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var Te=n.location,$e={guid:Date.now()},Ee=/\?/;j.parseXML=function(t){var e,i;if(!t||"string"!=typeof t)return null;try{e=(new n.DOMParser).parseFromString(t,"text/xml")}catch(t){}return i=e&&e.getElementsByTagName("parsererror")[0],e&&!i||j.error("Invalid XML: "+(i?j.map(i.childNodes,(function(t){return t.textContent})).join("\n"):t)),e};var Pe=/^(?:focusinfocus|focusoutblur)$/,Ne=function(t){t.stopPropagation()};j.extend(j.event,{trigger:function(t,e,i,s){var a,o,r,l,h,u,p,c,d=[i||y],g=f.call(t,"type")?t.type:t,_=f.call(t,"namespace")?t.namespace.split("."):[];if(o=c=r=i=i||y,3!==i.nodeType&&8!==i.nodeType&&!Pe.test(g+j.event.triggered)&&(g.indexOf(".")>-1&&(_=g.split("."),g=_.shift(),_.sort()),h=g.indexOf(":")<0&&"on"+g,(t=t[j.expando]?t:new j.Event(g,"object"==typeof t&&t)).isTrigger=s?2:3,t.namespace=_.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+_.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),e=null==e?[t]:j.makeArray(e,[t]),p=j.event.special[g]||{},s||!p.trigger||!1!==p.trigger.apply(i,e))){if(!s&&!p.noBubble&&!v(i)){for(l=p.delegateType||g,Pe.test(l+g)||(o=o.parentNode);o;o=o.parentNode)d.push(o),r=o;r===(i.ownerDocument||y)&&d.push(r.defaultView||r.parentWindow||n)}for(a=0;(o=d[a++])&&!t.isPropagationStopped();)c=o,t.type=a>1?l:p.bindType||g,(u=(rt.get(o,"events")||Object.create(null))[t.type]&&rt.get(o,"handle"))&&u.apply(o,e),(u=h&&o[h])&&u.apply&&at(o)&&(t.result=u.apply(o,e),!1===t.result&&t.preventDefault());return t.type=g,s||t.isDefaultPrevented()||p._default&&!1!==p._default.apply(d.pop(),e)||!at(i)||h&&m(i[g])&&!v(i)&&((r=i[h])&&(i[h]=null),j.event.triggered=g,t.isPropagationStopped()&&c.addEventListener(g,Ne),i[g](),t.isPropagationStopped()&&c.removeEventListener(g,Ne),j.event.triggered=void 0,r&&(i[h]=r)),t.result}},simulate:function(t,e,i){var n=j.extend(new j.Event,i,{type:t,isSimulated:!0});j.event.trigger(n,null,e)}}),j.fn.extend({trigger:function(t,e){return this.each((function(){j.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var i=this[0];if(i)return j.event.trigger(t,e,i,!0)}});var De=/\[\]$/,Ae=/\r?\n/g,Ie=/^(?:submit|button|image|reset|file)$/i,Oe=/^(?:input|select|textarea|keygen)/i;function Me(t,e,i,n){var s;if(Array.isArray(e))j.each(e,(function(e,s){i||De.test(t)?n(t,s):Me(t+"["+("object"==typeof s&&null!=s?e:"")+"]",s,i,n)}));else if(i||"object"!==x(e))n(t,e);else for(s in e)Me(t+"["+s+"]",e[s],i,n)}j.param=function(t,e){var i,n=[],s=function(t,e){var i=m(e)?e():e;n[n.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==i?"":i)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!j.isPlainObject(t))j.each(t,(function(){s(this.name,this.value)}));else for(i in t)Me(i,t[i],e,s);return n.join("&")},j.fn.extend({serialize:function(){return j.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=j.prop(this,"elements");return t?j.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!j(this).is(":disabled")&&Oe.test(this.nodeName)&&!Ie.test(t)&&(this.checked||!jt.test(t))})).map((function(t,e){var i=j(this).val();return null==i?null:Array.isArray(i)?j.map(i,(function(t){return{name:e.name,value:t.replace(Ae,"\r\n")}})):{name:e.name,value:i.replace(Ae,"\r\n")}})).get()}});var He=/%20/g,Le=/#.*$/,Ue=/([?&])_=[^&]*/,Re=/^(.*?):[ \t]*([^\r\n]*)$/gm,We=/^(?:GET|HEAD)$/,Fe=/^\/\//,Be={},Xe={},Je="*/".concat("*"),Ge=y.createElement("a");function Ye(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,a=e.toLowerCase().match(J)||[];if(m(i))for(;n=a[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function Ve(t,e,i,n){var s={},a=t===Xe;function o(r){var l;return s[r]=!0,j.each(t[r]||[],(function(t,r){var h=r(e,i,n);return"string"!=typeof h||a||s[h]?a?!(l=h):void 0:(e.dataTypes.unshift(h),o(h),!1)})),l}return o(e.dataTypes[0])||!s["*"]&&o("*")}function Qe(t,e){var i,n,s=j.ajaxSettings.flatOptions||{};for(i in e)void 0!==e[i]&&((s[i]?t:n||(n={}))[i]=e[i]);return n&&j.extend(!0,t,n),t}Ge.href=Te.href,j.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Te.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Te.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Je,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":j.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Qe(Qe(t,j.ajaxSettings),e):Qe(j.ajaxSettings,t)},ajaxPrefilter:Ye(Be),ajaxTransport:Ye(Xe),ajax:function(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,s,a,o,r,l,h,u,p,c,f=j.ajaxSetup({},e),d=f.context||f,g=f.context&&(d.nodeType||d.jquery)?j(d):j.event,_=j.Deferred(),m=j.Callbacks("once memory"),v=f.statusCode||{},b={},w={},x="canceled",z={readyState:0,getResponseHeader:function(t){var e;if(h){if(!o)for(o={};e=Re.exec(a);)o[e[1].toLowerCase()+" "]=(o[e[1].toLowerCase()+" "]||[]).concat(e[2]);e=o[t.toLowerCase()+" "]}return null==e?null:e.join(", ")},getAllResponseHeaders:function(){return h?a:null},setRequestHeader:function(t,e){return null==h&&(t=w[t.toLowerCase()]=w[t.toLowerCase()]||t,b[t]=e),this},overrideMimeType:function(t){return null==h&&(f.mimeType=t),this},statusCode:function(t){var e;if(t)if(h)z.always(t[z.status]);else for(e in t)v[e]=[v[e],t[e]];return this},abort:function(t){var e=t||x;return i&&i.abort(e),k(0,e),this}};if(_.promise(z),f.url=((t||f.url||Te.href)+"").replace(Fe,Te.protocol+"//"),f.type=e.method||e.type||f.method||f.type,f.dataTypes=(f.dataType||"*").toLowerCase().match(J)||[""],null==f.crossDomain){l=y.createElement("a");try{l.href=f.url,l.href=l.href,f.crossDomain=Ge.protocol+"//"+Ge.host!=l.protocol+"//"+l.host}catch(t){f.crossDomain=!0}}if(f.data&&f.processData&&"string"!=typeof f.data&&(f.data=j.param(f.data,f.traditional)),Ve(Be,f,e,z),h)return z;for(p in(u=j.event&&f.global)&&0==j.active++&&j.event.trigger("ajaxStart"),f.type=f.type.toUpperCase(),f.hasContent=!We.test(f.type),s=f.url.replace(Le,""),f.hasContent?f.data&&f.processData&&0===(f.contentType||"").indexOf("application/x-www-form-urlencoded")&&(f.data=f.data.replace(He,"+")):(c=f.url.slice(s.length),f.data&&(f.processData||"string"==typeof f.data)&&(s+=(Ee.test(s)?"&":"?")+f.data,delete f.data),!1===f.cache&&(s=s.replace(Ue,"$1"),c=(Ee.test(s)?"&":"?")+"_="+$e.guid+++c),f.url=s+c),f.ifModified&&(j.lastModified[s]&&z.setRequestHeader("If-Modified-Since",j.lastModified[s]),j.etag[s]&&z.setRequestHeader("If-None-Match",j.etag[s])),(f.data&&f.hasContent&&!1!==f.contentType||e.contentType)&&z.setRequestHeader("Content-Type",f.contentType),z.setRequestHeader("Accept",f.dataTypes[0]&&f.accepts[f.dataTypes[0]]?f.accepts[f.dataTypes[0]]+("*"!==f.dataTypes[0]?", "+Je+"; q=0.01":""):f.accepts["*"]),f.headers)z.setRequestHeader(p,f.headers[p]);if(f.beforeSend&&(!1===f.beforeSend.call(d,z,f)||h))return z.abort();if(x="abort",m.add(f.complete),z.done(f.success),z.fail(f.error),i=Ve(Xe,f,e,z)){if(z.readyState=1,u&&g.trigger("ajaxSend",[z,f]),h)return z;f.async&&f.timeout>0&&(r=n.setTimeout((function(){z.abort("timeout")}),f.timeout));try{h=!1,i.send(b,k)}catch(t){if(h)throw t;k(-1,t)}}else k(-1,"No Transport");function k(t,e,o,l){var p,c,y,b,w,x=e;h||(h=!0,r&&n.clearTimeout(r),i=void 0,a=l||"",z.readyState=t>0?4:0,p=t>=200&&t<300||304===t,o&&(b=function(t,e,i){for(var n,s,a,o,r=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===n&&(n=t.mimeType||e.getResponseHeader("Content-Type"));if(n)for(s in r)if(r[s]&&r[s].test(n)){l.unshift(s);break}if(l[0]in i)a=l[0];else{for(s in i){if(!l[0]||t.converters[s+" "+l[0]]){a=s;break}o||(o=s)}a=a||o}if(a)return a!==l[0]&&l.unshift(a),i[a]}(f,z,o)),!p&&j.inArray("script",f.dataTypes)>-1&&j.inArray("json",f.dataTypes)<0&&(f.converters["text script"]=function(){}),b=function(t,e,i,n){var s,a,o,r,l,h={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)h[o.toLowerCase()]=t.converters[o];for(a=u.shift();a;)if(t.responseFields[a]&&(i[t.responseFields[a]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=a,a=u.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(o=h[l+" "+a]||h["* "+a]))for(s in h)if((r=s.split(" "))[1]===a&&(o=h[l+" "+r[0]]||h["* "+r[0]])){!0===o?o=h[s]:!0!==h[s]&&(a=r[0],u.unshift(r[1]));break}if(!0!==o)if(o&&t.throws)e=o(e);else try{e=o(e)}catch(t){return{state:"parsererror",error:o?t:"No conversion from "+l+" to "+a}}}return{state:"success",data:e}}(f,b,z,p),p?(f.ifModified&&((w=z.getResponseHeader("Last-Modified"))&&(j.lastModified[s]=w),(w=z.getResponseHeader("etag"))&&(j.etag[s]=w)),204===t||"HEAD"===f.type?x="nocontent":304===t?x="notmodified":(x=b.state,c=b.data,p=!(y=b.error))):(y=x,!t&&x||(x="error",t<0&&(t=0))),z.status=t,z.statusText=(e||x)+"",p?_.resolveWith(d,[c,x,z]):_.rejectWith(d,[z,x,y]),z.statusCode(v),v=void 0,u&&g.trigger(p?"ajaxSuccess":"ajaxError",[z,f,p?c:y]),m.fireWith(d,[z,x]),u&&(g.trigger("ajaxComplete",[z,f]),--j.active||j.event.trigger("ajaxStop")))}return z},getJSON:function(t,e,i){return j.get(t,e,i,"json")},getScript:function(t,e){return j.get(t,void 0,e,"script")}}),j.each(["get","post"],(function(t,e){j[e]=function(t,i,n,s){return m(i)&&(s=s||n,n=i,i=void 0),j.ajax(j.extend({url:t,type:e,dataType:s,data:i,success:n},j.isPlainObject(t)&&t))}})),j.ajaxPrefilter((function(t){var e;for(e in t.headers)"content-type"===e.toLowerCase()&&(t.contentType=t.headers[e]||"")})),j._evalUrl=function(t,e,i){return j.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(t){j.globalEval(t,e,i)}})},j.fn.extend({wrapAll:function(t){var e;return this[0]&&(m(t)&&(t=t.call(this[0])),e=j(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return m(t)?this.each((function(e){j(this).wrapInner(t.call(this,e))})):this.each((function(){var e=j(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)}))},wrap:function(t){var e=m(t);return this.each((function(i){j(this).wrapAll(e?t.call(this,i):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){j(this).replaceWith(this.childNodes)})),this}}),j.expr.pseudos.hidden=function(t){return!j.expr.pseudos.visible(t)},j.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},j.ajaxSettings.xhr=function(){try{return new n.XMLHttpRequest}catch(t){}};var Ke={0:200,1223:204},Ze=j.ajaxSettings.xhr();_.cors=!!Ze&&"withCredentials"in Ze,_.ajax=Ze=!!Ze,j.ajaxTransport((function(t){var e,i;if(_.cors||Ze&&!t.crossDomain)return{send:function(s,a){var o,r=t.xhr();if(r.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)r[o]=t.xhrFields[o];for(o in t.mimeType&&r.overrideMimeType&&r.overrideMimeType(t.mimeType),t.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest"),s)r.setRequestHeader(o,s[o]);e=function(t){return function(){e&&(e=i=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===t?r.abort():"error"===t?"number"!=typeof r.status?a(0,"error"):a(r.status,r.statusText):a(Ke[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=e(),i=r.onerror=r.ontimeout=e("error"),void 0!==r.onabort?r.onabort=i:r.onreadystatechange=function(){4===r.readyState&&n.setTimeout((function(){e&&i()}))},e=e("abort");try{r.send(t.hasContent&&t.data||null)}catch(t){if(e)throw t}},abort:function(){e&&e()}}})),j.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),j.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return j.globalEval(t),t}}}),j.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),j.ajaxTransport("script",(function(t){var e,i;if(t.crossDomain||t.scriptAttrs)return{send:function(n,s){e=j("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",i=function(t){e.remove(),i=null,t&&s("error"===t.type?404:200,t.type)}),y.head.appendChild(e[0])},abort:function(){i&&i()}}}));var ti,ei=[],ii=/(=)\?(?=&|$)|\?\?/;j.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=ei.pop()||j.expando+"_"+$e.guid++;return this[t]=!0,t}}),j.ajaxPrefilter("json jsonp",(function(t,e,i){var s,a,o,r=!1!==t.jsonp&&(ii.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&ii.test(t.data)&&"data");if(r||"jsonp"===t.dataTypes[0])return s=t.jsonpCallback=m(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,r?t[r]=t[r].replace(ii,"$1"+s):!1!==t.jsonp&&(t.url+=(Ee.test(t.url)?"&":"?")+t.jsonp+"="+s),t.converters["script json"]=function(){return o||j.error(s+" was not called"),o[0]},t.dataTypes[0]="json",a=n[s],n[s]=function(){o=arguments},i.always((function(){void 0===a?j(n).removeProp(s):n[s]=a,t[s]&&(t.jsonpCallback=e.jsonpCallback,ei.push(s)),o&&m(a)&&a(o[0]),o=a=void 0})),"script"})),_.createHTMLDocument=((ti=y.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===ti.childNodes.length),j.parseHTML=function(t,e,i){return"string"!=typeof t?[]:("boolean"==typeof e&&(i=e,e=!1),e||(_.createHTMLDocument?((n=(e=y.implementation.createHTMLDocument("")).createElement("base")).href=y.location.href,e.head.appendChild(n)):e=y),a=!i&&[],(s=L.exec(t))?[e.createElement(s[1])]:(s=Pt([t],e,a),a&&a.length&&j(a).remove(),j.merge([],s.childNodes)));var n,s,a},j.fn.load=function(t,e,i){var n,s,a,o=this,r=t.indexOf(" ");return r>-1&&(n=je(t.slice(r)),t=t.slice(0,r)),m(e)?(i=e,e=void 0):e&&"object"==typeof e&&(s="POST"),o.length>0&&j.ajax({url:t,type:s||"GET",dataType:"html",data:e}).done((function(t){a=arguments,o.html(n?j("<div>").append(j.parseHTML(t)).find(n):t)})).always(i&&function(t,e){o.each((function(){i.apply(this,a||[t.responseText,e,t])}))}),this},j.expr.pseudos.animated=function(t){return j.grep(j.timers,(function(e){return t===e.elem})).length},j.offset={setOffset:function(t,e,i){var n,s,a,o,r,l,h=j.css(t,"position"),u=j(t),p={};"static"===h&&(t.style.position="relative"),r=u.offset(),a=j.css(t,"top"),l=j.css(t,"left"),("absolute"===h||"fixed"===h)&&(a+l).indexOf("auto")>-1?(o=(n=u.position()).top,s=n.left):(o=parseFloat(a)||0,s=parseFloat(l)||0),m(e)&&(e=e.call(t,i,j.extend({},r))),null!=e.top&&(p.top=e.top-r.top+o),null!=e.left&&(p.left=e.left-r.left+s),"using"in e?e.using.call(t,p):u.css(p)}},j.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){j.offset.setOffset(this,t,e)}));var e,i,n=this[0];return n?n.getClientRects().length?(e=n.getBoundingClientRect(),i=n.ownerDocument.defaultView,{top:e.top+i.pageYOffset,left:e.left+i.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,i,n=this[0],s={top:0,left:0};if("fixed"===j.css(n,"position"))e=n.getBoundingClientRect();else{for(e=this.offset(),i=n.ownerDocument,t=n.offsetParent||i.documentElement;t&&(t===i.body||t===i.documentElement)&&"static"===j.css(t,"position");)t=t.parentNode;t&&t!==n&&1===t.nodeType&&((s=j(t).offset()).top+=j.css(t,"borderTopWidth",!0),s.left+=j.css(t,"borderLeftWidth",!0))}return{top:e.top-s.top-j.css(n,"marginTop",!0),left:e.left-s.left-j.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===j.css(t,"position");)t=t.offsetParent;return t||gt}))}}),j.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var i="pageYOffset"===e;j.fn[t]=function(n){return tt(this,(function(t,n,s){var a;if(v(t)?a=t:9===t.nodeType&&(a=t.defaultView),void 0===s)return a?a[e]:t[n];a?a.scrollTo(i?a.pageXOffset:s,i?s:a.pageYOffset):t[n]=s}),t,n,arguments.length)}})),j.each(["top","left"],(function(t,e){j.cssHooks[e]=te(_.pixelPosition,(function(t,i){if(i)return i=Zt(t,e),Gt.test(i)?j(t).position()[e]+"px":i}))})),j.each({Height:"height",Width:"width"},(function(t,e){j.each({padding:"inner"+t,content:e,"":"outer"+t},(function(i,n){j.fn[n]=function(s,a){var o=arguments.length&&(i||"boolean"!=typeof s),r=i||(!0===s||!0===a?"margin":"border");return tt(this,(function(e,i,s){var a;return v(e)?0===n.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(a=e.documentElement,Math.max(e.body["scroll"+t],a["scroll"+t],e.body["offset"+t],a["offset"+t],a["client"+t])):void 0===s?j.css(e,i,r):j.style(e,i,s,r)}),e,o?s:void 0,o)}}))})),j.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){j.fn[e]=function(t){return this.on(e,t)}})),j.fn.extend({bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)},hover:function(t,e){return this.on("mouseenter",t).on("mouseleave",e||t)}}),j.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){j.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}));var ni=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;j.proxy=function(t,e){var i,n,s;if("string"==typeof e&&(i=t[e],e=t,t=i),m(t))return n=r.call(arguments,2),s=function(){return t.apply(e||this,n.concat(r.call(arguments)))},s.guid=t.guid=t.guid||j.guid++,s},j.holdReady=function(t){t?j.readyWait++:j.ready(!0)},j.isArray=Array.isArray,j.parseJSON=JSON.parse,j.nodeName=S,j.isFunction=m,j.isWindow=v,j.camelCase=st,j.type=x,j.now=Date.now,j.isNumeric=function(t){var e=j.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},j.trim=function(t){return null==t?"":(t+"").replace(ni,"$1")},void 0===(i=function(){return j}.apply(e,[]))||(t.exports=i);var si=n.jQuery,ai=n.$;return j.noConflict=function(t){return n.$===j&&(n.$=ai),t&&n.jQuery===j&&(n.jQuery=si),j},void 0===s&&(n.jQuery=n.$=j),j}))}},e={};function i(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n].call(a.exports,a,a.exports,i),a.exports}i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{"use strict";
/*!
 *  電脳麻将 v2.4.11
 *
 *  Copyright(C) 2017 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/Majiang/blob/master/LICENSE
 */i.g.Majiang=i(8739),i.g.Majiang.AI=i(5209),i.g.Majiang.UI=i(2698),i.g.Majiang.VERSION="2.4.11",i.g.jQuery=i(4692),i.g.$=jQuery})()})();