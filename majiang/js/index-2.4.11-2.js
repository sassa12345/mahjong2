(()=>{"use strict";
/*!
 *  電脳麻将 v2.4.11
 *
 *  Copyright(C) 2017 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/Majiang/blob/master/LICENSE
 */const{hide:a,show:e,fadeIn:t,scale:o,setSelector:i,clearSelector:n}=Majiang.UI.Util;let l;$((function(){let r;const d=Majiang.UI.pai($("#loaddata")),s=Majiang.UI.audio($("#loaddata")),c=a=>($("body").addClass("analyzer"),new Majiang.UI.Analyzer($("#board > .analyzer"),a,d,(()=>$("body").removeClass("analyzer")))),b=new Majiang.UI.PaipuFile($("#file"),"Majiang.game",(a=>($("#board .controller").addClass("paipu"),$("body").attr("class","board"),o($("#board"),$("#space")),new Majiang.UI.Paipu($("#board"),a,d,s,"Majiang.pref",(()=>t($("body").attr("class","file"))),c))),(a=>(t($("body").attr("class","stat")),new Majiang.UI.PaipuStat($("#stat"),a,(()=>t($("body").attr("class","file"))))))),g=Majiang.rule(JSON.parse(localStorage.getItem("Majiang.rule")||"{}"));function w(){let a=[new Majiang.UI.Player($("#board"),d,s)];for(let e=1;e<4;e++)a[e]=new Majiang.AI;r=new Majiang.Game(a,u,g),r.view=new Majiang.UI.Board($("#board .board"),d,s,r.model),$("#board .controller").removeClass("paipu"),$("body").attr("class","board"),o($("#board"),$("#space")),new Majiang.UI.GameCtl($("#board"),"Majiang.pref",r,r._view),r.kaiju()}function u(a){a&&b.add(a,10),t($("body").attr("class","file")),b.redraw()}$("#file .start").on("click",w),$(window).on("resize",(()=>o($("#board"),$("#space")))),setTimeout((()=>{$(window).on("load",(function(){if(!b.isEmpty)return u();a($("#title .loading")),$("#title .start").attr("tabindex",0).attr("role","button").on("click",(()=>{n("title"),w()})),e(i($("#title .start"),"title",{focus:null,touch:!1}))})),l&&$(window).trigger("load")}),1e3)})),$(window).on("load",(()=>l=!0))})();