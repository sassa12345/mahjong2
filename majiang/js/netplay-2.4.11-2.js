(()=>{"use strict";var e={9768:e=>{e.exports=JSON.parse('{"Mリーグルール":{"配給原点":25000,"順位点":["+30.0","+10.0","-10.0","-30.0"],"赤牌":{"m":1,"p":1,"s":1},"連風牌は2符":true,"クイタンあり":true,"喰い替え許可レベル":0,"場数":2,"途中流局あり":false,"流し満貫あり":false,"ノーテン宣言あり":true,"ノーテン罰あり":true,"最大同時和了数":1,"連荘方式":2,"トビ終了あり":false,"オーラス止めあり":false,"延長戦方式":0,"一発あり":true,"裏ドラあり":true,"カンドラあり":true,"カン裏あり":true,"カンドラ後乗せ":false,"ツモ番なしリーチあり":true,"リーチ後暗槓許可レベル":1,"ダブル役満あり":false,"役満の複合あり":true,"数え役満あり":false,"役満パオあり":true,"切り上げ満貫あり":true},"Classicルール":{"配給原点":30000,"順位点":["+12.0","+4.0","-4.0","-12.0"],"赤牌":{"m":0,"p":0,"s":0},"連風牌は2符":false,"クイタンあり":true,"喰い替え許可レベル":2,"場数":2,"途中流局あり":false,"流し満貫あり":false,"ノーテン宣言あり":false,"ノーテン罰あり":false,"最大同時和了数":1,"連荘方式":1,"トビ終了あり":false,"オーラス止めあり":false,"延長戦方式":0,"一発あり":false,"裏ドラあり":false,"カンドラあり":false,"カン裏あり":false,"カンドラ後乗せ":false,"ツモ番なしリーチあり":true,"リーチ後暗槓許可レベル":0,"ダブル役満あり":false,"役満の複合あり":false,"数え役満あり":false,"役満パオあり":false,"切り上げ満貫あり":false}}')}},a={};
/*!
 *  電脳麻将: ネット対戦 v2.4.11
 *
 *  Copyright(C) 2017 Satoshi Kobayashi
 *  Released under the MIT license
 *  https://github.com/kobalab/Majiang/blob/master/LICENSE
 */
const{hide:t,show:o,fadeIn:r,scale:l,setSelector:n,clearSelector:i}=Majiang.UI.Util,s=function t(o){var r=a[o];if(void 0!==r)return r.exports;var l=a[o]={exports:{}};return e[o](l,l.exports,t),l.exports}(9768),m=location.pathname.replace(/\/[^\/]*?$/,"");let u;$((function(){const e=Majiang.UI.pai($("#loaddata")),a=Majiang.UI.audio($("#loaddata")),n=a=>($("body").addClass("analyzer"),new Majiang.UI.Analyzer($("#board > .analyzer"),a,e,(()=>$("body").removeClass("analyzer")))),i=new Majiang.UI.PaipuFile($("#file"),"Majiang.netplay",(t=>($("#board .controller").addClass("paipu"),$("body").attr("class","board"),l($("#board"),$("#space")),new Majiang.UI.Paipu($("#board"),t,e,a,"Majiang.pref",(()=>r($("body").attr("class","file"))),n))),(e=>(r($("body").attr("class","stat")),new Majiang.UI.PaipuStat($("#stat"),e,(()=>r($("body").attr("class","file")))))));let f,d,c,p;function g(){f=io("/",{path:`${m}/server/socket.io/`}),f.on("HELLO",y),f.on("ROOM",b),f.on("START",v),f.on("END",w),f.on("ERROR",i.error),f.on("disconnect",(()=>t($("#file .netplay form.room")))),t($("#title .loading"))}function y(e){if(!e)return $("body").attr("class","title"),void o($("#title .login"));d=e.uid,o($("#file .netplay form")),r($("body").attr("class","file")),e.icon&&$("#file .netplay img").attr("src",e.icon).attr("title",e.uid),$("#file .netplay .name").text(e.name),i.redraw()}function b(e){c||(c=$("#room .user").eq(0),p=$("img",c).attr("src")),$("body").attr("class","room"),$('#room input[name="room_no"]').val(e.room_no),$("#room .room").empty();for(let a of e.user){let t=c.clone();a.icon?$("img",t).attr("src",a.icon).attr("title",a.uid):$("img",t).attr("src",p),$(".name",t).text(a.name),e.user[0].uid!=d&&a.uid!=d||o($('input[name="quit"]',t).on("click",(()=>(f.emit("ROOM",e.room_no,a.uid),!1)))),a.offline?t.addClass("offline"):t.removeClass("offline"),$("#room .room").append(t)}e.user[0].uid==d?(o($('#room select[name="rule"]')),o($('#room input[name="timer"]')),o($('#room input[type="submit"]'))):(t($('#room select[name="rule"]')),t($('#room input[name="timer"]')),t($('#room input[type="submit"]')))}function v(){const t=new Majiang.UI.Player($("#board"),e,a);t.view=new Majiang.UI.Board($("#board .board"),e,a,t.model);new Majiang.UI.GameCtl($("#board"),"Majiang.pref",null,t,t._view)._view.no_player_name=!1;let o=[];$("#board .controller").removeClass("paipu"),$("body").attr("class","board"),l($("#board"),$("#space")),f.on("GAME",(e=>{if(e.players)o=e.players;else if(e.say)t._view.say(e.say.name,e.say.l);else if(e.seq)t.action(e,((a={})=>{a.seq=e.seq,f.emit("GAME",a)}));else if(t.action(e),e.kaiju&&e.kaiju.log){let a=e.kaiju.log.pop();for(let e of a)t.action(e)}t._view.players(o)}))}function w(e){f.removeAllListeners("GAME"),e&&i.add(e,10),r($("body").attr("class","file")),i.redraw(),$('#file input[name="room_no"]').val("")}for(let e of Object.keys(s))$('select[name="rule"]').append($("<option>").val(e).text(e));localStorage.getItem("Majiang.rule")&&$('select[name="rule"]').append($("<option>").val("-").text("カスタムルール")),$("#file form.room").on("submit",(e=>{let a=$('input[name="room_no"]',$(e.target)).val();return f.emit("ROOM",a),!1})),$("#room form").on("submit",(e=>{let a=$('input[name="room_no"]',$(e.target)).val(),t=$('select[name="rule"]',$(e.target)).val();t=t?"-"==t?JSON.parse(localStorage.getItem("Majiang.rule")||"{}"):s[t]:{},t=Majiang.rule(t);let o=$('input[name="timer"]',$(e.target)).val();return o=o.match(/(\d+)/g),o&&(o=o.map((e=>+e))),f.emit("START",a,t,o),!1})),$(window).on("resize",(()=>l($("#board"),$("#space")))),$(window).on("load",(()=>setTimeout(g,500))),u&&$(window).trigger("load"),$("#title .login form").each((function(){let e=$(this).attr("method"),a=$(this).attr("action");fetch(a,{method:e,redirect:"manual"}).then((e=>{404==e.status&&t($(this))}))}))})),$(window).on("load",(()=>u=!0))})();